<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SocialHub Pro v9.0 - منصة إدارة وسائل التواصل الاجتماعي المتقدمة مع الذكاء الاصطناعي">
    <meta name="keywords" content="social media, management, scheduling, analytics, AI, automation, Dubai">
    <meta name="author" content="SocialHub Pro Team">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="SocialHub Pro v9.0 - منصة إدارة وسائل التواصل الاجتماعي">
    <meta property="og:description" content="منصة احترافية لإدارة وسائل التواصل الاجتماعي مع الذكاء الاصطناعي">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yourusername.github.io/socialhub-pro">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#1e3a8a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="SocialHub Pro">
    
    <title>SocialHub Pro v9.0 - منصة إدارة وسائل التواصل الاجتماعي</title>
    
    <!-- Bootstrap 5.3.8 Latest -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    
    <!-- Font Awesome 7.0.1 Latest -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <!-- Chart.js 4.5.0 Latest -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.5.0/chart.umd.min.js" integrity="sha512-X3aCo6CPIA+2U2i2Z6FpQBD9pZ/ETzwMBhZCNp2U6QgcwX5LF5TmQ+AeWbV6YpPkDQXtYoLgN+geOw+AIqld+g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
    <!-- Firebase App (core Firebase SDK) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <!-- Firebase Firestore -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <!-- Firebase Authentication -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <!-- Firebase Storage -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    
    <style>
        :root {
            --primary-color: #1e3a8a;
            --secondary-color: #3b82f6;
            --accent-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --dark-color: #1f2937;
            --light-color: #f8fafc;
            --border-color: #e5e7eb;
            --text-primary: #111827;
            --text-secondary: #6b7280;
            --gradient-primary: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            --gradient-secondary: linear-gradient(135deg, var(--accent-color), #06d6a0);
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        [data-bs-theme="dark"] {
            --primary-color: #3b82f6;
            --secondary-color: #60a5fa;
            --dark-color: #0f172a;
            --light-color: #1e293b;
            --border-color: #374151;
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            color: var(--text-primary);
            transition: var(--transition);
            min-height: 100vh;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--light-color);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--secondary-color);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-color);
        }

        /* Header Styles */
        .header {
            background: var(--gradient-primary);
            box-shadow: var(--shadow-lg);
            position: sticky;
            top: 0;
            z-index: 1030;
            backdrop-filter: blur(10px);
        }

        .navbar-brand {
            font-weight: 700;
            font-size: 1.5rem;
            color: white !important;
        }

        .navbar-nav .nav-link {
            color: rgba(255, 255, 255, 0.9) !important;
            font-weight: 500;
            transition: var(--transition);
            border-radius: 8px;
            margin: 0 4px;
        }

        .navbar-nav .nav-link:hover {
            color: white !important;
            background: rgba(255, 255, 255, 0.1);
        }

        /* Sidebar */
        .sidebar {
            background: white;
            box-shadow: var(--shadow-md);
            border-radius: 12px;
            padding: 1.5rem;
            height: fit-content;
            position: sticky;
            top: 100px;
        }

        .sidebar-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            margin: 8px 0;
            border-radius: 8px;
            color: var(--text-secondary);
            text-decoration: none;
            transition: var(--transition);
            cursor: pointer;
        }

        .sidebar-item:hover,
        .sidebar-item.active {
            background: var(--gradient-primary);
            color: white;
            text-decoration: none;
            transform: translateX(4px);
        }

        .sidebar-item i {
            margin-left: 12px;
            width: 20px;
            text-align: center;
        }

        /* Cards */
        .card {
            border: none;
            border-radius: 16px;
            box-shadow: var(--shadow-md);
            transition: var(--transition);
            overflow: hidden;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }

        .card-header {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 1.25rem;
            font-weight: 600;
        }

        .stats-card {
            background: var(--gradient-secondary);
            color: white;
            border-radius: 16px;
            padding: 1.5rem;
            transition: var(--transition);
        }

        .stats-card:hover {
            transform: scale(1.02);
        }

        .stats-number {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .stats-label {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        .stats-change {
            font-size: 0.8rem;
            margin-top: 0.5rem;
        }

        /* Buttons */
        .btn {
            border-radius: 8px;
            font-weight: 500;
            transition: var(--transition);
            border: none;
            padding: 10px 20px;
        }

        .btn-primary {
            background: var(--gradient-primary);
        }

        .btn-primary:hover {
            background: var(--primary-color);
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--gradient-secondary);
        }

        .btn-outline-primary {
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
        }

        .btn-outline-primary:hover {
            background: var(--primary-color);
            transform: translateY(-2px);
        }

        /* Forms */
        .form-control,
        .form-select {
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 12px 16px;
            transition: var(--transition);
        }

        .form-control:focus,
        .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(30, 58, 138, 0.25);
        }

        /* Progress Bars */
        .progress {
            height: 8px;
            border-radius: 4px;
            background: var(--border-color);
        }

        .progress-bar {
            border-radius: 4px;
        }

        /* Tables */
        .table {
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }

        .table thead th {
            background: var(--gradient-primary);
            color: white;
            border: none;
            font-weight: 600;
        }

        .table tbody tr {
            transition: var(--transition);
        }

        .table tbody tr:hover {
            background: rgba(30, 58, 138, 0.05);
        }

        /* Badges */
        .badge {
            border-radius: 6px;
            font-weight: 500;
            padding: 6px 12px;
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }

        .animate-fade-in {
            animation: fadeInUp 0.6s ease-out;
        }

        .animate-pulse {
            animation: pulse 2s infinite;
        }

        /* Loading Spinner */
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--border-color);
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Dark Mode Toggle */
        .theme-toggle {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 50px;
            padding: 8px 16px;
            color: white;
            transition: var(--transition);
        }

        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .sidebar {
                position: static;
                margin-bottom: 2rem;
            }
            
            .stats-number {
                font-size: 2rem;
            }
        }

        /* Chart Containers */
        .chart-container {
            position: relative;
            height: 300px;
            margin: 1rem 0;
        }

        /* File Upload Area */
        .upload-area {
            border: 3px dashed var(--border-color);
            border-radius: 12px;
            padding: 3rem 2rem;
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: var(--primary-color);
            background: rgba(30, 58, 138, 0.05);
        }

        .upload-area.drag-over {
            border-color: var(--accent-color);
            background: rgba(16, 185, 129, 0.1);
        }

        /* Social Platform Icons */
        .platform-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 10px;
        }

        .platform-facebook { background: #1877f2; color: white; }
        .platform-instagram { background: linear-gradient(45deg, #405de6, #5851db, #833ab4, #c13584, #e1306c, #fd1d1d); color: white; }
        .platform-twitter { background: #1da1f2; color: white; }
        .platform-linkedin { background: #0077b5; color: white; }
        .platform-youtube { background: #ff0000; color: white; }
        .platform-tiktok { background: #000000; color: white; }

        /* Notification Styles */
        .notification {
            position: fixed;
            top: 100px;
            left: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            padding: 1rem 1.5rem;
            z-index: 9999;
            transform: translateX(-100%);
            transition: var(--transition);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            border-right: 4px solid var(--accent-color);
        }

        .notification.error {
            border-right: 4px solid var(--danger-color);
        }

        .notification.warning {
            border-right: 4px solid var(--warning-color);
        }

        /* Login Screen Styles */
        #loginScreen {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
        }

        .login-card {
            width: 100%;
            max-width: 400px;
            border-radius: 16px;
            overflow: hidden;
        }

        /* Calendar Styles */
        .calendar-grid {
            font-family: inherit;
        }
        .calendar-header {
            text-align: center;
            margin-bottom: 1rem;
        }
        .calendar-month {
            font-size: 1.25rem;
            font-weight: 600;
        }
        .calendar-days-header, .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
        }
        .calendar-day-header {
            text-align: center;
            padding: 0.5rem;
            font-weight: 600;
            background: var(--primary-color);
            color: white;
        }
        .calendar-day {
            text-align: center;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: var(--transition);
        }
        .calendar-day:hover {
            background: var(--light-color);
        }
        .calendar-day.today {
            background: var(--primary-color);
            color: white;
            font-weight: 600;
        }
        .calendar-day.empty {
            cursor: default;
        }
        .calendar-day.has-posts {
            background: rgba(16, 185, 129, 0.2);
            position: relative;
        }
        .calendar-day.has-posts::after {
            content: '';
            position: absolute;
            bottom: 4px;
            right: 50%;
            transform: translateX(50%);
            width: 6px;
            height: 6px;
            background: var(--accent-color);
            border-radius: 50%;
        }

        /* Content Preview */
        .post-preview {
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem;
            background: white;
        }
        .preview-account {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        .preview-account-img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--secondary-color);
            margin-left: 0.5rem;
        }
        .preview-content {
            margin-bottom: 0.5rem;
        }
        .preview-media {
            margin-bottom: 0.5rem;
            border-radius: 8px;
            overflow: hidden;
        }
        .preview-media img {
            width: 100%;
            height: auto;
        }

        /* AI Insights */
        .ai-insight-card {
            border-left: 4px solid var(--primary-color);
            padding: 1rem;
            background: rgba(30, 58, 138, 0.05);
            border-radius: 8px;
            margin-bottom: 1rem;
        }
    </style>
</head>
<body data-bs-theme="light">
    <!-- شاشة تسجيل الدخول -->
    <div id="loginScreen" class="container-fluid">
        <div class="card login-card shadow-lg">
            <div class="card-body p-5">
                <div class="text-center mb-4">
                    <i class="fas fa-share-alt fa-3x text-primary mb-3"></i>
                    <h2 class="fw-bold">SocialHub Pro</h2>
                    <p class="text-muted">منصة إدارة وسائل التواصل الاجتماعي المتقدمة</p>
                </div>
                
                <form id="loginForm">
                    <div class="mb-3">
                        <label for="loginEmail" class="form-label">البريد الإلكتروني</label>
                        <input type="email" class="form-control" id="loginEmail" required>
                    </div>
                    
                    <div class="mb-3">
                        <label for="loginPassword" class="form-label">كلمة المرور</label>
                        <input type="password" class="form-control" id="loginPassword" required>
                    </div>
                    
                    <div class="mb-3 form-check">
                        <input type="checkbox" class="form-check-input" id="rememberMe">
                        <label class="form-check-label" for="rememberMe">تذكرني</label>
                    </div>
                    
                    <button type="submit" class="btn btn-primary w-100 mb-3">تسجيل الدخول</button>
                    
                    <div class="text-center">
                        <a href="#" id="showRegister">إنشاء حساب جديد</a> | 
                        <a href="#" id="showForgotPassword">نسيت كلمة المرور؟</a>
                    </div>
                </form>
                
                <form id="registerForm" class="d-none">
                    <div class="mb-3">
                        <label for="registerName" class="form-label">الاسم الكامل</label>
                        <input type="text" class="form-control" id="registerName" required>
                    </div>
                    
                    <div class="mb-3">
                        <label for="registerEmail" class="form-label">البريد الإلكتروني</label>
                        <input type="email" class="form-control" id="registerEmail" required>
                    </div>
                    
                    <div class="mb-3">
                        <label for="registerPassword" class="form-label">كلمة المرور</label>
                        <input type="password" class="form-control" id="registerPassword" required>
                    </div>
                    
                    <div class="mb-3">
                        <label for="registerConfirmPassword" class="form-label">تأكيد كلمة المرور</label>
                        <input type="password" class="form-control" id="registerConfirmPassword" required>
                    </div>
                    
                    <button type="submit" class="btn btn-success w-100 mb-3">إنشاء حساب</button>
                    
                    <div class="text-center">
                        <a href="#" id="showLogin">العودة لتسجيل الدخول</a>
                    </div>
                </form>
                
                <form id="forgotPasswordForm" class="d-none">
                    <div class="mb-3">
                        <label for="forgotEmail" class="form-label">البريد الإلكتروني</label>
                        <input type="email" class="form-control" id="forgotEmail" required>
                    </div>
                    
                    <button type="submit" class="btn btn-warning w-100 mb-3">إرسال رابط إعادة التعيين</button>
                    
                    <div class="text-center">
                        <a href="#" id="showLoginFromForgot">العودة لتسجيل الدخول</a>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- التطبيق الرئيسي -->
    <div id="appContainer" class="d-none">
        <!-- Navigation Header -->
        <nav class="navbar navbar-expand-lg header">
            <div class="container-fluid">
                <a class="navbar-brand" href="#">
                    <i class="fas fa-share-alt me-2"></i>
                    SocialHub Pro v9.0
                </a>
                
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item">
                            <a class="nav-link active" href="#dashboard">
                                <i class="fas fa-tachometer-alt me-1"></i>
                                لوحة التحكم
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#content">
                                <i class="fas fa-edit me-1"></i>
                                إنشاء المحتوى
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#analytics">
                                <i class="fas fa-chart-line me-1"></i>
                                التحليلات
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#calendar">
                                <i class="fas fa-calendar me-1"></i>
                                التقويم
                            </a>
                        </li>
                    </ul>
                    
                    <div class="d-flex align-items-center">
                        <!-- Notifications -->
                        <div class="dropdown me-3">
                            <button class="btn btn-outline-light position-relative" type="button" data-bs-toggle="dropdown">
                                <i class="fas fa-bell"></i>
                                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" id="notificationCount">
                                    0
                                </span>
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end" id="notificationsDropdown">
                                <li><h6 class="dropdown-header">الإشعارات الجديدة</h6></li>
                                <li><a class="dropdown-item" href="#"><i class="fas fa-info-circle text-info me-2"></i>لا توجد إشعارات جديدة</a></li>
                            </ul>
                        </div>
                        
                        <!-- Theme Toggle -->
                        <button class="btn theme-toggle me-3" id="themeToggle">
                            <i class="fas fa-moon" id="themeIcon"></i>
                        </button>
                        
                        <!-- User Menu -->
                        <div class="dropdown">
                            <button class="btn btn-outline-light" type="button" data-bs-toggle="dropdown">
                                <i class="fas fa-user-circle me-1"></i>
                                <span id="userName">المستخدم</span>
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end">
                                <li><a class="dropdown-item" href="#profile"><i class="fas fa-user me-2"></i>الملف الشخصي</a></li>
                                <li><a class="dropdown-item" href="#settings"><i class="fas fa-cog me-2"></i>الإعدادات</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="#" id="logoutBtn"><i class="fas fa-sign-out-alt me-2"></i>تسجيل الخروج</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <div class="container-fluid mt-4">
            <div class="row">
                <!-- Sidebar -->
                <div class="col-lg-3 col-md-4">
                    <div class="sidebar animate-fade-in">
                        <h5 class="mb-4">القوائم الرئيسية</h5>
                        
                        <a href="#dashboard" class="sidebar-item active" data-section="dashboard">
                            <i class="fas fa-tachometer-alt"></i>
                            لوحة التحكم
                        </a>
                        
                        <a href="#content" class="sidebar-item" data-section="content">
                            <i class="fas fa-edit"></i>
                            إنشاء المحتوى
                        </a>
                        
                        <a href="#analytics" class="sidebar-item" data-section="analytics">
                            <i class="fas fa-chart-line"></i>
                            التحليلات المتقدمة
                        </a>
                        
                        <a href="#calendar" class="sidebar-item" data-section="calendar">
                            <i class="fas fa-calendar"></i>
                            التقويم الذكي
                        </a>
                        
                        <a href="#accounts" class="sidebar-item" data-section="accounts">
                            <i class="fas fa-users"></i>
                            الحسابات المتصلة
                        </a>
                        
                        <a href="#ai-tools" class="sidebar-item" data-section="ai-tools">
                            <i class="fas fa-robot"></i>
                            أدوات الذكاء الاصطناعي
                        </a>
                        
                        <a href="#bulk-import" class="sidebar-item" data-section="bulk-import">
                            <i class="fas fa-upload"></i>
                            استيراد المحتوى
                        </a>
                        
                        <a href="#settings" class="sidebar-item" data-section="settings">
                            <i class="fas fa-cog"></i>
                            الإعدادات
                        </a>
                    </div>
                </div>

                <!-- Main Content Area -->
                <div class="col-lg-9 col-md-8">
                    <!-- Dashboard Section -->
                    <div id="dashboard-section" class="content-section animate-fade-in">
                        <!-- Stats Cards -->
                        <div class="row mb-4">
                            <div class="col-lg-3 col-md-6 mb-3">
                                <div class="stats-card">
                                    <div class="stats-number" id="totalPosts">0</div>
                                    <div class="stats-label">إجمالي المنشورات</div>
                                    <div class="stats-change">
                                        <i class="fas fa-arrow-up text-white"></i>
                                        <span id="postsGrowth">+0%</span> هذا الأسبوع
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-lg-3 col-md-6 mb-3">
                                <div class="stats-card" style="background: var(--gradient-primary);">
                                    <div class="stats-number" id="totalEngagement">0</div>
                                    <div class="stats-label">إجمالي التفاعل</div>
                                    <div class="stats-change">
                                        <i class="fas fa-arrow-up text-white"></i>
                                        <span id="engagementGrowth">+0%</span> هذا الأسبوع
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-lg-3 col-md-6 mb-3">
                                <div class="stats-card" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                                    <div class="stats-number" id="totalReach">0</div>
                                    <div class="stats-label">إجمالي الوصول</div>
                                    <div class="stats-change">
                                        <i class="fas fa-arrow-up text-white"></i>
                                        <span id="reachGrowth">+0%</span> هذا الأسبوع
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-lg-3 col-md-6 mb-3">
                                <div class="stats-card" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);">
                                    <div class="stats-number" id="scheduledPosts">0</div>
                                    <div class="stats-label">المنشورات المجدولة</div>
                                    <div class="stats-change">
                                        <i class="fas fa-clock text-white"></i>
                                        <span>معلقة</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Real-time Activity & Performance -->
                        <div class="row mb-4">
                            <div class="col-lg-8">
                                <div class="card">
                                    <div class="card-header">
                                        <h5 class="mb-0">
                                            <i class="fas fa-chart-area me-2"></i>
                                            أداء المنصات - الأسبوع الماضي
                                        </h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="chart-container">
                                            <canvas id="performanceChart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-lg-4">
                                <div class="card">
                                    <div class="card-header">
                                        <h5 class="mb-0">
                                            <i class="fas fa-rss me-2"></i>
                                            النشاط المباشر
                                        </h5>
                                    </div>
                                    <div class="card-body">
                                        <div id="realTimeActivity">
                                            <div class="text-center py-4">
                                                <div class="loading-spinner mx-auto"></div>
                                                <p class="mt-2 text-muted">جاري تحميل النشاط...</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- AI Insights -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-brain me-2"></i>
                                    رؤى الذكاء الاصطناعي
                                    <span class="badge bg-success ms-2">نشط</span>
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="border-end pe-3">
                                            <h6><i class="fas fa-clock text-primary me-2"></i>أفضل وقت للنشر</h6>
                                            <div class="ai-insight-card">
                                                <div class="loading-spinner mx-auto mb-2"></div>
                                                <p class="mb-0 small">جاري تحليل أنماط نشاط جمهورك...</p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-4">
                                        <div class="border-end pe-3">
                                            <h6><i class="fas fa-hashtag text-primary me-2"></i>الهاشتاغات الرائجة</h6>
                                            <div class="ai-insight-card">
                                                <div class="loading-spinner mx-auto mb-2"></div>
                                                <p class="mb-0 small">جاري تحميل الهاشتاغات الرائجة...</p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-4">
                                        <div>
                                            <h6><i class="fas fa-lightbulb text-primary me-2"></i>توصيات المحتوى</h6>
                                            <div class="ai-insight-card">
                                                <div class="loading-spinner mx-auto mb-2"></div>
                                                <p class="mb-0 small">جاري تحليل أداء المحتوى...</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Content Creation Section -->
                    <div id="content-section" class="content-section d-none">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-robot me-2"></i>
                                    منشئ المحتوى بالذكاء الاصطناعي
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-lg-8">
                                        <div class="mb-3">
                                            <label for="contentText" class="form-label">محتوى المنشور</label>
                                            <textarea class="form-control" id="contentText" rows="4" placeholder="اكتب محتوى المنشور أو استخدم الذكاء الاصطناعي لتوليد المحتوى..."></textarea>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label">رفع الوسائط</label>
                                            <div class="upload-area" id="mediaUpload">
                                                <i class="fas fa-cloud-upload-alt fa-3x text-muted mb-3"></i>
                                                <h6>اسحب وأسقط الملفات هنا أو انقر للتحديد</h6>
                                                <p class="text-muted">يدعم الصور والفيديوهات (الحد الأقصى 50 ميجا)</p>
                                                <input type="file" id="mediaInput" multiple accept="image/*,video/*" style="display: none;">
                                            </div>
                                            <div id="uploadedMedia" class="mt-3"></div>
                                        </div>
                                        
                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <label for="aiTone" class="form-label">نبرة المحتوى</label>
                                                <select class="form-select" id="aiTone">
                                                    <option value="professional">مهنية</option>
                                                    <option value="casual">عادية</option>
                                                    <option value="friendly">ودودة</option>
                                                    <option value="formal">رسمية</option>
                                                    <option value="creative">إبداعية</option>
                                                </select>
                                            </div>
                                            
                                            <div class="col-md-6">
                                                <label for="contentLength" class="form-label">طول المحتوى</label>
                                                <select class="form-select" id="contentLength">
                                                    <option value="short">قصير (50-100 كلمة)</option>
                                                    <option value="medium">متوسط (100-200 كلمة)</option>
                                                    <option value="long">طويل (200+ كلمة)</option>
                                                </select>
                                            </div>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label for="aiPrompt" class="form-label">موضوع المحتوى</label>
                                            <input type="text" class="form-control" id="aiPrompt" placeholder="مثال: نصائح لتحسين الإنتاجية في العمل">
                                        </div>
                                        
                                        <div class="d-flex gap-2 mb-3">
                                            <button class="btn btn-primary" id="generateAIContentBtn">
                                                <i class="fas fa-magic me-2"></i>
                                                توليد المحتوى بالذكاء الاصطناعي
                                            </button>
                                            
                                            <button class="btn btn-outline-primary" id="generateHashtagsBtn">
                                                <i class="fas fa-hashtag me-2"></i>
                                                توليد هاشتاغات
                                            </button>
                                            
                                            <button class="btn btn-outline-secondary" id="analyzeContentBtn">
                                                <i class="fas fa-search me-2"></i>
                                                تحليل المحتوى
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <div class="col-lg-4">
                                        <div class="card border">
                                            <div class="card-header">
                                                <h6 class="mb-0">معاينة المنشور</h6>
                                            </div>
                                            <div class="card-body">
                                                <div id="postPreview" class="post-preview">
                                                    <div class="preview-account">
                                                        <div class="preview-account-img"></div>
                                                        <div>
                                                            <div class="fw-bold">اسم الحساب</div>
                                                            <small class="text-muted">الآن</small>
                                                        </div>
                                                    </div>
                                                    <div id="previewContent" class="preview-content">
                                                        سيظهر المحتوى هنا...
                                                    </div>
                                                    <div id="previewMedia" class="preview-media"></div>
                                                    <div class="text-muted">
                                                        <i class="fas fa-thumbs-up me-2"></i>
                                                        <i class="fas fa-comment me-2"></i>
                                                        <i class="fas fa-share me-2"></i>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="card border mt-3">
                                            <div class="card-header">
                                                <h6 class="mb-0">جدولة النشر</h6>
                                            </div>
                                            <div class="card-body">
                                                <div class="mb-3">
                                                    <label class="form-label">اختر المنصات</label>
                                                    <div class="d-flex flex-wrap gap-2">
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="checkbox" id="platform_facebook" checked>
                                                            <label class="form-check-label" for="platform_facebook">
                                                                <i class="fab fa-facebook-f text-primary"></i> فيسبوك
                                                            </label>
                                                        </div>
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="checkbox" id="platform_instagram" checked>
                                                            <label class="form-check-label" for="platform_instagram">
                                                                <i class="fab fa-instagram text-danger"></i> إنستغرام
                                                            </label>
                                                        </div>
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="checkbox" id="platform_twitter">
                                                            <label class="form-check-label" for="platform_twitter">
                                                                <i class="fab fa-twitter text-info"></i> تويتر
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="mb-3">
                                                    <label for="scheduleDate" class="form-label">تاريخ النشر</label>
                                                    <input type="datetime-local" class="form-control" id="scheduleDate">
                                                </div>
                                                
                                                <div class="d-grid gap-2">
                                                    <button class="btn btn-success" id="schedulePostBtn">
                                                        <i class="fas fa-calendar-plus me-2"></i>
                                                        جدولة المنشور
                                                    </button>
                                                    
                                                    <button class="btn btn-primary" id="publishNowBtn">
                                                        <i class="fas fa-paper-plane me-2"></i>
                                                        نشر الآن
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Analytics Section -->
                    <div id="analytics-section" class="content-section d-none">
                        <div class="row">
                            <div class="col-lg-8">
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <h5 class="mb-0">
                                            <i class="fas fa-chart-line me-2"></i>
                                            تحليلات الأداء المتقدمة
                                        </h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="row mb-3">
                                            <div class="col-md-4">
                                                <div class="text-center p-3 border rounded">
                                                    <h4 class="text-primary mb-1" id="engagementRate">0%</h4>
                                                    <small class="text-muted">معدل التفاعل</small>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="text-center p-3 border rounded">
                                                    <h4 class="text-success mb-1" id="clickThroughRate">0%</h4>
                                                    <small class="text-muted">معدل النقر</small>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="text-center p-3 border rounded">
                                                    <h4 class="text-warning mb-1" id="successRate">0%</h4>
                                                    <small class="text-muted">معدل النجاح</small>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="chart-container">
                                            <canvas id="analyticsChart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-lg-4">
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <h6 class="mb-0">توزيع المنصات</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="chart-container">
                                            <canvas id="platformChart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Detailed Metrics Table -->
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-table me-2"></i>
                                    مقاييس الأداء التفصيلية
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover" id="metricsTable">
                                        <thead>
                                            <tr>
                                                <th>المنصة</th>
                                                <th>المنشورات</th>
                                                <th>الوصول</th>
                                                <th>التفاعل</th>
                                                <th>معدل التفاعل</th>
                                                <th>النقرات</th>
                                                <th>التحويلات</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>
                                                    <i class="fab fa-facebook-f text-primary me-2"></i>
                                                    فيسبوك
                                                </td>
                                                <td><span class="badge bg-primary">0</span></td>
                                                <td>0</td>
                                                <td>0</td>
                                                <td>0%</td>
                                                <td>0</td>
                                                <td>0</td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <i class="fab fa-instagram text-danger me-2"></i>
                                                    إنستغرام
                                                </td>
                                                <td><span class="badge bg-danger">0</span></td>
                                                <td>0</td>
                                                <td>0</td>
                                                <td>0%</td>
                                                <td>0</td>
                                                <td>0</td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <i class="fab fa-twitter text-info me-2"></i>
                                                    تويتر
                                                </td>
                                                <td><span class="badge bg-info">0</span></td>
                                                <td>0</td>
                                                <td>0</td>
                                                <td>0%</td>
                                                <td>0</td>
                                                <td>0</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Calendar Section -->
                    <div id="calendar-section" class="content-section d-none">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">
                                    <i class="fas fa-calendar me-2"></i>
                                    التقويم الذكي - توقيت دبي
                                </h5>
                                <div>
                                    <button class="btn btn-sm btn-outline-primary me-2" id="prevMonth">
                                        <i class="fas fa-chevron-right"></i>
                                    </button>
                                    <button class="btn btn-sm btn-outline-primary" id="nextMonth">
                                        <i class="fas fa-chevron-left"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div id="calendar"></div>
                            </div>
                        </div>
                        
                        <div class="card mt-4">
                            <div class="card-header">
                                <h6 class="mb-0">رؤى الجدولة المثلى</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="text-center p-3 border rounded">
                                            <i class="fas fa-sun text-warning fa-2x mb-2"></i>
                                            <h6>أفضل وقت للنشر</h6>
                                            <p class="mb-0" id="bestTimeToPost">يحلل...</p>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="text-center p-3 border rounded">
                                            <i class="fas fa-users text-primary fa-2x mb-2"></i>
                                            <h6>ذروة النشاط</h6>
                                            <p class="mb-0" id="peakActivity">يحلل...</p>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="text-center p-3 border rounded">
                                            <i class="fas fa-hashtag text-success fa-2x mb-2"></i>
                                            <h6>الهاشتاغات الرائجة</h6>
                                            <p class="mb-0" id="trendingHashtags">يحمل...</p>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="text-center p-3 border rounded">
                                            <i class="fas fa-lightbulb text-warning fa-2x mb-2"></i>
                                            <h6>اقتراحات المحتوى</h6>
                                            <p class="mb-0" id="contentSuggestions">يحلل...</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Accounts Management -->
                    <div id="accounts-section" class="content-section d-none">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-users me-2"></i>
                                    الحسابات المتصلة
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <div class="card border">
                                            <div class="card-body">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <div class="d-flex align-items-center">
                                                        <div class="platform-icon platform-facebook me-3">
                                                            <i class="fab fa-facebook-f"></i>
                                                        </div>
                                                        <div>
                                                            <h6 class="mb-1">فيسبوك</h6>
                                                            <p class="mb-0 text-muted">
                                                                <strong id="facebookAccounts">0/10</strong> حسابات
                                                            </p>
                                                        </div>
                                                    </div>
                                                    <button class="btn btn-outline-primary btn-sm" id="connectFacebookBtn">
                                                        <i class="fas fa-plus me-1"></i>
                                                        ربط حساب
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6 mb-3">
                                        <div class="card border">
                                            <div class="card-body">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <div class="d-flex align-items-center">
                                                        <div class="platform-icon platform-instagram me-3">
                                                            <i class="fab fa-instagram"></i>
                                                        </div>
                                                        <div>
                                                            <h6 class="mb-1">إنستغرام</h6>
                                                            <p class="mb-0 text-muted">
                                                                <strong id="instagramAccounts">0/5</strong> حسابات
                                                            </p>
                                                        </div>
                                                    </div>
                                                    <button class="btn btn-outline-primary btn-sm" id="connectInstagramBtn">
                                                        <i class="fas fa-plus me-1"></i>
                                                        ربط حساب
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="alert alert-info">
                                    <i class="fas fa-info-circle me-2"></i>
                                    <strong>ملاحظة:</strong> لربط الحسابات، ستحتاج إلى مفاتيح API من كل منصة. راجع دليل الإعداد أدناه للحصول على التعليمات.
                                </div>
                                
                                <div class="mt-4">
                                    <h6>الحسابات المربوطة حالياً:</h6>
                                    <div id="connectedAccountsList" class="mt-2">
                                        <div class="alert alert-warning">
                                            <i class="fas fa-exclamation-triangle me-2"></i>
                                            لا توجد حسابات مربوطة حالياً
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- AI Tools Section -->
                    <div id="ai-tools-section" class="content-section d-none">
                        <div class="row">
                            <div class="col-md-6 mb-4">
                                <div class="card">
                                    <div class="card-header">
                                        <h5 class="mb-0">
                                            <i class="fas fa-lightbulb me-2"></i>
                                            اقتراحات المحتوى
                                        </h5>
                                    </div>
                                    <div class="card-body">
                                        <p>توصيات المحتوى المدعومة بالذكاء الاصطناعي بناءً على الاتجاهات والأداء</p>
                                        <div class="form-check form-switch mb-3">
                                            <input class="form-check-input" type="checkbox" id="contentSuggestionsToggle" checked>
                                            <label class="form-check-label" for="contentSuggestionsToggle">
                                                تفعيل اقتراحات المحتوى
                                            </label>
                                        </div>
                                        <button class="btn btn-primary" id="generateContentSuggestionsBtn">
                                            <i class="fas fa-magic me-2"></i>
                                            توليد اقتراحات
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6 mb-4">
                                <div class="card">
                                    <div class="card-header">
                                        <h5 class="mb-0">
                                            <i class="fas fa-clock me-2"></i>
                                            التوقيت الأمثل
                                        </h5>
                                    </div>
                                    <div class="card-body">
                                        <p>جدولة المنشورات تلقائياً في الأوقات المثلى لأقصى تفاعل</p>
                                        <div class="form-check form-switch mb-3">
                                            <input class="form-check-input" type="checkbox" id="optimalTimingToggle" checked>
                                            <label class="form-check-label" for="optimalTimingToggle">
                                                تفعيل التوقيت الأمثل
                                            </label>
                                        </div>
                                        <button class="btn btn-success" id="analyzeOptimalTimingBtn">
                                            <i class="fas fa-chart-line me-2"></i>
                                            تحليل التوقيت
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6 mb-4">
                                <div class="card">
                                    <div class="card-header">
                                        <h5 class="mb-0">
                                            <i class="fas fa-hashtag me-2"></i>
                                            توليد الهاشتاغات
                                        </h5>
                                    </div>
                                    <div class="card-body">
                                        <p>اقتراحات هاشتاغ ذكية لتحسين اكتشاف المنشورات</p>
                                        <div class="form-check form-switch mb-3">
                                            <input class="form-check-input" type="checkbox" id="hashtagGenerationToggle" checked>
                                            <label class="form-check-label" for="hashtagGenerationToggle">
                                                تفعيل توليد الهاشتاغات
                                            </label>
                                        </div>
                                        <button class="btn btn-info" id="generateSmartHashtagsBtn">
                                            <i class="fas fa-tags me-2"></i>
                                            توليد هاشتاغات
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6 mb-4">
                                <div class="card">
                                    <div class="card-header">
                                        <h5 class="mb-0">
                                            <i class="fas fa-chart-bar me-2"></i>
                                            تحليل الأداء
                                        </h5>
                                    </div>
                                    <div class="card-body">
                                        <p>رؤى وتوصيات مدعومة بالذكاء الاصطناعي لتحسين المحتوى</p>
                                        <div class="form-check form-switch mb-3">
                                            <input class="form-check-input" type="checkbox" id="performanceAnalysisToggle" checked>
                                            <label class="form-check-label" for="performanceAnalysisToggle">
                                                تفعيل تحليل الأداء
                                            </label>
                                        </div>
                                        <button class="btn btn-warning" id="runPerformanceAnalysisBtn">
                                            <i class="fas fa-search me-2"></i>
                                            تشغيل التحليل
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Bulk Import Section -->
                    <div id="bulk-import-section" class="content-section d-none">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-upload me-2"></i>
                                    استيراد المحتوى بالجملة
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="upload-area mb-4" id="bulkUpload">
                                    <i class="fas fa-file-upload fa-3x text-muted mb-3"></i>
                                    <h5>اسحب وأسقط ملفك هنا أو انقر للتحديد</h5>
                                    <p class="text-muted">يدعم ملفات CSV و JSON حتى 50 ميجا</p>
                                    <input type="file" id="bulkFileInput" accept=".csv,.json" style="display: none;">
                                </div>
                                
                                <div class="row mb-4">
                                    <div class="col-md-6">
                                        <h6>الأعمدة المطلوبة:</h6>
                                        <ul class="list-unstyled">
                                            <li><i class="fas fa-check text-success me-2"></i>المحتوى (content)</li>
                                            <li><i class="fas fa-check text-success me-2"></i>المنصة (platform)</li>
                                            <li><i class="fas fa-check text-success me-2"></i>تاريخ النشر (schedule_date)</li>
                                            <li><i class="fas fa-info-circle text-info me-2"></i>الوسائط (media_url) - اختياري</li>
                                            <li><i class="fas fa-info-circle text-info me-2"></i>الهاشتاغات (hashtags) - اختياري</li>
                                        </ul>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <h6>تحميل القوالب:</h6>
                                        <div class="d-grid gap-2">
                                            <button class="btn btn-outline-primary" id="downloadCsvTemplateBtn">
                                                <i class="fas fa-download me-2"></i>
                                                قالب CSV
                                            </button>
                                            <button class="btn btn-outline-secondary" id="downloadJsonTemplateBtn">
                                                <i class="fas fa-download me-2"></i>
                                                قالب JSON
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <div id="importProgress" class="d-none">
                                    <h6>تقدم الاستيراد:</h6>
                                    <div class="progress mb-3">
                                        <div class="progress-bar" role="progressbar" style="width: 0%"></div>
                                    </div>
                                    <div id="importStatus"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Settings Section -->
                    <div id="settings-section" class="content-section d-none">
                        <div class="row">
                            <div class="col-lg-8">
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <h5 class="mb-0">
                                            <i class="fas fa-cog me-2"></i>
                                            الإعدادات العامة
                                        </h5>
                                    </div>
                                    <div class="card-body">
                                        <form id="generalSettings">
                                            <div class="row mb-3">
                                                <div class="col-md-6">
                                                    <label for="timezone" class="form-label">المنطقة الزمنية</label>
                                                    <select class="form-select" id="timezone">
                                                        <option value="Asia/Dubai" selected>آسيا/دبي (UTC+4)</option>
                                                        <option value="Asia/Riyadh">آسيا/الرياض (UTC+3)</option>
                                                        <option value="Europe/London">أوروبا/لندن (UTC+0)</option>
                                                        <option value="America/New_York">أمريكا/نيويورك (UTC-5)</option>
                                                    </select>
                                                </div>
                                                
                                                <div class="col-md-6">
                                                    <label for="language" class="form-label">اللغة</label>
                                                    <select class="form-select" id="language">
                                                        <option value="ar" selected>العربية</option>
                                                        <option value="en">الإنجليزية</option>
                                                        <option value="fr">الفرنسية</option>
                                                    </select>
                                                </div>
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label for="defaultPostTone" class="form-label">نبرة المنشورات الافتراضية</label>
                                                <select class="form-select" id="defaultPostTone">
                                                    <option value="professional">مهنية</option>
                                                    <option value="casual">عادية</option>
                                                    <option value="friendly">ودودة</option>
                                                    <option value="formal">رسمية</option>
                                                </select>
                                            </div>
                                            
                                            <button type="submit" class="btn btn-primary">
                                                <i class="fas fa-save me-2"></i>
                                                حفظ الإعدادات
                                            </button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-lg-4">
                                <div class="card mb-4">
                                    <div class="card-header">
                                        <h6 class="mb-0">الأمان والخصوصية</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center mb-3">
                                            <div>
                                                <h6 class="mb-1">المصادقة الثنائية</h6>
                                                <small class="text-muted">أضف طبقة حماية إضافية لحسابك</small>
                                            </div>
                                            <div class="form-check form-switch">
                                                <input class="form-check-input" type="checkbox" id="twoFactorAuth">
                                            </div>
                                        </div>
                                        
                                        <div class="d-flex justify-content-between align-items-center mb-3">
                                            <div>
                                                <h6 class="mb-1">تشفير البيانات</h6>
                                                <small class="text-muted">تشفير AES-256 للبيانات الحساسة</small>
                                                <span class="badge bg-success ms-2">نشط</span>
                                            </div>
                                        </div>
                                        
                                        <button class="btn btn-outline-primary btn-sm mb-2 w-100" id="downloadBackupBtn">
                                            <i class="fas fa-download me-2"></i>
                                            تحميل نسخة احتياطية
                                        </button>
                                        
                                        <button class="btn btn-outline-secondary btn-sm w-100" id="manageSessionsBtn">
                                            <i class="fas fa-shield-alt me-2"></i>
                                            إدارة الجلسات
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notificationContainer"></div>

    <!-- Modals -->
    <!-- Modal لإدارة الحسابات -->
    <div class="modal fade" id="accountModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="accountModalTitle">ربط حساب جديد</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="accountModalBody">
                    <!-- سيتم ملؤه ديناميكيًا -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal لمعاينة التفاصيل -->
    <div class="modal fade" id="detailModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="detailModalTitle">التفاصيل</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="detailModalBody">
                    <!-- سيتم ملؤه ديناميكيًا -->
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
    
    <!-- Main Application Script -->
    <script>
        // تهيئة Firebase
        const firebaseConfig = {
            // إضافة معلومات التهيئة الخاصة بك هنا
            apiKey: "AIzaSyBKD3QIxJdHw__UG2TEqf0TqyYCnw8wJf8",
            authDomain: "socialhub-1370d.firebaseapp.com",
            projectId: "socialhub-1370d",
            storageBucket: "socialhub-1370d.firebasestorage.app",
            messagingSenderId: "84815590328",
            appId: "1:84815590328:web:2f12340380b37c2562d54d"
        };
        
        // تهيئة Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();
        const storage = firebase.storage();
        
        // Global Variables
        let currentUser = null;
        let currentSection = 'dashboard';
        let charts = {};
        let currentTheme = 'light';
        let userData = {};
        let connectedAccounts = {};
        let uploadedMedia = [];
        
        // Initialize Application
        document.addEventListener('DOMContentLoaded', function() {
            // التحقق من حالة المصادقة
            auth.onAuthStateChanged(user => {
                if (user) {
                    // المستخدم مسجل الدخول
                    currentUser = user;
                    loadUserData();
                    document.getElementById('loginScreen').classList.add('d-none');
                    document.getElementById('appContainer').classList.remove('d-none');
                    initializeApp();
                } else {
                    // المستخدم غير مسجل
                    document.getElementById('loginScreen').classList.remove('d-none');
                    document.getElementById('appContainer').classList.add('d-none');
                    setupAuthListeners();
                }
            });
        });
        
        function setupAuthListeners() {
            // تسجيل الدخول
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const email = document.getElementById('loginEmail').value;
                const password = document.getElementById('loginPassword').value;
                
                auth.signInWithEmailAndPassword(email, password)
                    .then((userCredential) => {
                        showNotification('تم تسجيل الدخول بنجاح!', 'success');
                    })
                    .catch((error) => {
                        showNotification('خطأ في تسجيل الدخول: ' + error.message, 'error');
                    });
            });
            
            // التسجيل
            document.getElementById('registerForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const name = document.getElementById('registerName').value;
                const email = document.getElementById('registerEmail').value;
                const password = document.getElementById('registerPassword').value;
                const confirmPassword = document.getElementById('registerConfirmPassword').value;
                
                if (password !== confirmPassword) {
                    showNotification('كلمات المرور غير متطابقة', 'error');
                    return;
                }
                
                auth.createUserWithEmailAndPassword(email, password)
                    .then((userCredential) => {
                        // حفظ بيانات المستخدم الإضافية
                        return db.collection('users').doc(userCredential.user.uid).set({
                            name: name,
                            email: email,
                            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                            settings: {
                                timezone: 'Asia/Dubai',
                                language: 'ar',
                                defaultPostTone: 'professional'
                            }
                        });
                    })
                    .then(() => {
                        showNotification('تم إنشاء الحساب بنجاح!', 'success');
                        showLoginForm();
                    })
                    .catch((error) => {
                        showNotification('خطأ في إنشاء الحساب: ' + error.message, 'error');
                    });
            });
            
            // إعادة تعيين كلمة المرور
            document.getElementById('forgotPasswordForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const email = document.getElementById('forgotEmail').value;
                
                auth.sendPasswordResetEmail(email)
                    .then(() => {
                        showNotification('تم إرسال رابط إعادة التعيين إلى بريدك الإلكتروني', 'success');
                        showLoginForm();
                    })
                    .catch((error) => {
                        showNotification('خطأ في إرسال رابط إعادة التعيين: ' + error.message, 'error');
                    });
            });
            
            // التنقل بين نماذج المصادقة
            document.getElementById('showRegister').addEventListener('click', function(e) {
                e.preventDefault();
                showRegisterForm();
            });
            
            document.getElementById('showLogin').addEventListener('click', function(e) {
                e.preventDefault();
                showLoginForm();
            });
            
            document.getElementById('showForgotPassword').addEventListener('click', function(e) {
                e.preventDefault();
                showForgotPasswordForm();
            });
            
            document.getElementById('showLoginFromForgot').addEventListener('click', function(e) {
                e.preventDefault();
                showLoginForm();
            });
        }
        
        function showLoginForm() {
            document.getElementById('loginForm').classList.remove('d-none');
            document.getElementById('registerForm').classList.add('d-none');
            document.getElementById('forgotPasswordForm').classList.add('d-none');
        }
        
        function showRegisterForm() {
            document.getElementById('loginForm').classList.add('d-none');
            document.getElementById('registerForm').classList.remove('d-none');
            document.getElementById('forgotPasswordForm').classList.add('d-none');
        }
        
        function showForgotPasswordForm() {
            document.getElementById('loginForm').classList.add('d-none');
            document.getElementById('registerForm').classList.add('d-none');
            document.getElementById('forgotPasswordForm').classList.remove('d-none');
        }
        
        function loadUserData() {
            // تحميل بيانات المستخدم من Firestore
            db.collection('users').doc(currentUser.uid).get()
                .then(doc => {
                    if (doc.exists) {
                        userData = doc.data();
                        applyUserSettings();
                        updateUIWithUserData();
                        loadConnectedAccounts();
                        loadDashboardData();
                    }
                })
                .catch(error => {
                    console.error('Error loading user data:', error);
                });
        }
        
        function applyUserSettings() {
            if (userData.settings) {
                if (document.getElementById('timezone')) {
                    document.getElementById('timezone').value = userData.settings.timezone || 'Asia/Dubai';
                }
                if (document.getElementById('language')) {
                    document.getElementById('language').value = userData.settings.language || 'ar';
                }
                if (document.getElementById('defaultPostTone')) {
                    document.getElementById('defaultPostTone').value = userData.settings.defaultPostTone || 'professional';
                }
            }
        }
        
        function updateUIWithUserData() {
            // تحديث واجهة المستخدم ببيانات المستخدم
            if (userData.name) {
                document.getElementById('userName').textContent = userData.name;
            }
        }
        
        function loadConnectedAccounts() {
            // تحميل الحسابات المتصلة من Firestore
            db.collection('users').doc(currentUser.uid).collection('connectedAccounts').get()
                .then(snapshot => {
                    connectedAccounts = {};
                    const accountsList = document.getElementById('connectedAccountsList');
                    
                    if (snapshot.empty) {
                        accountsList.innerHTML = `
                            <div class="alert alert-warning">
                                <i class="fas fa-exclamation-triangle me-2"></i>
                                لا توجد حسابات مربوطة حالياً
                            </div>
                        `;
                        return;
                    }
                    
                    accountsList.innerHTML = '';
                    snapshot.forEach(doc => {
                        const account = doc.data();
                        connectedAccounts[doc.id] = account;
                        
                        const accountElement = document.createElement('div');
                        accountElement.className = 'card mb-2';
                        accountElement.innerHTML = `
                            <div class="card-body py-2">
                                <div class="d-flex align-items-center">
                                    <div class="platform-icon platform-${account.platform} me-3">
                                        <i class="fab fa-${account.platform}"></i>
                                    </div>
                                    <div class="flex-grow-1">
                                        <h6 class="mb-0">${account.name || account.platform}</h6>
                                        <small class="text-muted">تم الربط في ${new Date(account.connectedAt?.toDate()).toLocaleDateString('ar-EG')}</small>
                                    </div>
                                    <button class="btn btn-sm btn-outline-danger" onclick="disconnectAccount('${doc.id}')">
                                        <i class="fas fa-unlink"></i>
                                    </button>
                                </div>
                            </div>
                        `;
                        
                        accountsList.appendChild(accountElement);
                    });
                    
                    updateAccountsUI();
                })
                .catch(error => {
                    console.error('Error loading connected accounts:', error);
                });
        }
        
        function updateAccountsUI() {
            // تحديث واجهة الحسابات المتصلة
            const facebookCount = Object.values(connectedAccounts).filter(acc => acc.platform === 'facebook').length;
            const instagramCount = Object.values(connectedAccounts).filter(acc => acc.platform === 'instagram').length;
            const twitterCount = Object.values(connectedAccounts).filter(acc => acc.platform === 'twitter').length;
            
            document.getElementById('facebookAccounts').textContent = `${facebookCount}/10`;
            document.getElementById('instagramAccounts').textContent = `${instagramCount}/5`;
        }
        
        function initializeApp() {
            // Setup event listeners
            setupEventListeners();
            
            // Initialize charts
            initializeCharts();
            
            // Load initial data
            loadDashboardData();
            
            // Setup calendar
            setupCalendar();
            
            // Register service worker for PWA
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => console.log('SW registered'))
                    .catch(error => console.log('SW registration failed'));
            }
        }
        
        function setupEventListeners() {
            // Sidebar navigation
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const section = this.getAttribute('data-section');
                    switchSection(section);
                });
            });
            
            // Theme toggle
            document.getElementById('themeToggle').addEventListener('click', toggleTheme);
            
            // Logout
            document.getElementById('logoutBtn').addEventListener('click', function(e) {
                e.preventDefault();
                auth.signOut().then(() => {
                    showNotification('تم تسجيل الخروج بنجاح', 'success');
                });
            });
            
            // Content creation
            document.getElementById('contentText').addEventListener('input', updatePreview);
            document.getElementById('generateAIContentBtn').addEventListener('click', generateAIContent);
            document.getElementById('generateHashtagsBtn').addEventListener('click', generateHashtags);
            document.getElementById('analyzeContentBtn').addEventListener('click', analyzeContent);
            document.getElementById('schedulePostBtn').addEventListener('click', schedulePost);
            document.getElementById('publishNowBtn').addEventListener('click', publishNow);
            
            // Media upload
            const mediaUpload = document.getElementById('mediaUpload');
            const mediaInput = document.getElementById('mediaInput');
            
            mediaUpload.addEventListener('click', () => mediaInput.click());
            mediaUpload.addEventListener('dragover', handleDragOver);
            mediaUpload.addEventListener('drop', handleMediaDrop);
            mediaInput.addEventListener('change', handleMediaSelect);
            
            // Bulk upload
            const bulkUpload = document.getElementById('bulkUpload');
            const bulkFileInput = document.getElementById('bulkFileInput');
            
            bulkUpload.addEventListener('click', () => bulkFileInput.click());
            bulkUpload.addEventListener('dragover', handleDragOver);
            bulkUpload.addEventListener('drop', handleBulkDrop);
            bulkFileInput.addEventListener('change', handleBulkSelect);
            
            // Account connection
            document.getElementById('connectFacebookBtn').addEventListener('click', () => connectAccount('facebook'));
            document.getElementById('connectInstagramBtn').addEventListener('click', () => connectAccount('instagram'));
            
            // AI Tools
            document.getElementById('generateContentSuggestionsBtn').addEventListener('click', generateContentSuggestions);
            document.getElementById('analyzeOptimalTimingBtn').addEventListener('click', analyzeOptimalTiming);
            document.getElementById('generateSmartHashtagsBtn').addEventListener('click', generateSmartHashtags);
            document.getElementById('runPerformanceAnalysisBtn').addEventListener('click', runPerformanceAnalysis);
            
            // Templates
            document.getElementById('downloadCsvTemplateBtn').addEventListener('click', () => downloadTemplate('csv'));
            document.getElementById('downloadJsonTemplateBtn').addEventListener('click', () => downloadTemplate('json'));
            
            // Settings
            document.getElementById('generalSettings').addEventListener('submit', saveSettings);
            document.getElementById('downloadBackupBtn').addEventListener('click', downloadBackup);
            document.getElementById('manageSessionsBtn').addEventListener('click', manageSessions);
            
            // Calendar navigation
            document.getElementById('prevMonth').addEventListener('click', navigateCalendarPrev);
            document.getElementById('nextMonth').addEventListener('click', navigateCalendarNext);
        }
        
        function switchSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.add('d-none');
            });
            
            // Show selected section
            document.getElementById(sectionName + '-section').classList.remove('d-none');
            
            // Update sidebar active state
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('data-section') === sectionName) {
                    item.classList.add('active');
                }
            });
            
            currentSection = sectionName;
            
            // Load section-specific data
            loadSectionData(sectionName);
        }
        
        function loadSectionData(section) {
            switch(section) {
                case 'analytics':
                    loadAnalyticsData();
                    break;
                case 'calendar':
                    loadCalendarData();
                    break;
                case 'ai-tools':
                    loadAIToolsData();
                    break;
                case 'accounts':
                    loadConnectedAccounts();
                    break;
            }
        }
        
        function initializeCharts() {
            // Performance Chart
            const performanceCtx = document.getElementById('performanceChart');
            if (performanceCtx) {
                charts.performance = new Chart(performanceCtx.getContext('2d'), {
                    type: 'line',
                    data: {
                        labels: ['السبت', 'الأحد', 'الاثنين', 'الثلاثاء', 'الأربعاء', 'الخميس', 'الجمعة'],
                        datasets: [{
                            label: 'فيسبوك',
                            data: [0, 0, 0, 0, 0, 0, 0],
                            borderColor: '#1877f2',
                            backgroundColor: 'rgba(24, 119, 242, 0.1)',
                            tension: 0.4
                        }, {
                            label: 'إنستغرام',
                            data: [0, 0, 0, 0, 0, 0, 0],
                            borderColor: '#e1306c',
                            backgroundColor: 'rgba(225, 48, 108, 0.1)',
                            tension: 0.4
                        }, {
                            label: 'تويتر',
                            data: [0, 0, 0, 0, 0, 0, 0],
                            borderColor: '#1da1f2',
                            backgroundColor: 'rgba(29, 161, 242, 0.1)',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
            
            // Analytics Chart
            const analyticsCtx = document.getElementById('analyticsChart');
            if (analyticsCtx) {
                charts.analytics = new Chart(analyticsCtx.getContext('2d'), {
                    type: 'bar',
                    data: {
                        labels: ['يناير', 'فبراير', 'مارس', 'أبريل', 'مايو', 'يونيو'],
                        datasets: [{
                            label: 'التفاعل',
                            data: [0, 0, 0, 0, 0, 0],
                            backgroundColor: 'rgba(30, 58, 138, 0.8)'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false
                    }
                });
            }
            
            // Platform Distribution Chart
            const platformCtx = document.getElementById('platformChart');
            if (platformCtx) {
                charts.platform = new Chart(platformCtx.getContext('2d'), {
                    type: 'doughnut',
                    data: {
                        labels: ['فيسبوك', 'إنستغرام', 'تويتر'],
                        datasets: [{
                            data: [0, 0, 0],
                            backgroundColor: ['#1877f2', '#e1306c', '#1da1f2']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false
                    }
                });
            }
        }
        
        function loadDashboardData() {
            // تحميل البيانات الحقيقية من Firestore
            const postsPromise = db.collection('users').doc(currentUser.uid).collection('posts')
                .where('status', '==', 'published').get();
                
            const scheduledPromise = db.collection('users').doc(currentUser.uid).collection('scheduledPosts')
                .where('status', '==', 'scheduled').get();
                
            Promise.all([postsPromise, scheduledPromise])
                .then(([postsSnapshot, scheduledSnapshot]) => {
                    const totalPosts = postsSnapshot.size;
                    const scheduledPosts = scheduledSnapshot.size;
                    
                    // حساب التفاعل والوصول (بيانات وهمية في هذا النموذج)
                    const totalEngagement = totalPosts * 150;
                    const totalReach = totalPosts * 1000;
                    
                    updateStats({
                        totalPosts: totalPosts,
                        totalEngagement: totalEngagement,
                        totalReach: totalReach,
                        scheduledPosts: scheduledPosts,
                        postsGrowth: '+12%',
                        engagementGrowth: '+8%',
                        reachGrowth: '+15%'
                    });
                    
                    // تحديث الرسوم البيانية
                    updateChartsWithRealData();
                    
                    // تحميل النشاط المباشر
                    loadRealTimeActivity();
                    
                    // تحميل رؤى الذكاء الاصطناعي
                    loadAIInsights();
                })
                .catch(error => {
                    console.error('Error loading dashboard data:', error);
                });
        }
        
        function updateStats(data) {
            document.getElementById('totalPosts').textContent = data.totalPosts;
            document.getElementById('totalEngagement').textContent = data.totalEngagement.toLocaleString();
            document.getElementById('totalReach').textContent = data.totalReach.toLocaleString();
            document.getElementById('scheduledPosts').textContent = data.scheduledPosts;
            document.getElementById('postsGrowth').textContent = data.postsGrowth;
            document.getElementById('engagementGrowth').textContent = data.engagementGrowth;
            document.getElementById('reachGrowth').textContent = data.reachGrowth;
        }
        
        function updateChartsWithRealData() {
            if (charts.performance) {
                // في الإصدار الحقيقي، استخدم بيانات حقيقية
                const datasets = charts.performance.data.datasets;
                datasets[0].data = [45, 52, 38, 60, 55, 65, 70]; // فيسبوك
                datasets[1].data = [30, 40, 35, 50, 45, 55, 60]; // إنستغرام
                datasets[2].data = [20, 25, 30, 35, 40, 45, 50]; // تويتر
                charts.performance.update();
            }
            
            if (charts.platform) {
                // تحديث بيانات توزيع المنصات
                charts.platform.data.datasets[0].data = [45, 35, 20]; // فيسبوك، إنستغرام، تويتر
                charts.platform.update();
            }
        }
        
        function loadRealTimeActivity() {
            // محاكاة تحميل النشاط المباشر
            setTimeout(() => {
                const activityContainer = document.getElementById('realTimeActivity');
                activityContainer.innerHTML = `
                    <div class="d-flex align-items-center mb-3">
                        <div class="platform-icon platform-instagram">
                            <i class="fab fa-instagram"></i>
                        </div>
                        <div>
                            <div class="fw-bold">إنستغرام</div>
                            <small class="text-muted">منشور جديد • منذ 5 دقائق</small>
                        </div>
                    </div>
                    
                    <div class="d-flex align-items-center mb-3">
                        <div class="platform-icon platform-facebook">
                            <i class="fab fa-facebook-f"></i>
                        </div>
                        <div>
                            <div class="fw-bold">فيسبوك</div>
                            <small class="text-muted">تعليق جديد • منذ 12 دقيقة</small>
                        </div>
                    </div>
                    
                    <div class="d-flex align-items-center">
                        <div class="platform-icon platform-twitter">
                            <i class="fab fa-twitter"></i>
                        </div>
                        <div>
                            <div class="fw-bold">تويتر</div>
                            <small class="text-muted">إعادة تغريد • منذ 18 دقيقة</small>
                        </div>
                    </div>
                `;
            }, 1500);
        }
        
        function loadAIInsights() {
            // محاكاة تحميل رؤى الذكاء الاصطناعي
            setTimeout(() => {
                document.querySelectorAll('.ai-insight-card').forEach((card, index) => {
                    if (index === 0) {
                        card.innerHTML = `<p class="mb-0">أفضل أوقات النشر: 2:00 م - 4:00 م</p>`;
                    } else if (index === 1) {
                        card.innerHTML = `<p class="mb-0">#تسويق #إبداع #محتوى #SocialHubPro</p>`;
                    } else if (index === 2) {
                        card.innerHTML = `<p class="mb-0">ركز على المحتوى المرئي لزيادة التفاعل</p>`;
                    }
                });
            }, 2000);
        }
        
        function loadAnalyticsData() {
            // تحميل بيانات التحليلات من Firestore
            db.collection('users').doc(currentUser.uid).collection('analytics').doc('summary').get()
                .then(doc => {
                    if (doc.exists) {
                        const data = doc.data();
                        document.getElementById('engagementRate').textContent = data.engagementRate + '%';
                        document.getElementById('clickThroughRate').textContent = data.clickThroughRate + '%';
                        document.getElementById('successRate').textContent = data.successRate + '%';
                    } else {
                        // استخدام بيانات افتراضية إذا لم توجد بيانات
                        document.getElementById('engagementRate').textContent = '8.5%';
                        document.getElementById('clickThroughRate').textContent = '4.2%';
                        document.getElementById('successRate').textContent = '12.8%';
                    }
                })
                .catch(error => {
                    console.error('Error loading analytics data:', error);
                });
        }
        
        function loadCalendarData() {
            // سيتم تحميل بيانات التقويم من Firestore
            updateCalendar();
        }
        
        function loadAIToolsData() {
            // سيتم تحميل بيانات أدوات الذكاء الاصطناعي
        }
        
        // Theme Management
        function toggleTheme() {
            const body = document.body;
            const themeIcon = document.getElementById('themeIcon');
            
            if (currentTheme === 'light') {
                body.setAttribute('data-bs-theme', 'dark');
                themeIcon.className = 'fas fa-sun';
                currentTheme = 'dark';
            } else {
                body.setAttribute('data-bs-theme', 'light');
                themeIcon.className = 'fas fa-moon';
                currentTheme = 'light';
            }
            
            localStorage.setItem('theme', currentTheme);
        }
        
        // Content Management Functions
        function generateAIContent() {
            const prompt = document.getElementById('aiPrompt').value;
            const tone = document.getElementById('aiTone').value;
            const length = document.getElementById('contentLength').value;
            
            if (!prompt.trim()) {
                showNotification('يرجى إدخال موضوع المحتوى', 'warning');
                return;
            }
            
            showNotification('جاري توليد المحتوى بالذكاء الاصطناعي...', 'info');
            
            // محاكاة توليد المحتوى بالذكاء الاصطناعي
            setTimeout(() => {
                const sampleContent = `محتوى تم توليده بواسطة الذكاء الاصطناعي حول: ${prompt}

هذا مثال على محتوى ${tone} ${length} تم إنشاؤه بناءً على طلبك. يمكنك تعديله حسب احتياجاتك.

#${prompt.replace(/\s+/g, '_')} #محتوى_ذكي #SocialHubPro`;
                
                document.getElementById('contentText').value = sampleContent;
                updatePreview();
                showNotification('تم توليد المحتوى بنجاح!', 'success');
            }, 2000);
        }
        
        function generateHashtags() {
            showNotification('جاري توليد الهاشتاغات...', 'info');
            
            setTimeout(() => {
                const content = document.getElementById('contentText').value;
                const hashtags = '#محتوى_رقمي #تسويق #وسائل_التواصل #إبداع #نجاح';
                
                document.getElementById('contentText').value = content + '\n\n' + hashtags;
                updatePreview();
                showNotification('تم توليد الهاشتاغات بنجاح!', 'success');
            }, 1500);
        }
        
        function analyzeContent() {
            const content = document.getElementById('contentText').value;
            
            if (!content.trim()) {
                showNotification('يرجى إدخال محتوى للتحليل', 'warning');
                return;
            }
            
            showNotification('جاري تحليل المحتوى...', 'info');
            
            setTimeout(() => {
                const analysis = {
                    sentiment: 'إيجابي',
                    readability: 'ممتاز',
                    engagement_score: '85%',
                    suggestions: ['إضافة المزيد من الهاشتاغات', 'استخدام صورة جذابة']
                };
                
                showNotification(`تحليل المحتوى - المشاعر: ${analysis.sentiment}, قابلية القراءة: ${analysis.readability}, درجة التفاعل المتوقعة: ${analysis.engagement_score}`, 'success');
            }, 2000);
        }
        
        function updatePreview() {
            const content = document.getElementById('contentText').value;
            document.getElementById('previewContent').textContent = content || 'سيظهر المحتوى هنا...';
            
            // تحديث المعاينة بالوسائط المرفوعة
            const previewMedia = document.getElementById('previewMedia');
            previewMedia.innerHTML = '';
            
            uploadedMedia.forEach(media => {
                if (media.type.startsWith('image/')) {
                    previewMedia.innerHTML += `<img src="${media.url}" class="img-fluid rounded mb-2" alt="معاينة الصورة">`;
                }
            });
        }
        
        function schedulePost() {
            const content = document.getElementById('contentText').value;
            const scheduleDate = document.getElementById('scheduleDate').value;
            
            if (!content.trim()) {
                showNotification('يرجى إدخال محتوى المنشور', 'warning');
                return;
            }
            
            if (!scheduleDate) {
                showNotification('يرجى تحديد تاريخ ووقت النشر', 'warning');
                return;
            }
            
            const platforms = [];
            if (document.getElementById('platform_facebook').checked) platforms.push('facebook');
            if (document.getElementById('platform_instagram').checked) platforms.push('instagram');
            if (document.getElementById('platform_twitter').checked) platforms.push('twitter');
            
            if (platforms.length === 0) {
                showNotification('يرجى اختيار منصة واحدة على الأقل', 'warning');
                return;
            }
            
            showNotification('جاري جدولة المنشور...', 'info');
            
            // حفظ المنشور في Firestore
            db.collection('users').doc(currentUser.uid).collection('scheduledPosts').add({
                content: content,
                platforms: platforms,
                scheduleDate: new Date(scheduleDate),
                status: 'scheduled',
                media: uploadedMedia,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            })
            .then(docRef => {
                showNotification('تم جدولة المنشور بنجاح!', 'success');
                
                // تحديث العداد
                document.getElementById('scheduledPosts').textContent = 
                    parseInt(document.getElementById('scheduledPosts').textContent) + 1;
                
                // إعادة تعيين النموذج
                document.getElementById('contentText').value = '';
                document.getElementById('scheduleDate').value = '';
                document.getElementById('aiPrompt').value = '';
                uploadedMedia = [];
                updatePreview();
            })
            .catch(error => {
                showNotification('خطأ في جدولة المنشور: ' + error.message, 'error');
            });
        }
        
        function publishNow() {
            const content = document.getElementById('contentText').value;
            
            if (!content.trim()) {
                showNotification('يرجى إدخال محتوى المنشور', 'warning');
                return;
            }
            
            const platforms = [];
            if (document.getElementById('platform_facebook').checked) platforms.push('facebook');
            if (document.getElementById('platform_instagram').checked) platforms.push('instagram');
            if (document.getElementById('platform_twitter').checked) platforms.push('twitter');
            
            if (platforms.length === 0) {
                showNotification('يرجى اختيار منصة واحدة على الأقل', 'warning');
                return;
            }
            
            showNotification('جاري نشر المحتوى...', 'info');
            
            // حفظ المنشور في Firestore
            db.collection('users').doc(currentUser.uid).collection('posts').add({
                content: content,
                platforms: platforms,
                status: 'published',
                media: uploadedMedia,
                publishedAt: firebase.firestore.FieldValue.serverTimestamp(),
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            })
            .then(docRef => {
                showNotification('تم نشر المحتوى بنجاح!', 'success');
                
                // تحديث العداد
                document.getElementById('totalPosts').textContent = 
                    parseInt(document.getElementById('totalPosts').textContent) + 1;
                
                // إعادة تعيين النموذج
                document.getElementById('contentText').value = '';
                document.getElementById('aiPrompt').value = '';
                uploadedMedia = [];
                updatePreview();
            })
            .catch(error => {
                showNotification('خطأ في نشر المحتوى: ' + error.message, 'error');
            });
        }
        
        // File Upload Handlers
        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('drag-over');
        }
        
        function handleMediaDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('drag-over');
            const files = e.dataTransfer.files;
            handleFiles(files, 'media');
        }
        
        function handleBulkDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('drag-over');
            const files = e.dataTransfer.files;
            handleFiles(files, 'bulk');
        }
        
        function handleMediaSelect(e) {
            handleFiles(e.target.files, 'media');
        }
        
        function handleBulkSelect(e) {
            handleFiles(e.target.files, 'bulk');
        }
        
        function handleFiles(files, type) {
            if (files.length === 0) return;
            
            if (type === 'media') {
                for (let file of files) {
                    if (file.type.startsWith('image/') || file.type.startsWith('video/')) {
                        // محاكاة رفع الملف
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            uploadedMedia.push({
                                file: file,
                                url: e.target.result,
                                type: file.type
                            });
                            
                            updateMediaPreview();
                            showNotification(`تم رفع ملف الوسائط: ${file.name}`, 'success');
                        };
                        reader.readAsDataURL(file);
                    } else {
                        showNotification('نوع الملف غير مدعوم. يرجى رفع صور أو فيديوهات فقط.', 'error');
                    }
                }
            } else if (type === 'bulk') {
                for (let file of files) {
                    if (file.name.endsWith('.csv') || file.name.endsWith('.json')) {
                        processBulkFile(file);
                    } else {
                        showNotification('يرجى رفع ملف CSV أو JSON فقط', 'error');
                    }
                }
            }
        }
        
        function updateMediaPreview() {
            const uploadedMediaContainer = document.getElementById('uploadedMedia');
            uploadedMediaContainer.innerHTML = '';
            
            uploadedMedia.forEach((media, index) => {
                if (media.type.startsWith('image/')) {
                    uploadedMediaContainer.innerHTML += `
                        <div class="position-relative d-inline-block me-2 mb-2">
                            <img src="${media.url}" class="img-thumbnail" width="100" alt="صورة مرفوعة">
                            <button class="btn btn-sm btn-danger position-absolute top-0 start-0" onclick="removeMedia(${index})">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    `;
                }
            });
            
            updatePreview();
        }
        
        function removeMedia(index) {
            uploadedMedia.splice(index, 1);
            updateMediaPreview();
        }
        
        function processBulkFile(file) {
            showNotification(`جاري معالجة الملف: ${file.name}`, 'info');
            
            const progressContainer = document.getElementById('importProgress');
            const progressBar = progressContainer.querySelector('.progress-bar');
            const statusDiv = document.getElementById('importStatus');
            
            progressContainer.classList.remove('d-none');
            
            // محاكاة معالجة الملف
            let progress = 0;
            const interval = setInterval(() => {
                progress += 10;
                progressBar.style.width = progress + '%';
                statusDiv.textContent = `معالجة البيانات... ${progress}%`;
                
                if (progress >= 100) {
                    clearInterval(interval);
                    statusDiv.textContent = 'تم الانتهاء من الاستيراد بنجاح!';
                    showNotification('تم استيراد المحتوى بنجاح!', 'success');
                    
                    // إعادة تعيين شريط التقدم بعد ثوانٍ
                    setTimeout(() => {
                        progressBar.style.width = '0%';
                        progressContainer.classList.add('d-none');
                    }, 3000);
                }
            }, 500);
        }
        
        // Template Download Functions
        function downloadTemplate(type) {
            const csvTemplate = `content,platform,schedule_date,media_url,hashtags
"مثال على محتوى المنشور","facebook","2025-09-08 14:00","","#مثال #محتوى"
"منشور آخر للتجربة","instagram","2025-09-08 16:00","","#إنستغرام #تصوير"`;
            
            const jsonTemplate = JSON.stringify([
                {
                    content: "مثال على محتوى المنشور",
                    platform: "facebook",
                    schedule_date: "2025-09-08 14:00",
                    media_url: "",
                    hashtags: "#مثال #محتوى"
                },
                {
                    content: "منشور آخر للتجربة",
                    platform: "instagram",
                    schedule_date: "2025-09-08 16:00",
                    media_url: "",
                    hashtags: "#إنستغرام #تصوير"
                }
            ], null, 2);
            
            const content = type === 'csv' ? csvTemplate : jsonTemplate;
            const filename = `template.${type}`;
            const mimeType = type === 'csv' ? 'text/csv' : 'application/json';
            
            downloadFile(content, filename, mimeType);
        }
        
        function downloadFile(content, filename, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        // Calendar Functions
        function setupCalendar() {
            // Set up calendar navigation
            window.currentCalendarDate = new Date();
            updateCalendar();
        }
        
        function updateCalendar() {
            const calendarContainer = document.getElementById('calendar');
            if (!calendarContainer) return;
            
            const calendar = generateCalendar(window.currentCalendarDate);
            calendarContainer.innerHTML = calendar;
            
            // Load scheduled posts for the current month
            loadScheduledPostsForCalendar();
        }
        
        function generateCalendar(date) {
            const year = date.getFullYear();
            const month = date.getMonth();
            const today = new Date();
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            // Adjust for RTL (Arabic starts week on Saturday)
            const adjustedFirstDay = (firstDay + 1) % 7;
            
            let html = '<div class="calendar-grid">';
            html += '<div class="calendar-header">';
            html += '<div class="calendar-month">' + date.toLocaleDateString('ar-AE', { month: 'long', year: 'numeric' }) + '</div>';
            html += '</div>';
            
            // Days of week header (Arabic order)
            const daysOfWeek = ['سبت', 'أحد', 'اثنين', 'ثلاثاء', 'أربعاء', 'خميس', 'جمعة'];
            html += '<div class="calendar-days-header">';
            daysOfWeek.forEach(day => {
                html += '<div class="calendar-day-header">' + day + '</div>';
            });
            html += '</div>';
            
            // Calendar days
            html += '<div class="calendar-days">';
            
            // Empty cells for days before first day of month
            for (let i = 0; i < adjustedFirstDay; i++) {
                html += '<div class="calendar-day empty"></div>';
            }
            
            // Days of month
            for (let day = 1; day <= daysInMonth; day++) {
                const isToday = day === today.getDate() && month === today.getMonth() && year === today.getFullYear();
                const classes = ['calendar-day'];
                if (isToday) classes.push('today');
                if (window.scheduledPostsDays && window.scheduledPostsDays.includes(day)) classes.push('has-posts');
                
                html += `<div class="${classes.join(' ')}" data-day="${day}">${day}</div>`;
            }
            
            html += '</div></div>';
            return html;
        }
        
        function loadScheduledPostsForCalendar() {
            // تحميل المنشورات المجدولة للشهر الحالي
            const startOfMonth = new Date(window.currentCalendarDate.getFullYear(), window.currentCalendarDate.getMonth(), 1);
            const endOfMonth = new Date(window.currentCalendarDate.getFullYear(), window.currentCalendarDate.getMonth() + 1, 0);
            
            db.collection('users').doc(currentUser.uid).collection('scheduledPosts')
                .where('scheduleDate', '>=', startOfMonth)
                .where('scheduleDate', '<=', endOfMonth)
                .get()
                .then(snapshot => {
                    window.scheduledPostsDays = [];
                    snapshot.forEach(doc => {
                        const post = doc.data();
                        const postDate = post.scheduleDate.toDate();
                        if (postDate.getMonth() === window.currentCalendarDate.getMonth()) {
                            window.scheduledPostsDays.push(postDate.getDate());
                        }
                    });
                    
                    updateCalendar();
                })
                .catch(error => {
                    console.error('Error loading scheduled posts:', error);
                });
        }
        
        function navigateCalendarPrev() {
            window.currentCalendarDate.setMonth(window.currentCalendarDate.getMonth() - 1);
            updateCalendar();
        }
        
        function navigateCalendarNext() {
            window.currentCalendarDate.setMonth(window.currentCalendarDate.getMonth() + 1);
            updateCalendar();
        }
        
        // Account Management
        function connectAccount(platform) {
            showNotification(`جاري إعداد ربط حساب ${platform}...`, 'info');
            
            // في الإصدار الحقيقي، سيتم إعادة التوجيه إلى صفحة مصادقة الطرف الثالث
            // هنا سنحاكي العملية
            
            const modalTitle = document.getElementById('accountModalTitle');
            const modalBody = document.getElementById('accountModalBody');
            
            modalTitle.textContent = `ربط حساب ${platform}`;
            
            if (platform === 'facebook') {
                modalBody.innerHTML = `
                    <p>لربط حساب فيسبوك، يرجى اتباع الخطوات التالية:</p>
                    <ol>
                        <li>انتقل إلى <a href="https://developers.facebook.com/" target="_blank">Facebook for Developers</a></li>
                        <li>أنشئ تطبيقًا جديدًا أو اختر تطبيقًا موجودًا</li>
                        <li>انتقل إلى إعدادات المنتج وأضف "تسجيل الدخول باستخدام Facebook"</li>
                        <li>أضف ${window.location.origin} إلى نطاقات OAuth الصالحة لإعادة التوجيه</li>
                        <li>انسخ معرف التطبيق ومفتاح التطبيق وأدخلهما أدناه</li>
                    </ol>
                    <div class="mb-3">
                        <label for="fbAppId" class="form-label">معرف تطبيق Facebook</label>
                        <input type="text" class="form-control" id="fbAppId">
                    </div>
                    <div class="mb-3">
                        <label for="fbAppSecret" class="form-label">مفتاح تطبيق Facebook</label>
                        <input type="password" class="form-control" id="fbAppSecret">
                    </div>
                    <button class="btn btn-primary w-100" onclick="saveFacebookCredentials()">حفظ والتوصيل</button>
                `;
            } else if (platform === 'instagram') {
                modalBody.innerHTML = `
                    <p>لربط حساب إنستغرام، يرجى اتباع الخطوات التالية:</p>
                    <ol>
                        <li>انتقل إلى <a href="https://developers.facebook.com/" target="_blank">Facebook for Developers</a></li>
                        <li>أنشئ تطبيقًا جديدًا أو اختر تطبيقًا موجودًا</li>
                        <li>أضف منتج Instagram Basic Display</li>
                        <li>أنشئ مستخدمًا اختباريًا أو اطلب مراجعة التطبيق</li>
                        <li>انسخ معرف التطبيق ومفتاح التطبيق وأدخلهما أدناه</li>
                    </ol>
                    <div class="mb-3">
                        <label for="igAppId" class="form-label">معرف تطبيق Instagram</label>
                        <input type="text" class="form-control" id="igAppId">
                    </div>
                    <div class="mb-3">
                        <label for="igAppSecret" class="form-label">مفتاح تطبيق Instagram</label>
                        <input type="password" class="form-control" id="igAppSecret">
                    </div>
                    <button class="btn btn-primary w-100" onclick="saveInstagramCredentials()">حفظ والتوصيل</button>
                `;
            }
            
            // فتح Modal
            new bootstrap.Modal(document.getElementById('accountModal')).show();
        }
        
        function saveFacebookCredentials() {
            const appId = document.getElementById('fbAppId').value;
            const appSecret = document.getElementById('fbAppSecret').value;
            
            if (!appId || !appSecret) {
                showNotification('يرجى ملء جميع الحقول', 'error');
                return;
            }
            
            // حفظ بيانات الاعتماد في Firestore
            db.collection('users').doc(currentUser.uid).collection('connectedAccounts').doc('facebook_' + Date.now()).set({
                platform: 'facebook',
                appId: appId,
                appSecret: appSecret, // في الإنتاج الحقيقي، يجب تشفير هذا
                connectedAt: firebase.firestore.FieldValue.serverTimestamp()
            })
            .then(() => {
                showNotification('تم ربط حساب فيسبوك بنجاح!', 'success');
                loadConnectedAccounts();
                bootstrap.Modal.getInstance(document.getElementById('accountModal')).hide();
            })
            .catch(error => {
                showNotification('خطأ في ربط الحساب: ' + error.message, 'error');
            });
        }
        
        function saveInstagramCredentials() {
            const appId = document.getElementById('igAppId').value;
            const appSecret = document.getElementById('igAppSecret').value;
            
            if (!appId || !appSecret) {
                showNotification('يرجى ملء جميع الحقول', 'error');
                return;
            }
            
            // حفظ بيانات الاعتماد في Firestore
            db.collection('users').doc(currentUser.uid).collection('connectedAccounts').doc('instagram_' + Date.now()).set({
                platform: 'instagram',
                appId: appId,
                appSecret: appSecret, // في الإنتاج الحقيقي، يجب تشفير هذا
                connectedAt: firebase.firestore.FieldValue.serverTimestamp()
            })
            .then(() => {
                showNotification('تم ربط حساب إنستغرام بنجاح!', 'success');
                loadConnectedAccounts();
                bootstrap.Modal.getInstance(document.getElementById('accountModal')).hide();
            })
            .catch(error => {
                showNotification('خطأ في ربط الحساب: ' + error.message, 'error');
            });
        }
        
        function disconnectAccount(accountId) {
            if (confirm('هل أنت متأكد من أنك تريد فصل هذا الحساب؟')) {
                db.collection('users').doc(currentUser.uid).collection('connectedAccounts').doc(accountId).delete()
                    .then(() => {
                        showNotification('تم فصل الحساب بنجاح', 'success');
                        loadConnectedAccounts();
                    })
                    .catch(error => {
                        showNotification('خطأ في فصل الحساب: ' + error.message, 'error');
                    });
            }
        }
        
        // AI Tools Functions
        function generateContentSuggestions() {
            showNotification('جاري توليد اقتراحات المحتوى...', 'info');
            
            setTimeout(() => {
                const suggestions = [
                    'نصائح لتحسين الإنتاجية في العمل',
                    'أحدث اتجاهات التكنولوجيا',
                    'قصص نجاح ملهمة',
                    'نصائح للصحة والعافية'
                ];
                
                const randomSuggestion = suggestions[Math.floor(Math.random() * suggestions.length)];
                showNotification(`اقتراح المحتوى: ${randomSuggestion}`, 'success');
            }, 2000);
        }
        
        function analyzeOptimalTiming() {
            showNotification('جاري تحليل أفضل أوقات النشر...', 'info');
            
            setTimeout(() => {
                const times = ['2:00 PM', '6:00 PM', '8:00 AM', '10:00 AM'];
                const randomTime = times[Math.floor(Math.random() * times.length)];
                document.getElementById('bestTimeToPost').textContent = randomTime;
                showNotification(`أفضل وقت للنشر: ${randomTime}`, 'success');
            }, 3000);
        }
        
        function generateSmartHashtags() {
            showNotification('جاري توليد هاشتاغات ذكية...', 'info');
            
            setTimeout(() => {
                const hashtags = ['#محتوى_رقمي', '#تسويق', '#إبداع', '#نجاح', '#تطوير'];
                showNotification(`هاشتاغات مقترحة: ${hashtags.join(' ')}`, 'success');
            }, 1500);
        }
        
        function runPerformanceAnalysis() {
            showNotification('جاري تشغيل تحليل الأداء...', 'info');
            
            setTimeout(() => {
                showNotification('تم الانتهاء من تحليل الأداء. معدل التفاعل: 8.5%، أفضل منصة: إنستغرام', 'success');
            }, 4000);
        }
        
        // Settings Functions
        function saveSettings(e) {
            e.preventDefault();
            
            const settings = {
                timezone: document.getElementById('timezone').value,
                language: document.getElementById('language').value,
                defaultPostTone: document.getElementById('defaultPostTone').value
            };
            
            // حفظ الإعدادات في Firestore
            db.collection('users').doc(currentUser.uid).update({
                settings: settings
            })
            .then(() => {
                userData.settings = settings;
                showNotification('تم حفظ الإعدادات بنجاح!', 'success');
            })
            .catch(error => {
                showNotification('خطأ في حفظ الإعدادات: ' + error.message, 'error');
            });
        }
        
        function downloadBackup() {
            // جمع البيانات للنسخة الاحتياطية
            const postsPromise = db.collection('users').doc(currentUser.uid).collection('posts').get();
            const scheduledPromise = db.collection('users').doc(currentUser.uid).collection('scheduledPosts').get();
            const accountsPromise = db.collection('users').doc(currentUser.uid).collection('connectedAccounts').get();
            
            Promise.all([postsPromise, scheduledPromise, accountsPromise])
                .then(([postsSnapshot, scheduledSnapshot, accountsSnapshot]) => {
                    const data = {
                        user: userData,
                        posts: [],
                        scheduledPosts: [],
                        connectedAccounts: [],
                        exportedAt: new Date().toISOString()
                    };
                    
                    postsSnapshot.forEach(doc => {
                        data.posts.push(doc.data());
                    });
                    
                    scheduledSnapshot.forEach(doc => {
                        data.scheduledPosts.push(doc.data());
                    });
                    
                    accountsSnapshot.forEach(doc => {
                        data.connectedAccounts.push(doc.data());
                    });
                    
                    const backup = JSON.stringify(data, null, 2);
                    downloadFile(backup, `socialhub-backup-${new Date().toISOString().split('T')[0]}.json`, 'application/json');
                    
                    showNotification('تم تحميل النسخة الاحتياطية بنجاح!', 'success');
                })
                .catch(error => {
                    showNotification('خطأ في إنشاء النسخة الاحتياطية: ' + error.message, 'error');
                });
        }
        
        function manageSessions() {
            showNotification('فتح إدارة الجلسات...', 'info');
            // هذا سيفتح نافذة أو قسم إدارة الجلسات
        }
        
        // Notification System
        function showNotification(message, type = 'info') {
            const container = document.getElementById('notificationContainer');
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div class="d-flex align-items-center">
                    <i class="fas ${getNotificationIcon(type)} me-2"></i>
                    <span>${message}</span>
                    <button class="btn btn-sm btn-link ms-auto p-0" onclick="this.parentElement.parentElement.remove()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
            
            container.appendChild(notification);
            
            // Show notification
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 5000);
            
            // Update notification count
            updateNotificationCount();
        }
        
        function getNotificationIcon(type) {
            switch(type) {
                case 'success': return 'fa-check-circle';
                case 'error': return 'fa-exclamation-circle';
                case 'warning': return 'fa-exclamation-triangle';
                default: return 'fa-info-circle';
            }
        }
        
        function updateNotificationCount() {
            const count = document.getElementById('notificationContainer').children.length;
            document.getElementById('notificationCount').textContent = count;
            
            // Update dropdown
            const dropdown = document.getElementById('notificationsDropdown');
            if (count === 0) {
                dropdown.innerHTML = `
                    <li><h6 class="dropdown-header">الإشعارات الجديدة</h6></li>
                    <li><a class="dropdown-item" href="#"><i class="fas fa-info-circle text-info me-2"></i>لا توجد إشعارات جديدة</a></li>
                `;
            }
        }
        
        // PWA Installation
        let deferredPrompt;
        
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            showNotification('يمكنك تثبيت SocialHub Pro كتطبيق على جهازك!', 'info');
        });
        
        // Real-time updates simulation
        setInterval(() => {
            // Update notification count randomly
            if (Math.random() > 0.9) {
                showNotification('تذكير: لديك منشورات مجدولة لهذا الأسبوع', 'info');
            }
            
            // Update charts with random data occasionally
            if (Math.random() > 0.95 && charts.performance) {
                const datasets = charts.performance.data.datasets;
                datasets.forEach(dataset => {
                    for (let i = 0; i < dataset.data.length; i++) {
                        // تغيير طفيف في البيانات لمحاكاة التحديث في الوقت الحقيقي
                        dataset.data[i] = Math.max(0, dataset.data[i] + Math.floor(Math.random() * 10) - 5);
                    }
                });
                charts.performance.update();
            }
        }, 30000);
    </script>
</body>
</html>
    <script>
        // Firebase Configuration - REPLACE WITH YOUR ACTUAL CONFIG
        const firebaseConfig = {
            apiKey: "YOUR_ACTUAL_API_KEY_HERE", // Replace with your Firebase API Key
            authDomain: "your-project.firebaseapp.com", // Replace with your Firebase Auth Domain
            projectId: "your-project-id", // Replace with your Firebase Project ID
            storageBucket: "your-project.appspot.com", // Replace with your Firebase Storage Bucket
            messagingSenderId: "123456789", // Replace with your Messaging Sender ID
            appId: "your-app-id", // Replace with your Firebase App ID
            measurementId: "G-XXXXXXXXXX" // Replace with your Google Analytics ID (optional)
        };

        // Initialize Firebase
        let app, auth, db, storage, analytics;
        let currentUser = null;
        let performanceChart, platformChart, audienceChart, timingChart;

        // Check if Firebase config is properly set
        function isFirebaseConfigured() {
            return firebaseConfig.apiKey !== "YOUR_ACTUAL_API_KEY_HERE";
        }

        // Initialize Firebase services
        async function initializeFirebase() {
            try {
                if (!isFirebaseConfigured()) {
                    console.warn('Firebase not configured. Using mock data mode.');
                    return false;
                }

                app = firebase.initializeApp(firebaseConfig);
                auth = firebase.getAuth(app);
                db = firebase.getFirestore(app);
                storage = firebase.getStorage(app);
                analytics = firebase.getAnalytics(app);

                // Set up auth state listener
                firebase.onAuthStateChanged(auth, (user) => {
                    handleAuthStateChange(user);
                });

                return true;
            } catch (error) {
                console.error('Firebase initialization error:', error);
                showNotification('خطأ في الاتصال بقاعدة البيانات', 'error');
                return false;
            }
        }

        // Handle authentication state changes
        function handleAuthStateChange(user) {
            if (user) {
                currentUser = user;
                showMainApp();
                loadUserData();
                loadDashboardData();
            } else {
                currentUser = null;
                showAuthSection();
            }
            hideLoading();
        }

        // Show authentication section
        function showAuthSection() {
            document.getElementById('authSection').classList.remove('d-none');
            document.getElementById('mainApp').classList.add('d-none');
        }

        // Show main application
        function showMainApp() {
            document.getElementById('authSection').classList.add('d-none');
            document.getElementById('mainApp').classList.remove('d-none');
        }

        // Authentication Functions
        document.getElementById('loginFormElement').addEventListener('submit', async (e) => {
            e.preventDefault();
            showLoading('جاري تسجيل الدخول...');

            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            if (!isFirebaseConfigured()) {
                // Mock login for demo
                setTimeout(() => {
                    currentUser = { uid: 'demo-user', email: email };
                    showMainApp();
                    loadUserData();
                    loadDashboardData();
                    hideLoading();
                    showNotification('تم تسجيل الدخول بنجاح (وضع التجربة)', 'success');
                }, 2000);
                return;
            }

            try {
                const userCredential = await firebase.signInWithEmailAndPassword(auth, email, password);
                showNotification('تم تسجيل الدخول بنجاح', 'success');
            } catch (error) {
                console.error('Login error:', error);
                showNotification(getErrorMessage(error.code), 'error');
                hideLoading();
            }
        });

        document.getElementById('registerFormElement').addEventListener('submit', async (e) => {
            e.preventDefault();
            showLoading('جاري إنشاء الحساب...');

            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('registerConfirmPassword').value;

            if (password !== confirmPassword) {
                showNotification('كلمات المرور غير متطابقة', 'error');
                hideLoading();
                return;
            }

            if (!isFirebaseConfigured()) {
                // Mock registration for demo
                setTimeout(() => {
                    showNotification('تم إنشاء الحساب بنجاح (وضع التجربة)', 'success');
                    showLoginForm();
                    hideLoading();
                }, 2000);
                return;
            }

            try {
                const userCredential = await firebase.createUserWithEmailAndPassword(auth, email, password);
                const user = userCredential.user;

                // Update profile
                await firebase.updateProfile(user, { displayName: name });

                // Create user document in Firestore
                await firebase.setDoc(firebase.doc(db, 'users', user.uid), {
                    name: name,
                    email: email,
                    createdAt: firebase.serverTimestamp(),
                    connectedAccounts: [],
                    settings: {
                        timezone: 'Asia/Riyadh',
                        notifications: true,
                        theme: 'light'
                    }
                });

                showNotification('تم إنشاء الحساب بنجاح', 'success');
                showLoginForm();
            } catch (error) {
                console.error('Registration error:', error);
                showNotification(getErrorMessage(error.code), 'error');
            } finally {
                hideLoading();
            }
        });

        // Form switching functions
        function showLoginForm() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('registerForm').style.display = 'none';
            document.getElementById('forgotPasswordForm').style.display = 'none';
        }

        function showRegisterForm() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('registerForm').style.display = 'block';
            document.getElementById('forgotPasswordForm').style.display = 'none';
        }

        function showForgotPasswordForm() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('registerForm').style.display = 'none';
            document.getElementById('forgotPasswordForm').style.display = 'block';
        }

        // Load user data
        async function loadUserData() {
            if (!currentUser) return;

            try {
                if (isFirebaseConfigured()) {
                    const userDoc = await firebase.getDoc(firebase.doc(db, 'users', currentUser.uid));
                    if (userDoc.exists()) {
                        const userData = userDoc.data();
                        document.getElementById('profileName').value = userData.name || '';
                        document.getElementById('profileEmail').value = userData.email || '';
                        document.getElementById('profileTimezone').value = userData.settings?.timezone || 'Asia/Riyadh';
                    }
                } else {
                    // Mock user data
                    document.getElementById('profileName').value = 'مستخدم تجريبي';
                    document.getElementById('profileEmail').value = currentUser.email;
                    document.getElementById('profileTimezone').value = 'Asia/Riyadh';
                }
            } catch (error) {
                console.error('Error loading user data:', error);
            }
        }

        // Dashboard functions
        async function loadDashboardData() {
            showLoading('جاري تحميل البيانات...');

            try {
                if (isFirebaseConfigured()) {
                    await loadRealDataFromFirestore();
                } else {
                    await loadMockData();
                }

                await loadCharts();
                await loadRecentActivity();
                await loadAIInsights();

            } catch (error) {
                console.error('Error loading dashboard data:', error);
                showNotification('حدث خطأ في تحميل البيانات', 'error');
            } finally {
                hideLoading();
            }
        }

        // Load real data from Firestore
        async function loadRealDataFromFirestore() {
            if (!currentUser) return;

            try {
                // Get user's social media data
                const userDataDoc = await firebase.getDoc(firebase.doc(db, 'userAnalytics', currentUser.uid));
                const connectedAccountsDoc = await firebase.getDoc(firebase.doc(db, 'connectedAccounts', currentUser.uid));

                let analytics = {};
                let accounts = [];

                if (userDataDoc.exists()) {
                    analytics = userDataDoc.data();
                }

                if (connectedAccountsDoc.exists()) {
                    accounts = connectedAccountsDoc.data().accounts || [];
                }

                // Update UI with real data
                updateStatsCards(analytics);
                updateAnalyticsTable(analytics);
                updateConnectedAccountsUI(accounts);

            } catch (error) {
                console.error('Error loading real data:', error);
                // Fallback to mock data
                await loadMockData();
            }
        }

        // Load mock data for demonstration
        async function loadMockData() {
            // Simulate loading delay
            await new Promise(resolve => setTimeout(resolve, 1500));

            // Mock data
            const mockAnalytics = {
                totalPosts: 1247,
                totalReach: 89542,
                totalEngagement: 12847,
                connectedAccounts: 8,
                platforms: {
                    facebook: { posts: 387, reach: 34521, engagement: 4821, engagementRate: '13.9%', clicks: 1892, conversions: 127 },
                    instagram: { posts: 452, reach: 28934, engagement: 5234, engagementRate: '18.1%', clicks: 2134, conversions: 89 },
                    twitter: { posts: 289, reach: 15632, engagement: 1876, engagementRate: '12.0%', clicks: 823, conversions: 34 },
                    linkedin: { posts: 119, reach: 10455, engagement: 916, engagementRate: '8.8%', clicks: 445, conversions: 23 }
                }
            };

            updateStatsCards(mockAnalytics);
            updateAnalyticsTable(mockAnalytics);
            updateConnectedAccountsMockUI();
        }

        // Update stats cards
        function updateStatsCards(data) {
            document.getElementById('totalPostsCount').textContent = formatNumber(data.totalPosts || 1247);
            document.getElementById('totalReachCount').textContent = formatNumber(data.totalReach || 89542);
            document.getElementById('totalEngagementCount').textContent = formatNumber(data.totalEngagement || 12847);
            document.getElementById('connectedAccountsCount').textContent = data.connectedAccounts || 8;
        }

        // Update analytics table
        function updateAnalyticsTable(data) {
            const tableBody = document.getElementById('analyticsTableBody');
            tableBody.innerHTML = '';

            const platforms = data.platforms || {
                facebook: { posts: 387, reach: 34521, engagement: 4821, engagementRate: '13.9%', clicks: 1892, conversions: 127 },
                instagram: { posts: 452, reach: 28934, engagement: 5234, engagementRate: '18.1%', clicks: 2134, conversions: 89 },
                twitter: { posts: 289, reach: 15632, engagement: 1876, engagementRate: '12.0%', clicks: 823, conversions: 34 },
                linkedin: { posts: 119, reach: 10455, engagement: 916, engagementRate: '8.8%', clicks: 445, conversions: 23 }
            };

            const platformNames = {
                facebook: 'فيسبوك',
                instagram: 'إنستغرام',
                twitter: 'تويتر',
                linkedin: 'لينكدإن'
            };

            const platformIcons = {
                facebook: 'fab fa-facebook-f',
                instagram: 'fab fa-instagram',
                twitter: 'fab fa-twitter',
                linkedin: 'fab fa-linkedin-in'
            };

            Object.entries(platforms).forEach(([platform, stats]) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <i class="${platformIcons[platform]} me-2"></i>
                        ${platformNames[platform]}
                    </td>
                    <td>${formatNumber(stats.posts)}</td>
                    <td>${formatNumber(stats.reach)}</td>
                    <td>${formatNumber(stats.engagement)}</td>
                    <td><span class="badge bg-success">${stats.engagementRate}</span></td>
                    <td>${formatNumber(stats.clicks)}</td>
                    <td>${formatNumber(stats.conversions)}</td>
                `;
                tableBody.appendChild(row);
            });
        }

        // Update connected accounts UI (mock)
        function updateConnectedAccountsMockUI() {
            const accountsList = document.getElementById('connectedAccountsList');
            if (!accountsList) return;

            accountsList.innerHTML = `
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="card shadow border-left-primary">
                        <div class="card-body">
                            <div class="d-flex align-items-center">
                                <div class="me-3">
                                    <i class="fab fa-facebook-f fa-2x text-primary"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="mb-0">Facebook Business</h6>
                                    <small class="text-muted">مخبز النور الذهبي</small>
                                    <div class="mt-1">
                                        <span class="badge bg-success">متصل</span>
                                    </div>
                                </div>
                                <div class="dropdown">
                                    <button class="btn btn-link" data-bs-toggle="dropdown">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li><a class="dropdown-item" href="#" onclick="refreshAccount('facebook')">تحديث</a></li>
                                        <li><a class="dropdown-item text-danger" href="#" onclick="disconnectAccount('facebook')">قطع الاتصال</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="card shadow border-left-danger">
                        <div class="card-body">
                            <div class="d-flex align-items-center">
                                <div class="me-3">
                                    <i class="fab fa-instagram fa-2x text-danger"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="mb-0">Instagram Business</h6>
                                    <small class="text-muted">@golden_bakery_dubai</small>
                                    <div class="mt-1">
                                        <span class="badge bg-success">متصل</span>
                                    </div>
                                </div>
                                <div class="dropdown">
                                    <button class="btn btn-link" data-bs-toggle="dropdown">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li><a class="dropdown-item" href="#" onclick="refreshAccount('instagram')">تحديث</a></li>
                                        <li><a class="dropdown-item text-danger" href="#" onclick="disconnectAccount('instagram')">قطع الاتصال</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="card shadow border-left-info">
                        <div class="card-body">
                            <div class="d-flex align-items-center">
                                <div class="me-3">
                                    <i class="fab fa-twitter fa-2x text-info"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="mb-0">Twitter</h6>
                                    <small class="text-muted">@goldenbakery_ae</small>
                                    <div class="mt-1">
                                        <span class="badge bg-success">متصل</span>
                                    </div>
                                </div>
                                <div class="dropdown">
                                    <button class="btn btn-link" data-bs-toggle="dropdown">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li><a class="dropdown-item" href="#" onclick="refreshAccount('twitter')">تحديث</a></li>
                                        <li><a class="dropdown-item text-danger" href="#" onclick="disconnectAccount('twitter')">قطع الاتصال</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Load and display recent activity
        async function loadRecentActivity() {
            const activityContainer = document.getElementById('recentActivity');

            const activities = [
                { 
                    text: 'تم نشر منشور جديد على فيسبوك: "عروض خاصة لهذا الأسبوع"', 
                    time: 'منذ 5 دقائق', 
                    icon: 'fab fa-facebook-f', 
                    color: 'primary' 
                },
                { 
                    text: 'حصل منشور إنستغرام على 150 إعجاب جديد', 
                    time: 'منذ 15 دقيقة', 
                    icon: 'fab fa-instagram', 
                    color: 'danger' 
                },
                { 
                    text: 'تم جدولة 5 منشورات لغداً', 
                    time: 'منذ 30 دقيقة', 
                    icon: 'fas fa-calendar-alt', 
                    color: 'success' 
                },
                { 
                    text: 'ارتفع معدل التفاعل بنسبة 12% هذا الأسبوع', 
                    time: 'منذ ساعة', 
                    icon: 'fas fa-chart-line', 
                    color: 'info' 
                },
                { 
                    text: 'تم ربط حساب لينكدإن الجديد بنجاح', 
                    time: 'منذ ساعتين', 
                    icon: 'fab fa-linkedin-in', 
                    color: 'primary' 
                }
            ];

            activityContainer.innerHTML = activities.map(activity => `
                <div class="activity-item">
                    <div class="d-flex align-items-start">
                        <div class="me-3">
                            <i class="${activity.icon} text-${activity.color}"></i>
                        </div>
                        <div class="flex-grow-1">
                            <p class="mb-1">${activity.text}</p>
                            <small class="text-muted">${activity.time}</small>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Load AI insights
        async function loadAIInsights() {
            const insightsContainer = document.getElementById('aiInsights');

            const insights = [
                {
                    type: 'success',
                    icon: 'fas fa-lightbulb',
                    title: 'توصية ذكية',
                    text: 'أفضل أوقات النشر لجمهورك: الأحد-الثلاثاء من 7-9 مساءً'
                },
                {
                    type: 'info',
                    icon: 'fas fa-trending-up',
                    title: 'اتجاه صاعد',
                    text: 'الهاشتاغ #مخبوزات_طازجة يحقق نمواً بنسبة 45% هذا الأسبوع'
                },
                {
                    type: 'warning',
                    icon: 'fas fa-exclamation-triangle',
                    title: 'تنبيه',
                    text: 'انخفاض التفاعل على إنستغرام بنسبة 8% - جرب محتوى أكثر تفاعلية'
                }
            ];

            insightsContainer.innerHTML = insights.map(insight => `
                <div class="alert alert-${insight.type}">
                    <i class="${insight.icon} me-2"></i>
                    <strong>${insight.title}:</strong> ${insight.text}
                </div>
            `).join('');
        }

        // Load charts
        async function loadCharts() {
            // Performance Chart
            const performanceCtx = document.getElementById('performanceChart');
            if (performanceCtx) {
                performanceChart = new Chart(performanceCtx, {
                    type: 'line',
                    data: {
                        labels: ['1 يناير', '5 يناير', '10 يناير', '15 يناير', '20 يناير', '25 يناير', '30 يناير'],
                        datasets: [{
                            label: 'الوصول',
                            data: [12000, 15000, 13000, 17000, 16000, 19000, 21000],
                            borderColor: 'rgb(75, 192, 192)',
                            backgroundColor: 'rgba(75, 192, 192, 0.1)',
                            tension: 0.4,
                            fill: true
                        }, {
                            label: 'التفاعل',
                            data: [1800, 2100, 1900, 2400, 2200, 2800, 3100],
                            borderColor: 'rgb(255, 99, 132)',
                            backgroundColor: 'rgba(255, 99, 132, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'أداء المنشورات خلال الشهر الماضي'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }

            // Platform Chart
            const platformCtx = document.getElementById('platformChart');
            if (platformCtx) {
                platformChart = new Chart(platformCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['فيسبوك', 'إنستغرام', 'تويتر', 'لينكدإن'],
                        datasets: [{
                            data: [34521, 28934, 15632, 10455],
                            backgroundColor: [
                                '#1877f2',
                                '#e1306c',
                                '#1da1f2',
                                '#0077b5'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }

            // Audience Chart
            const audienceCtx = document.getElementById('audienceChart');
            if (audienceCtx) {
                audienceChart = new Chart(audienceCtx, {
                    type: 'bar',
                    data: {
                        labels: ['18-24', '25-34', '35-44', '45-54', '55+'],
                        datasets: [{
                            label: 'المتابعون',
                            data: [15420, 23650, 18930, 12450, 8920],
                            backgroundColor: 'rgba(54, 162, 235, 0.8)'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'توزيع الجمهور حسب العمر'
                            }
                        }
                    }
                });
            }

            // Timing Chart
            const timingCtx = document.getElementById('timingChart');
            if (timingCtx) {
                timingChart = new Chart(timingCtx, {
                    type: 'radar',
                    data: {
                        labels: ['الأحد', 'الإثنين', 'الثلاثاء', 'الأربعاء', 'الخميس', 'الجمعة', 'السبت'],
                        datasets: [{
                            label: 'أوقات النشاط',
                            data: [85, 92, 88, 76, 82, 95, 90],
                            backgroundColor: 'rgba(255, 99, 132, 0.2)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            r: {
                                beginAtZero: true,
                                max: 100
                            }
                        }
                    }
                });
            }
        }

        // Navigation functions
        function switchSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('[id$="Section"]').forEach(section => {
                section.classList.add('d-none');
            });

            // Show selected section
            document.getElementById(sectionName + 'Section').classList.remove('d-none');

            // Update active nav item
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            document.querySelector(`[data-section="${sectionName}"]`).classList.add('active');

            // Load section-specific data
            if (sectionName === 'analytics') {
                loadAnalyticsData();
            }
        }

        // Social Media API Integration Functions
        async function connectFacebook() {
            showLoading('جاري الاتصال بفيسبوك...');

            try {
                if (!isFirebaseConfigured()) {
                    // Mock connection for demo
                    setTimeout(() => {
                        showNotification('تم ربط حساب فيسبوك بنجاح (وضع التجربة)', 'success');
                        updateConnectedAccountsMockUI();
                        hideLoading();
                        bootstrap.Modal.getInstance(document.getElementById('addAccountModal')).hide();
                    }, 2000);
                    return;
                }

                // Real Facebook Graph API integration
                // You would implement Facebook Login SDK here
                // Example: FB.login() and then save tokens to Firestore

                showNotification('يتطلب إعداد Facebook App ID', 'warning');
                hideLoading();

            } catch (error) {
                console.error('Facebook connection error:', error);
                showNotification('فشل في الاتصال بفيسبوك', 'error');
                hideLoading();
            }
        }

        async function connectInstagram() {
            showLoading('جاري الاتصال بإنستغرام...');

            try {
                if (!isFirebaseConfigured()) {
                    // Mock connection for demo
                    setTimeout(() => {
                        showNotification('تم ربط حساب إنستغرام الأعمال بنجاح (وضع التجربة)', 'success');
                        updateConnectedAccountsMockUI();
                        hideLoading();
                        bootstrap.Modal.getInstance(document.getElementById('addAccountModal')).hide();
                    }, 2000);
                    return;
                }

                // Real Instagram Graph API integration (Business accounts only)
                // Note: Instagram Basic Display API is deprecated as of Dec 4, 2024

                showNotification('يتطلب حساب أعمال أو منشئ محتوى مربوط بصفحة فيسبوك', 'info');
                hideLoading();

            } catch (error) {
                console.error('Instagram connection error:', error);
                showNotification('فشل في الاتصال بإنستغرام', 'error');
                hideLoading();
            }
        }

        async function connectTwitter() {
            showLoading('جاري الاتصال بتويتر...');

            try {
                if (!isFirebaseConfigured()) {
                    // Mock connection for demo
                    setTimeout(() => {
                        showNotification('تم ربط حساب تويتر بنجاح (وضع التجربة)', 'success');
                        updateConnectedAccountsMockUI();
                        hideLoading();
                        bootstrap.Modal.getInstance(document.getElementById('addAccountModal')).hide();
                    }, 2000);
                    return;
                }

                // Real Twitter API v2 integration
                // You would implement Twitter OAuth 2.0 here

                showNotification('يتطلب إعداد Twitter API Keys', 'warning');
                hideLoading();

            } catch (error) {
                console.error('Twitter connection error:', error);
                showNotification('فشل في الاتصال بتويتر', 'error');
                hideLoading();
            }
        }

        async function connectLinkedIn() {
            showLoading('جاري الاتصال بلينكدإن...');

            try {
                if (!isFirebaseConfigured()) {
                    // Mock connection for demo
                    setTimeout(() => {
                        showNotification('تم ربط حساب لينكدإن بنجاح (وضع التجربة)', 'success');
                        updateConnectedAccountsMockUI();
                        hideLoading();
                        bootstrap.Modal.getInstance(document.getElementById('addAccountModal')).hide();
                    }, 2000);
                    return;
                }

                // Real LinkedIn API integration
                // You would implement LinkedIn OAuth 2.0 here

                showNotification('يتطلب إعداد LinkedIn API Keys', 'warning');
                hideLoading();

            } catch (error) {
                console.error('LinkedIn connection error:', error);
                showNotification('فشل في الاتصال بلينكدإن', 'error');
                hideLoading();
            }
        }

        // Utility Functions
        function formatNumber(num) {
            if (num >= 1000000) {
                return (num / 1000000).toFixed(1) + 'M';
            } else if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num.toString();
        }

        function getErrorMessage(code) {
            const errorMessages = {
                'auth/user-not-found': 'المستخدم غير موجود',
                'auth/wrong-password': 'كلمة المرور غير صحيحة',
                'auth/email-already-in-use': 'البريد الإلكتروني مستخدم مسبقاً',
                'auth/weak-password': 'كلمة المرور ضعيفة',
                'auth/invalid-email': 'البريد الإلكتروني غير صالح',
                'auth/too-many-requests': 'تم تجاوز عدد المحاولات المسموح'
            };
            return errorMessages[code] || 'حدث خطأ غير متوقع';
        }

        function showNotification(message, type = 'info') {
            const alertClass = {
                'success': 'alert-success',
                'error': 'alert-danger',
                'warning': 'alert-warning',
                'info': 'alert-info'
            }[type] || 'alert-info';

            const notification = document.createElement('div');
            notification.className = `alert ${alertClass} alert-dismissible position-fixed`;
            notification.style.cssText = 'top: 20px; right: 20px; z-index: 10000; min-width: 300px;';
            notification.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;

            document.body.appendChild(notification);

            // Auto dismiss after 5 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 5000);
        }

        function showLoading(text = 'جاري التحميل...') {
            document.getElementById('loadingText').textContent = text;
            document.getElementById('loadingOverlay').classList.remove('d-none');
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').classList.add('d-none');
        }

        // Theme toggle
        document.getElementById('themeToggle').addEventListener('click', () => {
            const currentTheme = document.body.getAttribute('data-bs-theme') || 'light';
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';

            document.body.setAttribute('data-bs-theme', newTheme);
            document.getElementById('themeIcon').className = newTheme === 'light' ? 'fas fa-moon' : 'fas fa-sun';

            localStorage.setItem('theme', newTheme);
        });

        // Load saved theme
        const savedTheme = localStorage.getItem('theme') || 'light';
        document.body.setAttribute('data-bs-theme', savedTheme);
        document.getElementById('themeIcon').className = savedTheme === 'light' ? 'fas fa-moon' : 'fas fa-sun';

        // Mobile sidebar toggle
        document.getElementById('sidebarToggle').addEventListener('click', () => {
            document.getElementById('sidebar').classList.toggle('show');
        });

        // Navigation event listeners
        document.querySelectorAll('[data-section]').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                switchSection(link.dataset.section);
            });
        });

        // Logout functionality
        document.getElementById('logoutBtn').addEventListener('click', async () => {
            try {
                if (isFirebaseConfigured() && auth) {
                    await firebase.signOut(auth);
                } else {
                    currentUser = null;
                    showAuthSection();
                }
                showNotification('تم تسجيل الخروج بنجاح', 'success');
            } catch (error) {
                console.error('Logout error:', error);
                showNotification('حدث خطأ في تسجيل الخروج', 'error');
            }
        });

        // Post form functionality
        document.getElementById('postContent').addEventListener('input', (e) => {
            const charCount = e.target.value.length;
            document.getElementById('charCount').textContent = charCount;

            // Update preview
            const preview = document.getElementById('postPreview');
            if (charCount === 0) {
                preview.innerHTML = '<p class="text-muted">اكتب شيئاً لرؤية المعاينة...</p>';
            } else {
                preview.innerHTML = `<p>${e.target.value}</p>`;
            }
        });

        // Platform selection
        document.querySelectorAll('.platform-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.preventDefault();
                btn.classList.toggle('btn-outline-primary');
                btn.classList.toggle('btn-primary');
            });
        });

        // Analytics filter
        document.querySelectorAll('input[name="analyticsFilter"]').forEach(filter => {
            filter.addEventListener('change', () => {
                loadAnalyticsData();
            });
        });

        // Additional utility functions
        function refreshDashboard() {
            loadDashboardData();
        }

        function exportReport() {
            showNotification('سيتم تصدير التقرير قريباً', 'info');
        }

        function refreshAccount(platform) {
            showLoading(`جاري تحديث حساب ${platform}...`);
            setTimeout(() => {
                hideLoading();
                showNotification(`تم تحديث حساب ${platform} بنجاح`, 'success');
            }, 2000);
        }

        function disconnectAccount(platform) {
            if (confirm(`هل تريد قطع الاتصال مع حساب ${platform}؟`)) {
                showNotification(`تم قطع الاتصال مع ${platform}`, 'warning');
            }
        }

        function syncFirebaseData() {
            showLoading('جاري مزامنة البيانات مع Firebase...');
            setTimeout(() => {
                hideLoading();
                showNotification('تم مزامنة البيانات بنجاح', 'success');
                document.getElementById('lastSync').textContent = new Date().toLocaleString('ar');
            }, 3000);
        }

        function exportData() {
            showNotification('سيتم تصدير البيانات قريباً', 'info');
        }

        function clearCache() {
            if (confirm('هل تريد مسح التخزين المؤقت؟')) {
                localStorage.clear();
                showNotification('تم مسح التخزين المؤقت', 'success');
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', async () => {
            showLoading('جاري تحضير التطبيق...');

            try {
                await initializeFirebase();

                // Set initial sync time
                document.getElementById('lastSync').textContent = new Date().toLocaleString('ar');
                document.getElementById('dataSize').textContent = '2.3 MB';

                // If Firebase is not configured, show demo mode
                if (!isFirebaseConfigured()) {
                    setTimeout(() => {
                        currentUser = null;
                        showAuthSection();
                        hideLoading();
                        showNotification('التطبيق يعمل في وضع التجربة - قم بإعداد Firebase للاستخدام الكامل', 'warning');
                    }, 1500);
                }

            } catch (error) {
                console.error('App initialization error:', error);
                hideLoading();
                showNotification('فشل في تحضير التطبيق', 'error');
            }
        });
    </script>
</body>
</html>