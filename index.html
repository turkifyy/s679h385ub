<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SocialHub Pro v8.5 - Advanced Social Media Management Platform with AI-Powered Features">
    <meta name="keywords" content="social media, management, scheduling, analytics, Facebook, Instagram, AI, Dubai timezone, bulk import">
    <meta name="author" content="SocialHub Pro">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="SocialHub Pro v8.5 - Advanced Social Media Management">
    <meta property="og:description" content="Professional social media management platform with AI-powered scheduling and comprehensive analytics">
    <meta property="og:type" content="website">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="SocialHub Pro v8.5">
    <meta name="twitter:description" content="Advanced social media management platform">
    
    <title>SocialHub Pro v8.5 - Advanced Social Media Management Platform</title>
    
    <!-- PWA Meta Tags -->
    <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoiU29jaWFsSHViIFBybyB2OC41Iiwic2hvcnRfbmFtZSI6IlNvY2lhbEh1YiIsImRlc2NyaXB0aW9uIjoiQWR2YW5jZWQgU29jaWFsIE1lZGlhIE1hbmFnZW1lbnQgUGxhdGZvcm0iLCJzdGFydF91cmwiOiIvIiwiZGlzcGxheSI6InN0YW5kYWxvbmUiLCJiYWNrZ3JvdW5kX2NvbG9yIjoiIzIxODA4MyIsInRoZW1lX2NvbG9yIjoiIzIxODA4MyIsImljb25zIjpbeyJzcmMiOiJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI0Yld4dWN6MW9kSFJ3T2k4dmQzZDNMbmN6TG05eVp5OHlNREF3TDNOMlp5SWdkbWxsZDFKdmVEMGlNQ0F3SURVeE1pQTFNVElpSUhkcFpIUm9QU0kxTVRJaUlHaGxhV2RvZEQwaU5URXlJaUJtYVd4c1BTSXZJQ0k4Y0dGMGFDQmtQU0pOTVRJMElEVXdMamd5UXpFeU5DQXhPUzQ0TnlBeE1UUXVOekVnTUMweE1UUXVOekVnTUVNeE1UUXVOekVnTUNBeE1qUWdNVGt1T0RjZ01USTBJalU4TDNOMlp5ND0iLCJzaXplcyI6IjUxMng1MTIiLCJ0eXBlIjoiaW1hZ2Uvc3ZnK3htbCJ9XX0=">
    <meta name="theme-color" content="#218083">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="SocialHub Pro v8.5">
    
    <!-- External Libraries -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <style>
    :root {
  /* Primitive Color Tokens */
  --color-white: rgba(255, 255, 255, 1);
  --color-black: rgba(0, 0, 0, 1);
  --color-cream-50: rgba(252, 252, 249, 1);
  --color-cream-100: rgba(255, 255, 253, 1);
  --color-gray-200: rgba(245, 245, 245, 1);
  --color-gray-300: rgba(167, 169, 169, 1);
  --color-gray-400: rgba(119, 124, 124, 1);
  --color-slate-500: rgba(98, 108, 113, 1);
  --color-brown-600: rgba(94, 82, 64, 1);
  --color-charcoal-700: rgba(31, 33, 33, 1);
  --color-charcoal-800: rgba(38, 40, 40, 1);
  --color-slate-900: rgba(19, 52, 59, 1);
  --color-teal-300: rgba(50, 184, 198, 1);
  --color-teal-400: rgba(45, 166, 178, 1);
  --color-teal-500: rgba(33, 128, 141, 1);
  --color-teal-600: rgba(29, 116, 128, 1);
  --color-teal-700: rgba(26, 104, 115, 1);
  --color-teal-800: rgba(41, 150, 161, 1);
  --color-red-400: rgba(255, 84, 89, 1);
  --color-red-500: rgba(192, 21, 47, 1);
  --color-orange-400: rgba(230, 129, 97, 1);
  --color-orange-500: rgba(168, 75, 47, 1);

  /* RGB versions for opacity control */
  --color-brown-600-rgb: 94, 82, 64;
  --color-teal-500-rgb: 33, 128, 141;
  --color-slate-900-rgb: 19, 52, 59;
  --color-slate-500-rgb: 98, 108, 113;
  --color-red-500-rgb: 192, 21, 47;
  --color-red-400-rgb: 255, 84, 89;
  --color-orange-500-rgb: 168, 75, 47;
  --color-orange-400-rgb: 230, 129, 97;

  /* Background color tokens (Light Mode) */
  --color-bg-1: rgba(59, 130, 246, 0.08); /* Light blue */
  --color-bg-2: rgba(245, 158, 11, 0.08); /* Light yellow */
  --color-bg-3: rgba(34, 197, 94, 0.08); /* Light green */
  --color-bg-4: rgba(239, 68, 68, 0.08); /* Light red */
  --color-bg-5: rgba(147, 51, 234, 0.08); /* Light purple */
  --color-bg-6: rgba(249, 115, 22, 0.08); /* Light orange */
  --color-bg-7: rgba(236, 72, 153, 0.08); /* Light pink */
  --color-bg-8: rgba(6, 182, 212, 0.08); /* Light cyan */

  /* Semantic Color Tokens (Light Mode) */
  --color-background: var(--color-cream-50);
  --color-surface: var(--color-cream-100);
  --color-text: var(--color-slate-900);
  --color-text-secondary: var(--color-slate-500);
  --color-primary: var(--color-teal-500);
  --color-primary-hover: var(--color-teal-600);
  --color-primary-active: var(--color-teal-700);
  --color-secondary: rgba(var(--color-brown-600-rgb), 0.12);
  --color-secondary-hover: rgba(var(--color-brown-600-rgb), 0.2);
  --color-secondary-active: rgba(var(--color-brown-600-rgb), 0.25);
  --color-border: rgba(var(--color-brown-600-rgb), 0.2);
  --color-btn-primary-text: var(--color-cream-50);
  --color-card-border: rgba(var(--color-brown-600-rgb), 0.12);
  --color-card-border-inner: rgba(var(--color-brown-600-rgb), 0.12);
  --color-error: var(--color-red-500);
  --color-success: var(--color-teal-500);
  --color-warning: var(--color-orange-500);
  --color-info: var(--color-slate-500);
  --color-focus-ring: rgba(var(--color-teal-500-rgb), 0.4);
  --color-select-caret: rgba(var(--color-slate-900-rgb), 0.8);

  /* Common style patterns */
  --focus-ring: 0 0 0 3px var(--color-focus-ring);
  --focus-outline: 2px solid var(--color-primary);
  --status-bg-opacity: 0.15;
  --status-border-opacity: 0.25;
  --select-caret-light: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23134252' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
  --select-caret-dark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23f5f5f5' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");

  /* RGB versions for opacity control */
  --color-success-rgb: 33, 128, 141;
  --color-error-rgb: 192, 21, 47;
  --color-warning-rgb: 168, 75, 47;
  --color-info-rgb: 98, 108, 113;

  /* Typography */
  --font-family-base: "FKGroteskNeue", "Geist", "Inter", -apple-system,
    BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  --font-family-mono: "Berkeley Mono", ui-monospace, SFMono-Regular, Menlo,
    Monaco, Consolas, monospace;
  --font-size-xs: 11px;
  --font-size-sm: 12px;
  --font-size-base: 14px;
  --font-size-md: 14px;
  --font-size-lg: 16px;
  --font-size-xl: 18px;
  --font-size-2xl: 20px;
  --font-size-3xl: 24px;
  --font-size-4xl: 30px;
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 550;
  --font-weight-bold: 600;
  --line-height-tight: 1.2;
  --line-height-normal: 1.5;
  --letter-spacing-tight: -0.01em;

  /* Spacing */
  --space-0: 0;
  --space-1: 1px;
  --space-2: 2px;
  --space-4: 4px;
  --space-6: 6px;
  --space-8: 8px;
  --space-10: 10px;
  --space-12: 12px;
  --space-16: 16px;
  --space-20: 20px;
  --space-24: 24px;
  --space-32: 32px;

  /* Border Radius */
  --radius-sm: 6px;
  --radius-base: 8px;
  --radius-md: 10px;
  --radius-lg: 12px;
  --radius-full: 9999px;

  /* Shadows */
  --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.02);
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.02);
  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.04),
    0 2px 4px -1px rgba(0, 0, 0, 0.02);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.04),
    0 4px 6px -2px rgba(0, 0, 0, 0.02);
  --shadow-inset-sm: inset 0 1px 0 rgba(255, 255, 255, 0.15),
    inset 0 -1px 0 rgba(0, 0, 0, 0.03);

  /* Animation */
  --duration-fast: 150ms;
  --duration-normal: 250ms;
  --ease-standard: cubic-bezier(0.16, 1, 0.3, 1);

  /* Layout */
  --container-sm: 640px;
  --container-md: 768px;
  --container-lg: 1024px;
  --container-xl: 1280px;
}

/* Dark mode colors */
@media (prefers-color-scheme: dark) {
  :root {
    /* RGB versions for opacity control (Dark Mode) */
    --color-gray-400-rgb: 119, 124, 124;
    --color-teal-300-rgb: 50, 184, 198;
    --color-gray-300-rgb: 167, 169, 169;
    --color-gray-200-rgb: 245, 245, 245;

    /* Background color tokens (Dark Mode) */
    --color-bg-1: rgba(29, 78, 216, 0.15); /* Dark blue */
    --color-bg-2: rgba(180, 83, 9, 0.15); /* Dark yellow */
    --color-bg-3: rgba(21, 128, 61, 0.15); /* Dark green */
    --color-bg-4: rgba(185, 28, 28, 0.15); /* Dark red */
    --color-bg-5: rgba(107, 33, 168, 0.15); /* Dark purple */
    --color-bg-6: rgba(194, 65, 12, 0.15); /* Dark orange */
    --color-bg-7: rgba(190, 24, 93, 0.15); /* Dark pink */
    --color-bg-8: rgba(8, 145, 178, 0.15); /* Dark cyan */
    
    /* Semantic Color Tokens (Dark Mode) */
    --color-background: var(--color-charcoal-700);
    --color-surface: var(--color-charcoal-800);
    --color-text: var(--color-gray-200);
    --color-text-secondary: rgba(var(--color-gray-300-rgb), 0.7);
    --color-primary: var(--color-teal-300);
    --color-primary-hover: var(--color-teal-400);
    --color-primary-active: var(--color-teal-800);
    --color-secondary: rgba(var(--color-gray-400-rgb), 0.15);
    --color-secondary-hover: rgba(var(--color-gray-400-rgb), 0.25);
    --color-secondary-active: rgba(var(--color-gray-400-rgb), 0.3);
    --color-border: rgba(var(--color-gray-400-rgb), 0.3);
    --color-error: var(--color-red-400);
    --color-success: var(--color-teal-300);
    --color-warning: var(--color-orange-400);
    --color-info: var(--color-gray-300);
    --color-focus-ring: rgba(var(--color-teal-300-rgb), 0.4);
    --color-btn-primary-text: var(--color-slate-900);
    --color-card-border: rgba(var(--color-gray-400-rgb), 0.2);
    --color-card-border-inner: rgba(var(--color-gray-400-rgb), 0.15);
    --shadow-inset-sm: inset 0 1px 0 rgba(255, 255, 255, 0.1),
      inset 0 -1px 0 rgba(0, 0, 0, 0.15);
    --button-border-secondary: rgba(var(--color-gray-400-rgb), 0.2);
    --color-border-secondary: rgba(var(--color-gray-400-rgb), 0.2);
    --color-select-caret: rgba(var(--color-gray-200-rgb), 0.8);

    /* Common style patterns - updated for dark mode */
    --focus-ring: 0 0 0 3px var(--color-focus-ring);
    --focus-outline: 2px solid var(--color-primary);
    --status-bg-opacity: 0.15;
    --status-border-opacity: 0.25;
    --select-caret-light: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23134252' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
    --select-caret-dark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23f5f5f5' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");

    /* RGB versions for dark mode */
    --color-success-rgb: var(--color-teal-300-rgb);
    --color-error-rgb: var(--color-red-400-rgb);
    --color-warning-rgb: var(--color-orange-400-rgb);
    --color-info-rgb: var(--color-gray-300-rgb);
  }
}

/* Data attribute for manual theme switching */
[data-color-scheme="dark"] {
  /* RGB versions for opacity control (dark mode) */
  --color-gray-400-rgb: 119, 124, 124;
  --color-teal-300-rgb: 50, 184, 198;
  --color-gray-300-rgb: 167, 169, 169;
  --color-gray-200-rgb: 245, 245, 245;

  /* Colorful background palette - Dark Mode */
  --color-bg-1: rgba(29, 78, 216, 0.15); /* Dark blue */
  --color-bg-2: rgba(180, 83, 9, 0.15); /* Dark yellow */
  --color-bg-3: rgba(21, 128, 61, 0.15); /* Dark green */
  --color-bg-4: rgba(185, 28, 28, 0.15); /* Dark red */
  --color-bg-5: rgba(107, 33, 168, 0.15); /* Dark purple */
  --color-bg-6: rgba(194, 65, 12, 0.15); /* Dark orange */
  --color-bg-7: rgba(190, 24, 93, 0.15); /* Dark pink */
  --color-bg-8: rgba(8, 145, 178, 0.15); /* Dark cyan */
  
  /* Semantic Color Tokens (Dark Mode) */
  --color-background: var(--color-charcoal-700);
  --color-surface: var(--color-charcoal-800);
  --color-text: var(--color-gray-200);
  --color-text-secondary: rgba(var(--color-gray-300-rgb), 0.7);
  --color-primary: var(--color-teal-300);
  --color-primary-hover: var(--color-teal-400);
  --color-primary-active: var(--color-teal-800);
  --color-secondary: rgba(var(--color-gray-400-rgb), 0.15);
  --color-secondary-hover: rgba(var(--color-gray-400-rgb), 0.25);
  --color-secondary-active: rgba(var(--color-gray-400-rgb), 0.3);
  --color-border: rgba(var(--color-gray-400-rgb), 0.3);
  --color-error: var(--color-red-400);
  --color-success: var(--color-teal-300);
  --color-warning: var(--color-orange-400);
  --color-info: var(--color-gray-300);
  --color-focus-ring: rgba(var(--color-teal-300-rgb), 0.4);
  --color-btn-primary-text: var(--color-slate-900);
  --color-card-border: rgba(var(--color-gray-400-rgb), 0.15);
  --color-card-border-inner: rgba(var(--color-gray-400-rgb), 0.15);
  --shadow-inset-sm: inset 0 1px 0 rgba(255, 255, 255, 0.1),
    inset 0 -1px 0 rgba(0, 0, 0, 0.15);
  --color-border-secondary: rgba(var(--color-gray-400-rgb), 0.2);
  --color-select-caret: rgba(var(--color-gray-200-rgb), 0.8);

  /* Common style patterns - updated for dark mode */
  --focus-ring: 0 0 0 3px var(--color-focus-ring);
  --focus-outline: 2px solid var(--color-primary);
  --status-bg-opacity: 0.15;
  --status-border-opacity: 0.25;
  --select-caret-light: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23134252' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
  --select-caret-dark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23f5f5f5' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");

  /* RGB versions for dark mode */
  --color-success-rgb: var(--color-teal-300-rgb);
  --color-error-rgb: var(--color-red-400-rgb);
  --color-warning-rgb: var(--color-orange-400-rgb);
  --color-info-rgb: var(--color-gray-300-rgb);
}

[data-color-scheme="light"] {
  /* RGB versions for opacity control (light mode) */
  --color-brown-600-rgb: 94, 82, 64;
  --color-teal-500-rgb: 33, 128, 141;
  --color-slate-900-rgb: 19, 52, 59;
  
  /* Semantic Color Tokens (Light Mode) */
  --color-background: var(--color-cream-50);
  --color-surface: var(--color-cream-100);
  --color-text: var(--color-slate-900);
  --color-text-secondary: var(--color-slate-500);
  --color-primary: var(--color-teal-500);
  --color-primary-hover: var(--color-teal-600);
  --color-primary-active: var(--color-teal-700);
  --color-secondary: rgba(var(--color-brown-600-rgb), 0.12);
  --color-secondary-hover: rgba(var(--color-brown-600-rgb), 0.2);
  --color-secondary-active: rgba(var(--color-brown-600-rgb), 0.25);
  --color-border: rgba(var(--color-brown-600-rgb), 0.2);
  --color-btn-primary-text: var(--color-cream-50);
  --color-card-border: rgba(var(--color-brown-600-rgb), 0.12);
  --color-card-border-inner: rgba(var(--color-brown-600-rgb), 0.12);
  --color-error: var(--color-red-500);
  --color-success: var(--color-teal-500);
  --color-warning: var(--color-orange-500);
  --color-info: var(--color-slate-500);
  --color-focus-ring: rgba(var(--color-teal-500-rgb), 0.4);

  /* RGB versions for light mode */
  --color-success-rgb: var(--color-teal-500-rgb);
  --color-error-rgb: var(--color-red-500-rgb);
  --color-warning-rgb: var(--color-orange-500-rgb);
  --color-info-rgb: var(--color-slate-500-rgb);
}

/* Base styles */
html {
  font-size: var(--font-size-base);
  font-family: var(--font-family-base);
  line-height: var(--line-height-normal);
  color: var(--color-text);
  background-color: var(--color-background);
  -webkit-font-smoothing: antialiased;
  box-sizing: border-box;
}

body {
  margin: 0;
  padding: 0;
}

*,
*::before,
*::after {
  box-sizing: inherit;
}

/* Typography */
h1,
h2,
h3,
h4,
h5,
h6 {
  margin: 0;
  font-weight: var(--font-weight-semibold);
  line-height: var(--line-height-tight);
  color: var(--color-text);
  letter-spacing: var(--letter-spacing-tight);
}

h1 {
  font-size: var(--font-size-4xl);
}
h2 {
  font-size: var(--font-size-3xl);
}
h3 {
  font-size: var(--font-size-2xl);
}
h4 {
  font-size: var(--font-size-xl);
}
h5 {
  font-size: var(--font-size-lg);
}
h6 {
  font-size: var(--font-size-md);
}

p {
  margin: 0 0 var(--space-16) 0;
}

a {
  color: var(--color-primary);
  text-decoration: none;
  transition: color var(--duration-fast) var(--ease-standard);
}

a:hover {
  color: var(--color-primary-hover);
}

code,
pre {
  font-family: var(--font-family-mono);
  font-size: calc(var(--font-size-base) * 0.95);
  background-color: var(--color-secondary);
  border-radius: var(--radius-sm);
}

code {
  padding: var(--space-1) var(--space-4);
}

pre {
  padding: var(--space-16);
  margin: var(--space-16) 0;
  overflow: auto;
  border: 1px solid var(--color-border);
}

pre code {
  background: none;
  padding: 0;
}

/* Buttons */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: var(--space-8) var(--space-16);
  border-radius: var(--radius-base);
  font-size: var(--font-size-base);
  font-weight: 500;
  line-height: 1.5;
  cursor: pointer;
  transition: all var(--duration-normal) var(--ease-standard);
  border: none;
  text-decoration: none;
  position: relative;
}

.btn:focus-visible {
  outline: none;
  box-shadow: var(--focus-ring);
}

.btn--primary {
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
}

.btn--primary:hover {
  background: var(--color-primary-hover);
}

.btn--primary:active {
  background: var(--color-primary-active);
}

.btn--secondary {
  background: var(--color-secondary);
  color: var(--color-text);
}

.btn--secondary:hover {
  background: var(--color-secondary-hover);
}

.btn--secondary:active {
  background: var(--color-secondary-active);
}

.btn--outline {
  background: transparent;
  border: 1px solid var(--color-border);
  color: var(--color-text);
}

.btn--outline:hover {
  background: var(--color-secondary);
}

.btn--sm {
  padding: var(--space-4) var(--space-12);
  font-size: var(--font-size-sm);
  border-radius: var(--radius-sm);
}

.btn--lg {
  padding: var(--space-10) var(--space-20);
  font-size: var(--font-size-lg);
  border-radius: var(--radius-md);
}

.btn--full-width {
  width: 100%;
}

.btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Form elements */
.form-control {
  display: block;
  width: 100%;
  padding: var(--space-8) var(--space-12);
  font-size: var(--font-size-md);
  line-height: 1.5;
  color: var(--color-text);
  background-color: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-base);
  transition: border-color var(--duration-fast) var(--ease-standard),
    box-shadow var(--duration-fast) var(--ease-standard);
}

textarea.form-control {
  font-family: var(--font-family-base);
  font-size: var(--font-size-base);
}

select.form-control {
  padding: var(--space-8) var(--space-12);
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  background-image: var(--select-caret-light);
  background-repeat: no-repeat;
  background-position: right var(--space-12) center;
  background-size: 16px;
  padding-right: var(--space-32);
}

/* Add a dark mode specific caret */
@media (prefers-color-scheme: dark) {
  select.form-control {
    background-image: var(--select-caret-dark);
  }
}

/* Also handle data-color-scheme */
[data-color-scheme="dark"] select.form-control {
  background-image: var(--select-caret-dark);
}

[data-color-scheme="light"] select.form-control {
  background-image: var(--select-caret-light);
}

.form-control:focus {
  border-color: var(--color-primary);
  outline: var(--focus-outline);
}

.form-label {
  display: block;
  margin-bottom: var(--space-8);
  font-weight: var(--font-weight-medium);
  font-size: var(--font-size-sm);
}

.form-group {
  margin-bottom: var(--space-16);
}

/* Card component */
.card {
  background-color: var(--color-surface);
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-card-border);
  box-shadow: var(--shadow-sm);
  overflow: hidden;
  transition: box-shadow var(--duration-normal) var(--ease-standard);
}

.card:hover {
  box-shadow: var(--shadow-md);
}

.card__body {
  padding: var(--space-16);
}

.card__header,
.card__footer {
  padding: var(--space-16);
  border-bottom: 1px solid var(--color-card-border-inner);
}

/* Status indicators - simplified with CSS variables */
.status {
  display: inline-flex;
  align-items: center;
  padding: var(--space-6) var(--space-12);
  border-radius: var(--radius-full);
  font-weight: var(--font-weight-medium);
  font-size: var(--font-size-sm);
}

.status--success {
  background-color: rgba(
    var(--color-success-rgb, 33, 128, 141),
    var(--status-bg-opacity)
  );
  color: var(--color-success);
  border: 1px solid
    rgba(var(--color-success-rgb, 33, 128, 141), var(--status-border-opacity));
}

.status--error {
  background-color: rgba(
    var(--color-error-rgb, 192, 21, 47),
    var(--status-bg-opacity)
  );
  color: var(--color-error);
  border: 1px solid
    rgba(var(--color-error-rgb, 192, 21, 47), var(--status-border-opacity));
}

.status--warning {
  background-color: rgba(
    var(--color-warning-rgb, 168, 75, 47),
    var(--status-bg-opacity)
  );
  color: var(--color-warning);
  border: 1px solid
    rgba(var(--color-warning-rgb, 168, 75, 47), var(--status-border-opacity));
}

.status--info {
  background-color: rgba(
    var(--color-info-rgb, 98, 108, 113),
    var(--status-bg-opacity)
  );
  color: var(--color-info);
  border: 1px solid
    rgba(var(--color-info-rgb, 98, 108, 113), var(--status-border-opacity));
}

/* Container layout */
.container {
  width: 100%;
  margin-right: auto;
  margin-left: auto;
  padding-right: var(--space-16);
  padding-left: var(--space-16);
}

@media (min-width: 640px) {
  .container {
    max-width: var(--container-sm);
  }
}
@media (min-width: 768px) {
  .container {
    max-width: var(--container-md);
  }
}
@media (min-width: 1024px) {
  .container {
    max-width: var(--container-lg);
  }
}
@media (min-width: 1280px) {
  .container {
    max-width: var(--container-xl);
  }
}

/* Utility classes */
.flex {
  display: flex;
}
.flex-col {
  flex-direction: column;
}
.items-center {
  align-items: center;
}
.justify-center {
  justify-content: center;
}
.justify-between {
  justify-content: space-between;
}
.gap-4 {
  gap: var(--space-4);
}
.gap-8 {
  gap: var(--space-8);
}
.gap-16 {
  gap: var(--space-16);
}

.m-0 {
  margin: 0;
}
.mt-8 {
  margin-top: var(--space-8);
}
.mb-8 {
  margin-bottom: var(--space-8);
}
.mx-8 {
  margin-left: var(--space-8);
  margin-right: var(--space-8);
}
.my-8 {
  margin-top: var(--space-8);
  margin-bottom: var(--space-8);
}

.p-0 {
  padding: 0;
}
.py-8 {
  padding-top: var(--space-8);
  padding-bottom: var(--space-8);
}
.px-8 {
  padding-left: var(--space-8);
  padding-right: var(--space-8);
}
.py-16 {
  padding-top: var(--space-16);
  padding-bottom: var(--space-16);
}
.px-16 {
  padding-left: var(--space-16);
  padding-right: var(--space-16);
}

.block {
  display: block;
}
.hidden {
  display: none;
}

/* Accessibility */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

:focus-visible {
  outline: var(--focus-outline);
  outline-offset: 2px;
}

/* Dark mode specifics */
[data-color-scheme="dark"] .btn--outline {
  border: 1px solid var(--color-border-secondary);
}

@font-face {
  font-family: 'FKGroteskNeue';
  src: url('https://r2cdn.perplexity.ai/fonts/FKGroteskNeue.woff2')
    format('woff2');
}

/* END PERPLEXITY DESIGN SYSTEM */
/* Enhanced Loading Screen */
.loading-screen {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-active) 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}

.loading-spinner {
  text-align: center;
  color: var(--color-white);
}

.spinner {
  width: 50px;
  height: 50px;
  border: 4px solid rgba(255, 255, 255, 0.3);
  border-top: 4px solid var(--color-white);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto var(--space-24) auto;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.loading-spinner p {
  color: var(--color-white);
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-medium);
  margin: 0 0 var(--space-24) 0;
}

.loading-features {
  display: flex;
  flex-direction: column;
  gap: var(--space-8);
  margin-top: var(--space-16);
}

.feature-item {
  color: rgba(255, 255, 255, 0.9);
  font-size: var(--font-size-sm);
  animation: fadeInUp 0.6s ease-out forwards;
  opacity: 0;
}

.feature-item:nth-child(1) { animation-delay: 0.2s; }
.feature-item:nth-child(2) { animation-delay: 0.4s; }
.feature-item:nth-child(3) { animation-delay: 0.6s; }
.feature-item:nth-child(4) { animation-delay: 0.8s; }

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Enhanced Login Screen */
.login-screen {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-active) 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9998;
}

.login-container {
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-lg);
  padding: var(--space-32);
  width: 100%;
  max-width: 450px;
  margin: var(--space-16);
}

.login-header {
  text-align: center;
  margin-bottom: var(--space-32);
}

.login-header i {
  font-size: 56px;
  color: var(--color-primary);
  margin-bottom: var(--space-16);
}

.login-header h1 {
  margin-bottom: var(--space-8);
  color: var(--color-text);
}

.login-header p {
  color: var(--color-text-secondary);
  margin: 0 0 var(--space-16) 0;
}

.version-badge {
  display: inline-block;
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
  padding: var(--space-4) var(--space-12);
  border-radius: var(--radius-full);
  font-size: var(--font-size-xs);
  font-weight: var(--font-weight-medium);
}

.login-form {
  text-align: center;
}

.login-features {
  display: grid;
  grid-template-columns: 1fr;
  gap: var(--space-16);
  margin-top: var(--space-24);
}

.feature {
  display: flex;
  align-items: center;
  gap: var(--space-12);
  color: var(--color-text-secondary);
  font-size: var(--font-size-sm);
  padding: var(--space-8);
  background: var(--color-background);
  border-radius: var(--radius-base);
}

.feature i {
  color: var(--color-primary);
  width: 20px;
}

/* Enhanced Sidebar */
.main-app {
  display: grid;
  grid-template-columns: 280px 1fr;
  height: 100vh;
  overflow: hidden;
}

.main-app.sidebar-collapsed {
  grid-template-columns: 60px 1fr;
}

.sidebar {
  background: var(--color-surface);
  border-right: 1px solid var(--color-border);
  display: flex;
  flex-direction: column;
  transition: all var(--duration-normal) var(--ease-standard);
}

.sidebar-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-16);
  border-bottom: 1px solid var(--color-border);
}

.logo {
  display: flex;
  align-items: center;
  gap: var(--space-12);
}

.logo i {
  font-size: var(--font-size-xl);
  color: var(--color-primary);
}

.logo-text {
  font-weight: var(--font-weight-bold);
  font-size: var(--font-size-lg);
  color: var(--color-text);
}

.version-tag {
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
  font-size: var(--font-size-xs);
  padding: var(--space-2) var(--space-6);
  border-radius: var(--radius-sm);
  font-weight: var(--font-weight-medium);
}

.sidebar-toggle {
  background: none;
  border: none;
  color: var(--color-text-secondary);
  font-size: var(--font-size-lg);
  cursor: pointer;
  padding: var(--space-4);
  border-radius: var(--radius-sm);
  transition: all var(--duration-fast) var(--ease-standard);
}

.sidebar-toggle:hover {
  background: var(--color-secondary);
  color: var(--color-text);
}

.sidebar-nav {
  flex: 1;
  padding: var(--space-16) 0;
}

.sidebar-nav ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.sidebar-nav li {
  margin-bottom: var(--space-4);
}

.nav-link {
  display: flex;
  align-items: center;
  gap: var(--space-12);
  padding: var(--space-12) var(--space-16);
  color: var(--color-text-secondary);
  text-decoration: none;
  transition: all var(--duration-fast) var(--ease-standard);
  border-radius: var(--radius-base);
  margin: 0 var(--space-8);
}

.nav-link:hover {
  background: var(--color-secondary);
  color: var(--color-text);
}

.nav-link.active {
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
}

.nav-link i {
  width: 20px;
  text-align: center;
}

.sidebar-footer {
  padding: var(--space-16);
  border-top: 1px solid var(--color-border);
}

.user-profile {
  display: flex;
  align-items: center;
  gap: var(--space-12);
  margin-bottom: var(--space-16);
}

.user-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  object-fit: cover;
}

.user-info {
  display: flex;
  flex-direction: column;
  min-width: 0;
}

.user-name {
  font-weight: var(--font-weight-medium);
  font-size: var(--font-size-sm);
  color: var(--color-text);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.user-role {
  font-size: var(--font-size-xs);
  color: var(--color-text-secondary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Enhanced Header */
.main-content {
  display: flex;
  flex-direction: column;
  height: 100vh;
  overflow: hidden;
}

.app-header {
  background: var(--color-surface);
  border-bottom: 1px solid var(--color-border);
  padding: var(--space-16) var(--space-24);
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.header-left h2 {
  margin: 0 0 var(--space-4) 0;
  color: var(--color-text);
}

.breadcrumb {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.header-right {
  display: flex;
  align-items: center;
  gap: var(--space-12);
}

.sync-status {
  display: flex;
  align-items: center;
  gap: var(--space-6);
  padding: var(--space-6) var(--space-12);
  background: var(--color-bg-3);
  border-radius: var(--radius-base);
  font-size: var(--font-size-sm);
  color: var(--color-success);
}

.sync-status.syncing {
  color: var(--color-warning);
}

.sync-status.error {
  color: var(--color-error);
  background: var(--color-bg-4);
}

.content-wrapper {
  flex: 1;
  overflow-y: auto;
  padding: var(--space-24);
  background: var(--color-background);
}

/* Enhanced Dashboard */
.content-section {
  display: none;
}

.content-section.active {
  display: block;
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: var(--space-20);
  margin-bottom: var(--space-32);
}

.stat-card {
  background: var(--color-surface);
  padding: var(--space-24);
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-card-border);
  display: flex;
  align-items: center;
  gap: var(--space-16);
  box-shadow: var(--shadow-sm);
  transition: all var(--duration-fast) var(--ease-standard);
}

.stat-card:hover {
  box-shadow: var(--shadow-md);
  transform: translateY(-2px);
}

.stat-icon {
  width: 60px;
  height: 60px;
  border-radius: var(--radius-base);
  display: flex;
  align-items: center;
  justify-content: center;
}

.stat-icon i {
  font-size: var(--font-size-2xl);
  color: var(--color-primary);
}

.stat-content h3 {
  font-size: var(--font-size-4xl);
  font-weight: var(--font-weight-bold);
  color: var(--color-text);
  margin: 0 0 var(--space-4) 0;
}

.stat-content p {
  font-size: var(--font-size-base);
  color: var(--color-text-secondary);
  margin: 0 0 var(--space-4) 0;
}

.stat-change {
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  padding: var(--space-2) var(--space-6);
  border-radius: var(--radius-sm);
}

.stat-change.positive {
  color: var(--color-success);
  background: rgba(var(--color-success-rgb), 0.1);
}

.stat-change.negative {
  color: var(--color-error);
  background: rgba(var(--color-error-rgb), 0.1);
}

.stat-change.neutral {
  color: var(--color-info);
  background: rgba(var(--color-info-rgb), 0.1);
}

.dashboard-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-24);
  margin-bottom: var(--space-32);
}

.dashboard-card {
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-card-border);
  box-shadow: var(--shadow-sm);
  overflow: hidden;
}

.card-header {
  padding: var(--space-20);
  border-bottom: 1px solid var(--color-card-border-inner);
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.card-header h3 {
  margin: 0;
  color: var(--color-text);
}

.activity-controls {
  display: flex;
  gap: var(--space-8);
}

.chart-controls {
  display: flex;
  gap: var(--space-8);
}

.activity-list {
  padding: var(--space-20);
  max-height: 300px;
  overflow-y: auto;
}

.activity-item {
  display: flex;
  align-items: center;
  gap: var(--space-12);
  padding: var(--space-12) 0;
  border-bottom: 1px solid var(--color-card-border-inner);
}

.activity-item:last-child {
  border-bottom: none;
}

.activity-icon {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: var(--font-size-sm);
}

.activity-content {
  flex: 1;
}

.activity-title {
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
  margin: 0 0 var(--space-2) 0;
}

.activity-meta {
  font-size: var(--font-size-xs);
  color: var(--color-text-secondary);
  margin: 0;
}

/* AI Insights Section */
.ai-insights-section {
  margin-top: var(--space-32);
}

.ai-insights-card {
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-card-border);
  box-shadow: var(--shadow-sm);
  overflow: hidden;
}

.insights-grid {
  padding: var(--space-20);
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: var(--space-20);
}

.insight-item {
  display: flex;
  align-items: flex-start;
  gap: var(--space-16);
  padding: var(--space-16);
  background: var(--color-background);
  border-radius: var(--radius-base);
}

.insight-icon {
  width: 48px;
  height: 48px;
  border-radius: var(--radius-base);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.insight-icon i {
  font-size: var(--font-size-lg);
  color: var(--color-primary);
}

.insight-content h4 {
  margin: 0 0 var(--space-8) 0;
  color: var(--color-text);
  font-size: var(--font-size-base);
}

.insight-content p {
  margin: 0;
  color: var(--color-text-secondary);
  font-size: var(--font-size-sm);
}

/* Bulk Import Section */
.bulk-import-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-32);
}

.bulk-import-header h3 {
  margin: 0;
  color: var(--color-text);
}

.import-stats {
  display: flex;
  gap: var(--space-16);
}

.import-stats .stat {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
  padding: var(--space-4) var(--space-8);
  background: var(--color-secondary);
  border-radius: var(--radius-sm);
}

.import-section {
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-card-border);
  padding: var(--space-24);
  margin-bottom: var(--space-24);
}

.import-options {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-16);
  margin-bottom: var(--space-24);
}

.import-method {
  padding: var(--space-20);
  border: 2px solid var(--color-border);
  border-radius: var(--radius-base);
  text-align: center;
  cursor: pointer;
  transition: all var(--duration-fast) var(--ease-standard);
}

.import-method:hover {
  border-color: var(--color-primary);
  background: var(--color-secondary);
}

.import-method.active {
  border-color: var(--color-primary);
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
}

.import-method i {
  font-size: var(--font-size-3xl);
  margin-bottom: var(--space-12);
}

.import-method h4 {
  margin: 0 0 var(--space-8) 0;
}

.import-method p {
  margin: 0;
  font-size: var(--font-size-sm);
  opacity: 0.8;
}

.import-dropzone {
  border: 3px dashed var(--color-border);
  border-radius: var(--radius-lg);
  padding: var(--space-32);
  text-align: center;
  cursor: pointer;
  transition: all var(--duration-fast) var(--ease-standard);
  margin-bottom: var(--space-24);
}

.import-dropzone:hover,
.import-dropzone.dragover {
  border-color: var(--color-primary);
  background: var(--color-secondary);
}

.dropzone-content i {
  font-size: var(--font-size-4xl);
  color: var(--color-text-secondary);
  margin-bottom: var(--space-16);
}

.dropzone-content h3 {
  margin: 0 0 var(--space-8) 0;
  color: var(--color-text);
}

.dropzone-content p {
  margin: 0 0 var(--space-16) 0;
  color: var(--color-text-secondary);
}

.file-requirements {
  margin-top: var(--space-16);
  padding: var(--space-16);
  background: var(--color-background);
  border-radius: var(--radius-base);
}

.file-requirements h4 {
  margin: 0 0 var(--space-12) 0;
  font-size: var(--font-size-sm);
  color: var(--color-text);
}

.columns-grid {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-8);
}

.column-tag {
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
  padding: var(--space-4) var(--space-8);
  border-radius: var(--radius-sm);
  font-size: var(--font-size-xs);
  font-weight: var(--font-weight-medium);
}

.import-preview {
  margin-top: var(--space-24);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-base);
  overflow: hidden;
}

.import-preview.hidden {
  display: none;
}

.preview-header {
  padding: var(--space-16);
  background: var(--color-secondary);
  border-bottom: 1px solid var(--color-border);
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.preview-header h4 {
  margin: 0;
  color: var(--color-text);
}

.preview-stats {
  display: flex;
  gap: var(--space-12);
  align-items: center;
}

.preview-table {
  max-height: 400px;
  overflow: auto;
  padding: var(--space-16);
}

.import-actions {
  padding: var(--space-16);
  background: var(--color-background);
  display: flex;
  gap: var(--space-12);
  justify-content: flex-end;
}

.import-progress {
  margin-top: var(--space-24);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-base);
  overflow: hidden;
}

.import-progress.hidden {
  display: none;
}

.progress-header {
  padding: var(--space-16);
  background: var(--color-secondary);
  border-bottom: 1px solid var(--color-border);
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.progress-header h4 {
  margin: 0;
  color: var(--color-text);
}

.progress-bar {
  height: 8px;
  background: var(--color-secondary);
  margin: var(--space-16);
  border-radius: var(--radius-sm);
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  background: var(--color-primary);
  transition: width var(--duration-normal) var(--ease-standard);
  width: 0%;
}

.import-log {
  padding: var(--space-16);
  max-height: 200px;
  overflow-y: auto;
  font-family: var(--font-family-mono);
  font-size: var(--font-size-sm);
  background: var(--color-background);
}

.import-templates {
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-card-border);
  padding: var(--space-24);
}

.import-templates h4 {
  margin: 0 0 var(--space-16) 0;
  color: var(--color-text);
}

.template-options {
  display: flex;
  gap: var(--space-12);
}

/* Enhanced Accounts Section */
.section-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-24);
}

.section-header h3 {
  margin: 0;
  color: var(--color-text);
}

.accounts-stats {
  display: flex;
  gap: var(--space-16);
}

.accounts-stats .stat {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.accounts-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
  gap: var(--space-20);
}

.account-card {
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-card-border);
  padding: var(--space-20);
  display: flex;
  align-items: center;
  gap: var(--space-16);
  box-shadow: var(--shadow-sm);
  transition: all var(--duration-fast) var(--ease-standard);
}

.account-card:hover {
  box-shadow: var(--shadow-md);
  transform: translateY(-2px);
}

.account-icon {
  width: 56px;
  height: 56px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: var(--font-size-2xl);
  color: white;
}

.account-info {
  flex: 1;
  min-width: 0;
}

.account-name {
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
  margin: 0 0 var(--space-4) 0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.account-username {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
  margin: 0 0 var(--space-8) 0;
}

.account-stats {
  display: flex;
  align-items: center;
  gap: var(--space-16);
}

.account-stat {
  font-size: var(--font-size-xs);
  color: var(--color-text-secondary);
}

.account-actions {
  display: flex;
  flex-direction: column;
  gap: var(--space-8);
}

/* Enhanced Composer */
.composer-container {
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-card-border);
  box-shadow: var(--shadow-sm);
  overflow: hidden;
}

.composer-header {
  padding: var(--space-20);
  border-bottom: 1px solid var(--color-card-border-inner);
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.composer-header h3 {
  margin: 0;
  color: var(--color-text);
  display: flex;
  align-items: center;
  gap: var(--space-8);
}

.composer-actions {
  display: flex;
  gap: var(--space-12);
}

.composer-content {
  display: grid;
  grid-template-columns: 1fr 350px;
  gap: var(--space-24);
  padding: var(--space-20);
}

.composer-main {
  display: flex;
  flex-direction: column;
  gap: var(--space-20);
}

.platform-selector {
  margin-bottom: var(--space-16);
}

.platform-checkboxes {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-12);
}

.platform-checkbox {
  display: flex;
  align-items: center;
  gap: var(--space-8);
  padding: var(--space-8) var(--space-12);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-base);
  cursor: pointer;
  transition: all var(--duration-fast) var(--ease-standard);
}

.platform-checkbox:hover {
  background: var(--color-secondary);
}

.platform-checkbox.selected {
  border-color: var(--color-primary);
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
}

.platform-checkbox input[type="checkbox"] {
  display: none;
}

.composer-tools {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-top: var(--space-8);
}

.character-counter {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.character-counter.warning {
  color: var(--color-warning);
}

.character-counter.error {
  color: var(--color-error);
}

.ai-tools {
  display: flex;
  gap: var(--space-8);
}

.media-upload-section {
  margin-top: var(--space-16);
}

.media-dropzone {
  border: 2px dashed var(--color-border);
  border-radius: var(--radius-base);
  padding: var(--space-32);
  text-align: center;
  cursor: pointer;
  transition: all var(--duration-fast) var(--ease-standard);
}

.media-dropzone:hover,
.media-dropzone.dragover {
  border-color: var(--color-primary);
  background: var(--color-secondary);
}

.dropzone-content i {
  font-size: var(--font-size-3xl);
  color: var(--color-text-secondary);
  margin-bottom: var(--space-12);
}

.dropzone-content p {
  color: var(--color-text-secondary);
  margin: 0;
}

.media-preview {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
  gap: var(--space-12);
  margin-top: var(--space-16);
}

.media-item {
  position: relative;
  border-radius: var(--radius-base);
  overflow: hidden;
  aspect-ratio: 1;
}

.media-item img,
.media-item video {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.media-remove {
  position: absolute;
  top: var(--space-4);
  right: var(--space-4);
  background: rgba(0, 0, 0, 0.7);
  color: white;
  border: none;
  border-radius: 50%;
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  font-size: var(--font-size-xs);
}

.composer-sidebar {
  border-left: 1px solid var(--color-card-border-inner);
  padding-left: var(--space-20);
}

.post-preview {
  background: var(--color-background);
  border-radius: var(--radius-base);
  padding: var(--space-16);
  margin-bottom: var(--space-20);
}

.post-preview h4 {
  margin: 0 0 var(--space-16) 0;
  color: var(--color-text);
}

.preview-content {
  display: flex;
  flex-direction: column;
  gap: var(--space-12);
}

.preview-platform {
  border: 1px solid var(--color-border);
  border-radius: var(--radius-base);
  overflow: hidden;
}

.platform-header {
  display: flex;
  align-items: center;
  gap: var(--space-8);
  padding: var(--space-8) var(--space-12);
  background: var(--color-secondary);
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
}

.preview-post {
  padding: var(--space-12);
}

.preview-text {
  font-size: var(--font-size-sm);
  color: var(--color-text);
  line-height: 1.4;
}

.scheduling-preview {
  background: var(--color-background);
  border-radius: var(--radius-base);
  padding: var(--space-16);
}

.scheduling-preview h4 {
  margin: 0 0 var(--space-16) 0;
  color: var(--color-text);
}

.schedule-options {
  display: flex;
  flex-direction: column;
  gap: var(--space-8);
}

.time-slot {
  padding: var(--space-12);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-base);
  cursor: pointer;
  transition: all var(--duration-fast) var(--ease-standard);
}

.time-slot:hover {
  background: var(--color-secondary);
  border-color: var(--color-primary);
}

.slot-header {
  display: flex;
  align-items: center;
  gap: var(--space-8);
  margin-bottom: var(--space-4);
}

.slot-performance {
  margin-left: auto;
  font-size: var(--font-size-xs);
  padding: var(--space-2) var(--space-6);
  border-radius: var(--radius-sm);
  background: var(--color-bg-3);
  color: var(--color-success);
}

.slot-times {
  font-size: var(--font-size-xs);
  color: var(--color-text-secondary);
}

/* Smart Scheduler */
.scheduler-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-24);
}

.scheduler-header h3 {
  margin: 0;
  color: var(--color-text);
}

.calendar-controls {
  display: flex;
  align-items: center;
  gap: var(--space-12);
}

.month-display {
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
  min-width: 180px;
  text-align: center;
}

.timezone-info {
  display: flex;
  align-items: center;
  gap: var(--space-6);
  padding: var(--space-6) var(--space-12);
  background: var(--color-bg-1);
  border-radius: var(--radius-base);
  font-size: var(--font-size-sm);
  color: var(--color-primary);
}

.scheduling-insights {
  margin-bottom: var(--space-24);
}

.insight-card {
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-card-border);
  padding: var(--space-20);
  box-shadow: var(--shadow-sm);
}

.insight-card h4 {
  margin: 0 0 var(--space-16) 0;
  color: var(--color-text);
}

.insights-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--space-16);
}

.insight {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.insight-label {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.insight-value {
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
}

.calendar-grid {
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-card-border);
  overflow: hidden;
}

.calendar-header {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  background: var(--color-secondary);
}

.calendar-day-header {
  padding: var(--space-12);
  text-align: center;
  font-weight: var(--font-weight-medium);
  font-size: var(--font-size-sm);
  color: var(--color-text);
}

.calendar-body {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
}

.calendar-day {
  min-height: 120px;
  border-right: 1px solid var(--color-card-border-inner);
  border-bottom: 1px solid var(--color-card-border-inner);
  padding: var(--space-8);
  position: relative;
}

.calendar-day:nth-child(7n) {
  border-right: none;
}

.calendar-day.other-month {
  background: var(--color-background);
  color: var(--color-text-secondary);
}

.calendar-day.today {
  background: var(--color-bg-1);
}

.day-number {
  font-weight: var(--font-weight-medium);
  margin-bottom: var(--space-8);
}

.scheduled-posts {
  display: flex;
  flex-direction: column;
  gap: var(--space-4);
}

.scheduled-post {
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
  padding: var(--space-4) var(--space-6);
  border-radius: var(--radius-sm);
  font-size: var(--font-size-xs);
  cursor: pointer;
  transition: all var(--duration-fast) var(--ease-standard);
}

.scheduled-post:hover {
  background: var(--color-primary-hover);
}

/* Enhanced Analytics */
.analytics-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-24);
}

.analytics-header h3 {
  margin: 0;
  color: var(--color-text);
}

.analytics-controls {
  display: flex;
  gap: var(--space-12);
}

.analytics-overview {
  margin-bottom: var(--space-32);
}

.metric-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: var(--space-20);
}

.metric-card {
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-card-border);
  padding: var(--space-20);
  box-shadow: var(--shadow-sm);
  transition: all var(--duration-fast) var(--ease-standard);
}

.metric-card:hover {
  box-shadow: var(--shadow-md);
  transform: translateY(-2px);
}

.metric-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-12);
}

.metric-header h4 {
  margin: 0;
  color: var(--color-text);
  font-size: var(--font-size-base);
}

.metric-header i {
  font-size: var(--font-size-lg);
  color: var(--color-primary);
}

.metric-value {
  font-size: var(--font-size-3xl);
  font-weight: var(--font-weight-bold);
  color: var(--color-text);
  margin-bottom: var(--space-8);
}

.metric-change {
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
}

.metric-change.positive {
  color: var(--color-success);
}

.metric-change.negative {
  color: var(--color-error);
}

.analytics-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-24);
  margin-bottom: var(--space-32);
}

.analytics-card {
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-card-border);
  box-shadow: var(--shadow-sm);
  overflow: hidden;
}

.analytics-card h4 {
  padding: var(--space-20);
  margin: 0;
  border-bottom: 1px solid var(--color-card-border-inner);
  color: var(--color-text);
}

.detailed-analytics {
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-card-border);
  overflow: hidden;
}

.detailed-analytics h4 {
  padding: var(--space-20);
  margin: 0;
  border-bottom: 1px solid var(--color-card-border-inner);
  color: var(--color-text);
}

.metrics-table {
  padding: var(--space-20);
}

/* Enhanced Settings */
.settings-container {
  display: grid;
  grid-template-columns: 220px 1fr;
  gap: var(--space-32);
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-card-border);
  overflow: hidden;
}

.settings-nav {
  background: var(--color-background);
  border-right: 1px solid var(--color-card-border-inner);
}

.settings-nav ul {
  list-style: none;
  padding: var(--space-16) 0;
  margin: 0;
}

.settings-nav li {
  margin-bottom: var(--space-4);
}

.settings-tab {
  display: block;
  padding: var(--space-12) var(--space-16);
  color: var(--color-text-secondary);
  text-decoration: none;
  transition: all var(--duration-fast) var(--ease-standard);
  border-radius: var(--radius-base);
  margin: 0 var(--space-8);
  font-size: var(--font-size-sm);
}

.settings-tab:hover {
  background: var(--color-secondary);
  color: var(--color-text);
}

.settings-tab.active {
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
}

.settings-content {
  padding: var(--space-24);
}

.settings-panel {
  display: none;
}

.settings-panel.active {
  display: block;
}

.settings-panel h4 {
  margin: 0 0 var(--space-24) 0;
  color: var(--color-text);
}

.time-slots-config {
  margin-top: var(--space-24);
}

.time-slots-config h5 {
  margin: 0 0 var(--space-16) 0;
  color: var(--color-text);
}

.slots-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--space-16);
}

.slot-config {
  display: flex;
  flex-direction: column;
  gap: var(--space-8);
}

.slot-config label {
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
}

.checkbox-group {
  display: flex;
  flex-direction: column;
  gap: var(--space-12);
}

.checkbox-label {
  display: flex;
  align-items: center;
  gap: var(--space-8);
  cursor: pointer;
  color: var(--color-text);
}

.integration-status {
  display: flex;
  flex-direction: column;
  gap: var(--space-16);
}

.integration-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-16);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-base);
  gap: var(--space-16);
}

.integration-info {
  display: flex;
  align-items: center;
  gap: var(--space-12);
}

.integration-info i {
  font-size: var(--font-size-lg);
  width: 24px;
  text-align: center;
}

.security-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: var(--space-20);
}

.security-item {
  padding: var(--space-20);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-base);
}

.security-item h5 {
  margin: 0 0 var(--space-8) 0;
  color: var(--color-text);
}

.security-item p {
  margin: 0 0 var(--space-16) 0;
  color: var(--color-text-secondary);
  font-size: var(--font-size-sm);
}

.ai-features-grid {
  display: flex;
  flex-direction: column;
  gap: var(--space-20);
}

.ai-feature {
  padding: var(--space-20);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-base);
}

.feature-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-8);
}

.feature-header h5 {
  margin: 0;
  color: var(--color-text);
}

.switch {
  position: relative;
  display: inline-block;
  width: 44px;
  height: 24px;
}

.switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: var(--color-secondary);
  transition: var(--duration-fast);
  border-radius: 24px;
}

.slider:before {
  position: absolute;
  content: "";
  height: 18px;
  width: 18px;
  left: 3px;
  bottom: 3px;
  background-color: white;
  transition: var(--duration-fast);
  border-radius: 50%;
}

input:checked + .slider {
  background-color: var(--color-primary);
}

input:checked + .slider:before {
  transform: translateX(20px);
}

.ai-feature p {
  margin: 0;
  color: var(--color-text-secondary);
  font-size: var(--font-size-sm);
}

/* Modals */
.modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 10000;
  display: flex;
  align-items: center;
  justify-content: center;
}

.modal.hidden {
  display: none;
}

.modal-backdrop {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(4px);
}

.modal-content {
  position: relative;
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-lg);
  width: 100%;
  max-width: 600px;
  margin: var(--space-16);
  max-height: calc(100vh - 32px);
  overflow-y: auto;
}

.modal-header {
  padding: var(--space-20);
  border-bottom: 1px solid var(--color-card-border-inner);
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.modal-header h3 {
  margin: 0;
  color: var(--color-text);
}

.modal-close {
  background: none;
  border: none;
  color: var(--color-text-secondary);
  font-size: var(--font-size-lg);
  cursor: pointer;
  padding: var(--space-4);
  border-radius: var(--radius-sm);
  transition: all var(--duration-fast) var(--ease-standard);
}

.modal-close:hover {
  background: var(--color-secondary);
  color: var(--color-text);
}

.modal-body {
  padding: var(--space-20);
}

.modal-actions {
  display: flex;
  gap: var(--space-12);
  justify-content: flex-end;
  margin-top: var(--space-24);
}

.platform-options {
  display: flex;
  flex-direction: column;
  gap: var(--space-16);
}

.platform-option {
  display: flex;
  align-items: center;
  gap: var(--space-16);
  padding: var(--space-16);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-base);
  transition: all var(--duration-fast) var(--ease-standard);
}

.platform-option:hover {
  background: var(--color-secondary);
}

.platform-option i {
  font-size: var(--font-size-2xl);
  width: 40px;
  text-align: center;
}

.platform-info {
  flex: 1;
}

.platform-info h4 {
  margin: 0 0 var(--space-4) 0;
  color: var(--color-text);
}

.platform-info p {
  margin: 0;
  color: var(--color-text-secondary);
  font-size: var(--font-size-sm);
}

.schedule-type-selector {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-16);
  margin-bottom: var(--space-24);
}

.schedule-option {
  padding: var(--space-20);
  border: 2px solid var(--color-border);
  border-radius: var(--radius-base);
  text-align: center;
  cursor: pointer;
  transition: all var(--duration-fast) var(--ease-standard);
}

.schedule-option:hover {
  border-color: var(--color-primary);
  background: var(--color-secondary);
}

.schedule-option.active {
  border-color: var(--color-primary);
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
}

.schedule-option i {
  font-size: var(--font-size-2xl);
  margin-bottom: var(--space-12);
}

.schedule-option h4 {
  margin: 0 0 var(--space-8) 0;
}

.schedule-option p {
  margin: 0;
  font-size: var(--font-size-sm);
  opacity: 0.8;
}

.schedule-options {
  margin-bottom: var(--space-16);
}

.schedule-options.hidden {
  display: none;
}

/* Toast Notifications */
.toast-container {
  position: fixed;
  top: var(--space-24);
  right: var(--space-24);
  z-index: 10001;
  display: flex;
  flex-direction: column;
  gap: var(--space-12);
}

.toast {
  background: var(--color-surface);
  border: 1px solid var(--color-card-border);
  border-radius: var(--radius-base);
  padding: var(--space-16);
  box-shadow: var(--shadow-md);
  max-width: 400px;
  display: flex;
  align-items: center;
  gap: var(--space-12);
  animation: slideIn 0.3s var(--ease-standard);
}

.toast.success {
  border-left: 4px solid var(--color-success);
}

.toast.error {
  border-left: 4px solid var(--color-error);
}

.toast.warning {
  border-left: 4px solid var(--color-warning);
}

.toast.info {
  border-left: 4px solid var(--color-info);
}

@keyframes slideIn {
  from {
    transform: translateX(100%);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

.toast-content {
  flex: 1;
}

.toast-title {
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
  margin: 0 0 var(--space-4) 0;
}

.toast-message {
  color: var(--color-text-secondary);
  font-size: var(--font-size-sm);
  margin: 0;
}

.toast-close {
  background: none;
  border: none;
  color: var(--color-text-secondary);
  cursor: pointer;
  padding: var(--space-2);
}

/* Floating Action Button */
.fab {
  position: fixed;
  bottom: var(--space-24);
  right: var(--space-24);
  width: 56px;
  height: 56px;
  border-radius: 50%;
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
  border: none;
  box-shadow: var(--shadow-lg);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: var(--font-size-xl);
  z-index: 1000;
  transition: all var(--duration-fast) var(--ease-standard);
}

.fab:hover {
  background: var(--color-primary-hover);
  box-shadow: var(--shadow-md);
  transform: scale(1.05);
}

.fab.hidden {
  display: none;
}

/* Empty States */
.empty-state {
  text-align: center;
  padding: var(--space-32);
  color: var(--color-text-secondary);
}

.empty-state i {
  font-size: var(--font-size-4xl);
  margin-bottom: var(--space-16);
  color: var(--color-text-secondary);
}

.empty-state h4 {
  margin: 0 0 var(--space-8) 0;
  color: var(--color-text);
}

.empty-state p {
  margin: 0 0 var(--space-16) 0;
}

/* Drafts Section */
.drafts-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-24);
}

.drafts-header h3 {
  margin: 0;
  color: var(--color-text);
}

.drafts-actions {
  display: flex;
  gap: var(--space-12);
}

.drafts-list {
  display: grid;
  gap: var(--space-16);
}

.draft-item {
  background: var(--color-surface);
  border: 1px solid var(--color-card-border);
  border-radius: var(--radius-lg);
  padding: var(--space-20);
  display: flex;
  gap: var(--space-16);
  box-shadow: var(--shadow-sm);
  transition: all var(--duration-fast) var(--ease-standard);
}

.draft-item:hover {
  box-shadow: var(--shadow-md);
}

.draft-checkbox {
  margin-top: var(--space-4);
}

.draft-content {
  flex: 1;
}

.draft-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-12);
}

.draft-platforms {
  display: flex;
  gap: var(--space-8);
}

.draft-platform {
  padding: var(--space-2) var(--space-6);
  border-radius: var(--radius-sm);
  font-size: var(--font-size-xs);
  color: white;
  display: flex;
  align-items: center;
  gap: var(--space-4);
}

.draft-text {
  color: var(--color-text);
  margin-bottom: var(--space-12);
  line-height: 1.4;
}

.draft-meta {
  display: flex;
  align-items: center;
  gap: var(--space-16);
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.draft-actions {
  display: flex;
  flex-direction: column;
  gap: var(--space-8);
}

/* Responsive Design */
@media (max-width: 768px) {
  .main-app {
    grid-template-columns: 1fr;
  }
  
  .sidebar {
    position: fixed;
    top: 0;
    left: 0;
    height: 100vh;
    z-index: 1001;
    transform: translateX(-100%);
    transition: transform var(--duration-normal) var(--ease-standard);
  }
  
  .sidebar.open {
    transform: translateX(0);
  }
  
  .main-content {
    grid-column: 1;
  }
  
  .dashboard-grid {
    grid-template-columns: 1fr;
  }
  
  .composer-content {
    grid-template-columns: 1fr;
  }
  
  .composer-sidebar {
    border-left: none;
    border-top: 1px solid var(--color-card-border-inner);
    padding-left: 0;
    padding-top: var(--space-20);
  }
  
  .analytics-grid {
    grid-template-columns: 1fr;
  }
  
  .settings-container {
    grid-template-columns: 1fr;
  }
  
  .settings-nav {
    border-right: none;
    border-bottom: 1px solid var(--color-card-border-inner);
  }
  
  .settings-nav ul {
    display: flex;
    overflow-x: auto;
    padding: var(--space-8) var(--space-16);
  }
  
  .settings-nav li {
    margin-right: var(--space-8);
    margin-bottom: 0;
    white-space: nowrap;
  }
  
  .toast-container {
    top: var(--space-16);
    right: var(--space-16);
    left: var(--space-16);
  }
  
  .toast {
    max-width: none;
  }
  
  .import-options {
    grid-template-columns: 1fr;
  }
  
  .schedule-type-selector {
    grid-template-columns: 1fr;
  }
  
  .metric-cards {
    grid-template-columns: 1fr;
  }
  
  .insights-grid {
    grid-template-columns: 1fr;
  }
}

@media (max-width: 480px) {
  .content-wrapper {
    padding: var(--space-16);
  }
  
  .stats-grid {
    grid-template-columns: 1fr;
  }
  
  .header-right {
    gap: var(--space-8);
  }
  
  .composer-actions {
    flex-direction: column;
    gap: var(--space-8);
  }
  
  .modal-content {
    margin: var(--space-8);
  }
  
  .platform-checkboxes {
    flex-direction: column;
  }
  
  .columns-grid {
    flex-direction: column;
  }
  
  .template-options {
    flex-direction: column;
  }
  
  .calendar-controls {
    flex-wrap: wrap;
    gap: var(--space-8);
  }
  
  .insights-grid {
    grid-template-columns: 1fr;
  }
}

/* Focus and accessibility */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* Print styles */
@media print {
  .sidebar,
  .app-header,
  .fab,
  .toast-container,
  .modal {
    display: none !important;
  }
  
  .main-app {
    grid-template-columns: 1fr;
  }
  
  .content-wrapper {
    padding: 0;
  }
}
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>Loading SocialHub Pro v8.5...</p>
            <div class="loading-features">
                <div class="feature-item">✓ AI-Powered Scheduling</div>
                <div class="feature-item">✓ Dubai Timezone Support</div>
                <div class="feature-item">✓ Bulk Import (1000+ posts)</div>
                <div class="feature-item">✓ Multi-Platform Integration</div>
            </div>
        </div>
    </div>

    <!-- Login Screen -->
    <div id="loginScreen" class="login-screen">
        <div class="login-container">
            <div class="login-header">
                <i class="fas fa-rocket"></i>
                <h1>SocialHub Pro v8.5</h1>
                <p>Advanced Social Media Management Platform</p>
                <div class="version-badge">Professional Edition</div>
            </div>
            <div class="login-form">
                <button id="googleSignIn" class="btn btn--primary btn--full-width">
                    <i class="fab fa-google"></i>
                    Sign in with Google
                </button>
                <div class="login-features">
                    <div class="feature">
                        <i class="fas fa-brain"></i>
                        <span>AI-Powered Content Suggestions</span>
                    </div>
                    <div class="feature">
                        <i class="fas fa-globe-asia"></i>
                        <span>Dubai Timezone Optimization</span>
                    </div>
                    <div class="feature">
                        <i class="fas fa-upload"></i>
                        <span>Bulk Import (1000+ Posts)</span>
                    </div>
                    <div class="feature">
                        <i class="fas fa-shield-alt"></i>
                        <span>Enterprise Security</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="main-app hidden">
        <!-- Sidebar -->
        <aside id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-rocket"></i>
                    <span class="logo-text">SocialHub Pro</span>
                    <span class="version-tag">v8.5</span>
                </div>
                <button id="sidebarToggle" class="sidebar-toggle">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
            
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="#" data-section="dashboard" class="nav-link active">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a></li>
                    <li><a href="#" data-section="bulk-import" class="nav-link">
                        <i class="fas fa-file-upload"></i>
                        <span>Bulk Import</span>
                    </a></li>
                    <li><a href="#" data-section="accounts" class="nav-link">
                        <i class="fas fa-users"></i>
                        <span>Accounts</span>
                    </a></li>
                    <li><a href="#" data-section="composer" class="nav-link">
                        <i class="fas fa-edit"></i>
                        <span>Post Composer</span>
                    </a></li>
                    <li><a href="#" data-section="scheduler" class="nav-link">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Smart Scheduler</span>
                    </a></li>
                    <li><a href="#" data-section="analytics" class="nav-link">
                        <i class="fas fa-chart-line"></i>
                        <span>Analytics Pro</span>
                    </a></li>
                    <li><a href="#" data-section="drafts" class="nav-link">
                        <i class="fas fa-file-alt"></i>
                        <span>Drafts</span>
                    </a></li>
                    <li><a href="#" data-section="settings" class="nav-link">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </a></li>
                </ul>
            </nav>

            <div class="sidebar-footer">
                <div class="user-profile">
                    <img id="userAvatar" src="" alt="User Avatar" class="user-avatar">
                    <div class="user-info">
                        <span id="userName" class="user-name"></span>
                        <span id="userRole" class="user-role"></span>
                    </div>
                </div>
                <button id="signOut" class="btn btn--outline btn--sm">
                    <i class="fas fa-sign-out-alt"></i>
                    Sign Out
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="app-header">
                <div class="header-left">
                    <h2 id="sectionTitle">Dashboard</h2>
                    <div class="breadcrumb">
                        <span id="breadcrumbPath">Home / Dashboard</span>
                    </div>
                </div>
                <div class="header-right">
                    <div class="sync-status">
                        <i id="syncIcon" class="fas fa-sync-alt"></i>
                        <span id="syncText">Synced</span>
                    </div>
                    <button id="themeToggle" class="btn btn--outline btn--sm">
                        <i class="fas fa-moon"></i>
                    </button>
                    <button id="refreshBtn" class="btn btn--outline btn--sm">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                    <button id="quickPostBtn" class="btn btn--primary btn--sm">
                        <i class="fas fa-plus"></i>
                        Quick Post
                    </button>
                </div>
            </header>

            <!-- Content Sections -->
            <div class="content-wrapper">
                <!-- Dashboard Section -->
                <section id="dashboardSection" class="content-section active">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon" style="background: var(--color-bg-1);">
                                <i class="fas fa-edit"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="totalPosts">0</h3>
                                <p>Total Posts</p>
                                <span class="stat-change positive" id="postsChange">+0% this week</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon" style="background: var(--color-bg-4);">
                                <i class="fas fa-heart"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="totalEngagement">0</h3>
                                <p>Total Engagement</p>
                                <span class="stat-change positive" id="engagementChange">+0% this week</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon" style="background: var(--color-bg-3);">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="totalReach">0</h3>
                                <p>Total Reach</p>
                                <span class="stat-change positive" id="reachChange">+0% this week</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon" style="background: var(--color-bg-6);">
                                <i class="fas fa-calendar-alt"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="scheduledPosts">0</h3>
                                <p>Scheduled Posts</p>
                                <span class="stat-change neutral" id="nextScheduled">No posts scheduled</span>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-grid">
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3>Real-time Activity Feed</h3>
                                <div class="activity-controls">
                                    <button class="btn btn--outline btn--sm">
                                        <i class="fas fa-filter"></i>
                                        Filter
                                    </button>
                                    <button class="btn btn--outline btn--sm">View All</button>
                                </div>
                            </div>
                            <div id="recentActivity" class="activity-list">
                                <!-- Activity items will be populated by JavaScript -->
                            </div>
                        </div>

                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3>Performance Analytics</h3>
                                <div class="chart-controls">
                                    <select id="chartPeriod" class="form-control">
                                        <option value="7">Last 7 days</option>
                                        <option value="30">Last 30 days</option>
                                        <option value="90">Last 90 days</option>
                                    </select>
                                </div>
                            </div>
                            <div class="chart-container" style="position: relative; height: 300px;">
                                <canvas id="engagementChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <div class="ai-insights-section">
                        <div class="ai-insights-card">
                            <div class="card-header">
                                <h3><i class="fas fa-brain"></i> AI Content Insights</h3>
                                <span class="status status--success">Active</span>
                            </div>
                            <div class="insights-grid">
                                <div class="insight-item">
                                    <div class="insight-icon" style="background: var(--color-bg-5);">
                                        <i class="fas fa-clock"></i>
                                    </div>
                                    <div class="insight-content">
                                        <h4>Optimal Posting Time</h4>
                                        <p id="optimalTimeInsight">Analyzing your audience activity patterns...</p>
                                    </div>
                                </div>
                                <div class="insight-item">
                                    <div class="insight-icon" style="background: var(--color-bg-2);">
                                        <i class="fas fa-hashtag"></i>
                                    </div>
                                    <div class="insight-content">
                                        <h4>Trending Hashtags</h4>
                                        <p id="hashtagInsight">Loading trending hashtags...</p>
                                    </div>
                                </div>
                                <div class="insight-item">
                                    <div class="insight-icon" style="background: var(--color-bg-7);">
                                        <i class="fas fa-image"></i>
                                    </div>
                                    <div class="insight-content">
                                        <h4>Content Type Recommendation</h4>
                                        <p id="contentTypeInsight">Analyzing content performance...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Bulk Import Section -->
                <section id="bulk-importSection" class="content-section">
                    <div class="bulk-import-header">
                        <h3>Bulk Content Import</h3>
                        <div class="import-stats">
                            <span class="stat">Capacity: 1,000 posts</span>
                            <span class="stat">Formats: CSV, JSON</span>
                            <span class="stat">Auto-validation enabled</span>
                        </div>
                    </div>

                    <div class="import-section">
                        <div class="import-options">
                            <div class="import-method active" data-method="csv">
                                <i class="fas fa-file-csv"></i>
                                <h4>CSV Import</h4>
                                <p>Upload CSV file with structured data</p>
                            </div>
                            <div class="import-method" data-method="json">
                                <i class="fas fa-file-code"></i>
                                <h4>JSON Import</h4>
                                <p>Upload JSON file with post data</p>
                            </div>
                        </div>

                        <div class="import-dropzone" id="importDropzone">
                            <div class="dropzone-content">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <h3>Drop your file here or click to browse</h3>
                                <p>Supports CSV and JSON files up to 50MB</p>
                                <input type="file" id="importFileInput" accept=".csv,.json" hidden>
                                <div class="file-requirements">
                                    <h4>Required columns:</h4>
                                    <div class="columns-grid">
                                        <span class="column-tag">socialTitle</span>
                                        <span class="column-tag">socialDescription</span>
                                        <span class="column-tag">shortUrl</span>
                                        <span class="column-tag">linkType</span>
                                        <span class="column-tag">socialImage</span>
                                        <span class="column-tag">targetPlatform</span>
                                        <span class="column-tag">contentCategory</span>
                                        <span class="column-tag">postingSchedule</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="importPreview" class="import-preview hidden">
                            <div class="preview-header">
                                <h4>Import Preview</h4>
                                <div class="preview-stats">
                                    <span id="previewCount">0 posts</span>
                                    <span id="validationStatus" class="status status--info">Validating...</span>
                                </div>
                            </div>
                            <div id="previewTable" class="preview-table">
                                <!-- Preview table will be populated by JavaScript -->
                            </div>
                            <div class="import-actions">
                                <button id="cancelImport" class="btn btn--outline">Cancel</button>
                                <button id="validateImport" class="btn btn--secondary">
                                    <i class="fas fa-check-circle"></i>
                                    Validate Data
                                </button>
                                <button id="processImport" class="btn btn--primary" disabled>
                                    <i class="fas fa-upload"></i>
                                    Import Posts
                                </button>
                            </div>
                        </div>

                        <div id="importProgress" class="import-progress hidden">
                            <div class="progress-header">
                                <h4>Processing Import...</h4>
                                <span id="progressText">0 of 0 posts processed</span>
                            </div>
                            <div class="progress-bar">
                                <div id="progressFill" class="progress-fill"></div>
                            </div>
                            <div id="importLog" class="import-log">
                                <!-- Import progress will be logged here -->
                            </div>
                        </div>
                    </div>

                    <div class="import-templates">
                        <h4>Download Templates</h4>
                        <div class="template-options">
                            <button id="downloadCSVTemplate" class="btn btn--outline">
                                <i class="fas fa-download"></i>
                                CSV Template
                            </button>
                            <button id="downloadJSONTemplate" class="btn btn--outline">
                                <i class="fas fa-download"></i>
                                JSON Template
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Accounts Section -->
                <section id="accountsSection" class="content-section">
                    <div class="section-header">
                        <h3>Connected Accounts</h3>
                        <div class="accounts-stats">
                            <span class="stat">Facebook: <strong id="facebookAccounts">0/10</strong> accounts</span>
                            <span class="stat">Instagram: <strong id="instagramAccounts">0/5</strong> accounts</span>
                        </div>
                        <button id="addAccountBtn" class="btn btn--primary">
                            <i class="fas fa-plus"></i>
                            Connect Account
                        </button>
                    </div>
                    <div id="accountsList" class="accounts-grid">
                        <!-- Accounts will be populated by JavaScript -->
                    </div>
                </section>

                <!-- Post Composer Section -->
                <section id="composerSection" class="content-section">
                    <div class="composer-container">
                        <div class="composer-header">
                            <h3>AI-Powered Post Composer</h3>
                            <div class="composer-actions">
                                <button id="aiSuggestBtn" class="btn btn--secondary">
                                    <i class="fas fa-brain"></i>
                                    AI Suggest
                                </button>
                                <button id="saveDraftBtn" class="btn btn--outline">
                                    <i class="fas fa-save"></i>
                                    Save Draft
                                </button>
                                <button id="schedulePostBtn" class="btn btn--secondary">
                                    <i class="fas fa-clock"></i>
                                    Smart Schedule
                                </button>
                                <button id="publishNowBtn" class="btn btn--primary">
                                    <i class="fas fa-share"></i>
                                    Publish Now
                                </button>
                            </div>
                        </div>

                        <div class="composer-content">
                            <div class="composer-main">
                                <div class="platform-selector">
                                    <label class="form-label">Select Platforms</label>
                                    <div id="platformCheckboxes" class="platform-checkboxes">
                                        <!-- Platform checkboxes will be populated by JavaScript -->
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="contentCategory" class="form-label">Content Category</label>
                                    <select id="contentCategory" class="form-control">
                                        <option value="">Select category...</option>
                                        <option value="series">Series</option>
                                        <option value="movie">Movie</option>
                                        <option value="match">Match</option>
                                        <option value="recipe">Recipe</option>
                                        <option value="game">Game</option>
                                        <option value="app">App</option>
                                        <option value="channel">Channel</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="postContent" class="form-label">Content</label>
                                    <textarea id="postContent" class="form-control" rows="6" placeholder="What's happening? (AI suggestions available)"></textarea>
                                    <div class="composer-tools">
                                        <div class="character-counter">
                                            <span id="characterCount">0</span> / <span id="characterLimit">280</span>
                                        </div>
                                        <div class="ai-tools">
                                            <button id="aiEnhanceBtn" class="btn btn--outline btn--sm">
                                                <i class="fas fa-magic"></i>
                                                Enhance
                                            </button>
                                            <button id="aiHashtagBtn" class="btn btn--outline btn--sm">
                                                <i class="fas fa-hashtag"></i>
                                                Add Hashtags
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="shortUrl" class="form-label">Short URL (Optional)</label>
                                    <input type="url" id="shortUrl" class="form-control" placeholder="https://short.ly/example">
                                </div>

                                <div class="media-upload-section">
                                    <label class="form-label">Media</label>
                                    <div id="mediaDropzone" class="media-dropzone">
                                        <div class="dropzone-content">
                                            <i class="fas fa-cloud-upload-alt"></i>
                                            <p>Drag & drop media here or click to upload</p>
                                            <input type="file" id="mediaInput" accept="image/*,video/*" multiple hidden>
                                        </div>
                                    </div>
                                    <div id="mediaPreview" class="media-preview">
                                        <!-- Media previews will be shown here -->
                                    </div>
                                </div>
                            </div>

                            <div class="composer-sidebar">
                                <div class="post-preview">
                                    <h4>Platform Preview</h4>
                                    <div id="postPreview" class="preview-content">
                                        <div class="preview-platform facebook">
                                            <div class="platform-header">
                                                <i class="fab fa-facebook"></i>
                                                <span>Facebook</span>
                                            </div>
                                            <div class="preview-post">
                                                <div class="preview-text">Your post content will appear here...</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="scheduling-preview">
                                    <h4>Smart Scheduling</h4>
                                    <div class="schedule-options">
                                        <div class="time-slot" data-slot="morning">
                                            <div class="slot-header">
                                                <i class="fas fa-sun"></i>
                                                <span>Morning</span>
                                                <span class="slot-performance">High engagement</span>
                                            </div>
                                            <div class="slot-times">9:30 AM, 10:05 AM, 10:55 AM</div>
                                        </div>
                                        <div class="time-slot" data-slot="noon">
                                            <div class="slot-header">
                                                <i class="fas fa-sun"></i>
                                                <span>Afternoon</span>
                                                <span class="slot-performance">Medium engagement</span>
                                            </div>
                                            <div class="slot-times">12:45 PM, 1:15 PM, 1:05 PM</div>
                                        </div>
                                        <div class="time-slot" data-slot="evening">
                                            <div class="slot-header">
                                                <i class="fas fa-moon"></i>
                                                <span>Evening</span>
                                                <span class="slot-performance">Very high engagement</span>
                                            </div>
                                            <div class="slot-times">4:30 PM, 5:17 PM, 6:34 PM</div>
                                        </div>
                                        <div class="time-slot" data-slot="night">
                                            <div class="slot-header">
                                                <i class="fas fa-moon"></i>
                                                <span>Night</span>
                                                <span class="slot-performance">High engagement</span>
                                            </div>
                                            <div class="slot-times">8:30 PM, 10:45 PM, 11:15 PM</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Smart Scheduler Section -->
                <section id="schedulerSection" class="content-section">
                    <div class="scheduler-header">
                        <h3>Smart Content Calendar - Dubai Timezone</h3>
                        <div class="calendar-controls">
                            <button id="prevMonth" class="btn btn--outline btn--sm">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <span id="currentMonth" class="month-display"></span>
                            <button id="nextMonth" class="btn btn--outline btn--sm">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                            <button id="todayBtn" class="btn btn--outline btn--sm">Today</button>
                            <div class="timezone-info">
                                <i class="fas fa-globe"></i>
                                <span>Dubai Time (GMT+4)</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="scheduling-insights">
                        <div class="insight-card">
                            <h4>Optimal Scheduling Insights</h4>
                            <div class="insights-grid">
                                <div class="insight">
                                    <span class="insight-label">Peak Engagement:</span>
                                    <span class="insight-value">Evening (4:30-6:34 PM)</span>
                                </div>
                                <div class="insight">
                                    <span class="insight-label">Best Days:</span>
                                    <span class="insight-value">Tuesday, Thursday, Sunday</span>
                                </div>
                                <div class="insight">
                                    <span class="insight-label">Content Frequency:</span>
                                    <span class="insight-value">4-6 posts per day optimal</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="calendar" class="calendar-grid">
                        <!-- Calendar will be populated by JavaScript -->
                    </div>
                </section>

                <!-- Analytics Pro Section -->
                <section id="analyticsSection" class="content-section">
                    <div class="analytics-header">
                        <h3>Analytics Pro Dashboard</h3>
                        <div class="analytics-controls">
                            <select id="analyticsTimeframe" class="form-control">
                                <option value="7">Last 7 days</option>
                                <option value="30">Last 30 days</option>
                                <option value="90">Last 90 days</option>
                            </select>
                            <button id="exportAnalytics" class="btn btn--outline btn--sm">
                                <i class="fas fa-download"></i>
                                Export Report
                            </button>
                        </div>
                    </div>

                    <div class="analytics-overview">
                        <div class="metric-cards">
                            <div class="metric-card">
                                <div class="metric-header">
                                    <h4>Engagement Rate</h4>
                                    <i class="fas fa-heart"></i>
                                </div>
                                <div class="metric-value" id="engagementRate">0%</div>
                                <div class="metric-change positive" id="engagementRateChange">+0% from last period</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-header">
                                    <h4>Click Through Rate</h4>
                                    <i class="fas fa-mouse-pointer"></i>
                                </div>
                                <div class="metric-value" id="clickThroughRate">0%</div>
                                <div class="metric-change positive" id="clickThroughRateChange">+0% from last period</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-header">
                                    <h4>Success Rate</h4>
                                    <i class="fas fa-check-circle"></i>
                                </div>
                                <div class="metric-value" id="successRate">0%</div>
                                <div class="metric-change positive" id="successRateChange">+0% from last period</div>
                            </div>
                        </div>
                    </div>

                    <div class="analytics-grid">
                        <div class="analytics-card">
                            <h4>Post Performance Trends</h4>
                            <div class="chart-container" style="position: relative; height: 300px;">
                                <canvas id="postPerformanceChart"></canvas>
                            </div>
                        </div>
                        <div class="analytics-card">
                            <h4>Platform Distribution</h4>
                            <div class="chart-container" style="position: relative; height: 300px;">
                                <canvas id="platformChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <div class="detailed-analytics">
                        <h4>Detailed Performance Metrics</h4>
                        <div id="detailedMetrics" class="metrics-table">
                            <!-- Detailed metrics will be populated by JavaScript -->
                        </div>
                    </div>
                </section>

                <!-- Drafts Section -->
                <section id="draftsSection" class="content-section">
                    <div class="drafts-header">
                        <h3>Draft Posts Management</h3>
                        <div class="drafts-actions">
                            <button id="bulkSchedule" class="btn btn--secondary">
                                <i class="fas fa-calendar-plus"></i>
                                Bulk Schedule
                            </button>
                            <button id="deleteDrafts" class="btn btn--outline">
                                <i class="fas fa-trash"></i>
                                Delete Selected
                            </button>
                        </div>
                    </div>
                    <div id="draftsList" class="drafts-list">
                        <!-- Drafts will be populated by JavaScript -->
                    </div>
                </section>

                <!-- Settings Section -->
                <section id="settingsSection" class="content-section">
                    <div class="settings-container">
                        <div class="settings-nav">
                            <ul>
                                <li><a href="#" data-tab="general" class="settings-tab active">General</a></li>
                                <li><a href="#" data-tab="scheduling" class="settings-tab">Smart Scheduling</a></li>
                                <li><a href="#" data-tab="notifications" class="settings-tab">Notifications</a></li>
                                <li><a href="#" data-tab="integrations" class="settings-tab">Integrations</a></li>
                                <li><a href="#" data-tab="security" class="settings-tab">Security</a></li>
                                <li><a href="#" data-tab="ai" class="settings-tab">AI Features</a></li>
                            </ul>
                        </div>
                        <div class="settings-content">
                            <div id="generalSettings" class="settings-panel active">
                                <h4>General Settings</h4>
                                <div class="form-group">
                                    <label class="form-label">User Role</label>
                                    <select id="userRole" class="form-control">
                                        <option value="main_admin">Main Admin</option>
                                        <option value="content_manager">Content Manager</option>
                                        <option value="regular_user">Regular User</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Default Post Visibility</label>
                                    <select class="form-control">
                                        <option>Public</option>
                                        <option>Friends</option>
                                        <option>Private</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Language</label>
                                    <select class="form-control">
                                        <option>English</option>
                                        <option>العربية (Arabic)</option>
                                        <option>Français</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div id="schedulingSettings" class="settings-panel">
                                <h4>Smart Scheduling Configuration</h4>
                                <div class="form-group">
                                    <label class="form-label">Primary Timezone</label>
                                    <select class="form-control">
                                        <option selected>Dubai (GMT+4)</option>
                                        <option>UTC</option>
                                        <option>EST</option>
                                        <option>PST</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Auto-Schedule Mode</label>
                                    <div class="checkbox-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" checked>
                                            Enable AI-powered optimal timing
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" checked>
                                            Use Dubai timezone preferences
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox">
                                            Avoid posting during low-engagement periods
                                        </label>
                                    </div>
                                </div>
                                <div class="time-slots-config">
                                    <h5>Custom Time Slots (Dubai Time)</h5>
                                    <div class="slots-grid">
                                        <div class="slot-config">
                                            <label>Morning</label>
                                            <input type="text" class="form-control" value="9:30, 10:05, 10:55" readonly>
                                        </div>
                                        <div class="slot-config">
                                            <label>Afternoon</label>
                                            <input type="text" class="form-control" value="12:45, 13:15, 13:05" readonly>
                                        </div>
                                        <div class="slot-config">
                                            <label>Evening</label>
                                            <input type="text" class="form-control" value="16:30, 17:17, 18:34" readonly>
                                        </div>
                                        <div class="slot-config">
                                            <label>Night</label>
                                            <input type="text" class="form-control" value="20:30, 22:45, 23:15" readonly>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="notificationSettings" class="settings-panel">
                                <h4>Notification Preferences</h4>
                                <div class="checkbox-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" checked>
                                        Email notifications for scheduled posts
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" checked>
                                        Push notifications for engagement
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" checked>
                                        Daily analytics summary
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox">
                                        Weekly performance reports
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox">
                                        AI insights and recommendations
                                    </label>
                                </div>
                            </div>
                            
                            <div id="integrationSettings" class="settings-panel">
                                <h4>Platform Integrations</h4>
                                <div class="integration-status">
                                    <div class="integration-item">
                                        <div class="integration-info">
                                            <i class="fab fa-facebook"></i>
                                            <span>Facebook API</span>
                                        </div>
                                        <span class="status status--success">Connected (10/10)</span>
                                        <button class="btn btn--outline btn--sm">Manage</button>
                                    </div>
                                    <div class="integration-item">
                                        <div class="integration-info">
                                            <i class="fab fa-instagram"></i>
                                            <span>Instagram API</span>
                                        </div>
                                        <span class="status status--success">Connected (5/5)</span>
                                        <button class="btn btn--outline btn--sm">Manage</button>
                                    </div>
                                    <div class="integration-item">
                                        <div class="integration-info">
                                            <i class="fas fa-brain"></i>
                                            <span>AI Content Engine</span>
                                        </div>
                                        <span class="status status--success">Active</span>
                                        <button class="btn btn--outline btn--sm">Configure</button>
                                    </div>
                                    <div class="integration-item">
                                        <div class="integration-info">
                                            <i class="fas fa-cloud"></i>
                                            <span>Firebase Cloud Storage</span>
                                        </div>
                                        <span class="status status--success">Connected</span>
                                        <button class="btn btn--outline btn--sm">Settings</button>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="securitySettings" class="settings-panel">
                                <h4>Security & Privacy</h4>
                                <div class="security-grid">
                                    <div class="security-item">
                                        <h5>Two-Factor Authentication</h5>
                                        <p>Add an extra layer of security to your account</p>
                                        <button class="btn btn--primary">Enable 2FA</button>
                                    </div>
                                    <div class="security-item">
                                        <h5>Data Encryption</h5>
                                        <p>AES-256 encryption for sensitive data</p>
                                        <span class="status status--success">Active</span>
                                    </div>
                                    <div class="security-item">
                                        <h5>Account Backup</h5>
                                        <p>Download a backup of your account data</p>
                                        <button class="btn btn--outline">Download Backup</button>
                                    </div>
                                    <div class="security-item">
                                        <h5>Session Management</h5>
                                        <p>View and manage active sessions</p>
                                        <button class="btn btn--outline">Manage Sessions</button>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="aiSettings" class="settings-panel">
                                <h4>AI Features Configuration</h4>
                                <div class="ai-features-grid">
                                    <div class="ai-feature">
                                        <div class="feature-header">
                                            <h5>Content Suggestions</h5>
                                            <label class="switch">
                                                <input type="checkbox" checked>
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                        <p>AI-powered content recommendations based on trends and performance</p>
                                    </div>
                                    <div class="ai-feature">
                                        <div class="feature-header">
                                            <h5>Optimal Timing</h5>
                                            <label class="switch">
                                                <input type="checkbox" checked>
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                        <p>Automatically schedule posts at optimal times for maximum engagement</p>
                                    </div>
                                    <div class="ai-feature">
                                        <div class="feature-header">
                                            <h5>Hashtag Generation</h5>
                                            <label class="switch">
                                                <input type="checkbox" checked>
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                        <p>Intelligent hashtag suggestions to improve post discoverability</p>
                                    </div>
                                    <div class="ai-feature">
                                        <div class="feature-header">
                                            <h5>Performance Analysis</h5>
                                            <label class="switch">
                                                <input type="checkbox" checked>
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                        <p>AI-driven insights and recommendations for content optimization</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <!-- Account Connection Modal -->
    <div id="accountModal" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>Connect Social Media Account</h3>
                <button class="modal-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="platform-options">
                    <div class="platform-option" data-platform="facebook">
                        <i class="fab fa-facebook"></i>
                        <div class="platform-info">
                            <h4>Facebook</h4>
                            <p>Connect your Facebook pages and profiles (10/10 slots available)</p>
                        </div>
                        <button class="btn btn--outline">Connect</button>
                    </div>
                    <div class="platform-option" data-platform="instagram">
                        <i class="fab fa-instagram"></i>
                        <div class="platform-info">
                            <h4>Instagram</h4>
                            <p>Connect your Instagram business account (5/5 slots available)</p>
                        </div>
                        <button class="btn btn--outline">Connect</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Smart Schedule Modal -->
    <div id="scheduleModal" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>Smart Schedule Post</h3>
                <button class="modal-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="schedule-type-selector">
                    <div class="schedule-option active" data-type="ai">
                        <i class="fas fa-brain"></i>
                        <h4>AI Optimal Timing</h4>
                        <p>Let AI choose the best time based on your audience</p>
                    </div>
                    <div class="schedule-option" data-type="custom">
                        <i class="fas fa-calendar-alt"></i>
                        <h4>Custom Schedule</h4>
                        <p>Choose specific date and time</p>
                    </div>
                </div>
                
                <div id="aiScheduleOptions" class="schedule-options">
                    <div class="form-group">
                        <label class="form-label">Preferred Time Slot</label>
                        <select id="aiTimeSlot" class="form-control">
                            <option value="optimal">Optimal Time (AI decides)</option>
                            <option value="morning">Morning (9:30-10:55 AM)</option>
                            <option value="noon">Afternoon (12:45-1:15 PM)</option>
                            <option value="evening">Evening (4:30-6:34 PM)</option>
                            <option value="night">Night (8:30-11:15 PM)</option>
                        </select>
                    </div>
                </div>
                
                <div id="customScheduleOptions" class="schedule-options hidden">
                    <div class="form-group">
                        <label class="form-label">Schedule Date</label>
                        <input type="date" id="scheduleDate" class="form-control">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Schedule Time (Dubai Time)</label>
                        <input type="time" id="scheduleTime" class="form-control">
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button id="cancelSchedule" class="btn btn--outline">Cancel</button>
                    <button id="confirmSchedule" class="btn btn--primary">Schedule Post</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Floating Action Button -->
    <button id="fab" class="fab hidden">
        <i class="fas fa-plus"></i>
    </button>

    <script>
    // SocialHub Pro v8.5 - Advanced Social Media Management Platform
// Updated for real Firebase Firestore integration with image URL storage

console.log('🚀 SocialHub Pro v8.5 - Application Starting...');

// Application Configuration
const CONFIG = {
    firebase: {
        apiKey: "AIzaSyBKD3QIxJdHw__UG2TEqf0TqyYCnw8wJf8",
        authDomain: "socialhub-1370d.firebaseapp.com",
        projectId: "socialhub-1370d",
        storageBucket: "socialhub-1370d.firebasestorage.app",
        messagingSenderId: "84815590328",
        appId: "1:84815590328:web:2f12340380b37c2562d54d"
    },
    version: "8.5.0",
    debug: true,
    autoSave: true,
    refreshInterval: 30000,
    demoMode: false, // Changed to false for real data
    bulkImportLimit: 1000,
    dubaiTimezone: 'Asia/Dubai',
    encryptionEnabled: true,
    aiFeatures: true,
    performanceMonitoring: true
};

// Dubai Time Slots Configuration
const DUBAI_TIME_SLOTS = {
    morning: ["09:30", "10:05", "10:55"],
    noon: ["12:45", "13:15", "13:05"], 
    evening: ["16:30", "17:17", "18:34"],
    night: ["20:30", "22:45", "23:15"]
};

// User Roles Configuration
const USER_ROLES = {
    main_admin: {
        name: "Main Admin",
        permissions: ["all"],
        description: "Full system access and management"
    },
    content_manager: {
        name: "Content Manager", 
        permissions: ["content", "scheduling", "analytics"],
        description: "Content creation and scheduling management"
    },
    regular_user: {
        name: "Regular User",
        permissions: ["view", "basic_posting"],
        description: "Basic posting and viewing capabilities"
    }
};

// Advanced Application State Management
class AppState {
    constructor() {
        console.log('📊 Initializing Advanced Application State...');
        this.state = {
            user: null,
            userRole: 'main_admin',
            currentSection: 'dashboard',
            connectedAccounts: [],
            drafts: [],
            scheduledPosts: [],
            analytics: {},
            settings: this.getDefaultSettings(),
            isOnline: navigator.onLine,
            lastSync: null,
            theme: this.getStoredTheme(),
            importData: null,
            aiInsights: {},
            performanceMetrics: {},
            securityStatus: 'active',
            bulkOperations: []
        };
        
        this.listeners = new Map();
        this.setupEventListeners();
        this.startPerformanceMonitoring();
        console.log('✅ Advanced Application State Initialized');
    }

    getDefaultSettings() {
        return {
            defaultVisibility: 'public',
            timezone: CONFIG.dubaiTimezone,
            language: 'en',
            notifications: {
                email: true,
                push: true,
                dailySummary: true,
                weeklyReports: true,
                aiInsights: true
            },
            autoSave: true,
            theme: 'auto',
            aiFeatures: {
                contentSuggestions: true,
                optimalTiming: true,
                hashtagGeneration: true,
                performanceAnalysis: true
            },
            scheduling: {
                dubaiTimezone: true,
                aiOptimization: true,
                avoidLowEngagement: true
            },
            security: {
                twoFactorAuth: false,
                encryptData: true,
                sessionTimeout: 3600000 // 1 hour
            }
        };
    }

    getStoredTheme() {
        try {
            return localStorage.getItem('theme') || 'light';
        } catch (error) {
            console.warn('⚠️ Could not access localStorage for theme:', error);
            return 'light';
        }
    }

    setupEventListeners() {
        window.addEventListener('online', () => {
            console.log('🌐 Application back online');
            this.setState({ isOnline: true });
            this.syncData();
            this.showNotification('Connection restored', 'success');
        });

        window.addEventListener('offline', () => {
            console.warn('📴 Application offline');
            this.setState({ isOnline: false });
            this.showNotification('Working offline', 'warning');
        });

        document.addEventListener('visibilitychange', () => {
            if (!document.hidden && this.state.isOnline) {
                console.log('👀 Page visible - syncing data...');
                this.syncData();
            }
        });

        if (CONFIG.performanceMonitoring) {
            this.setupPerformanceListeners();
        }
    }

    setupPerformanceListeners() {
        if ('memory' in performance) {
            setInterval(() => {
                const memory = performance.memory;
                this.state.performanceMetrics = {
                    ...this.state.performanceMetrics,
                    memoryUsage: {
                        used: Math.round(memory.usedJSHeapSize / 1048576),
                        total: Math.round(memory.totalJSHeapSize / 1048576),
                        limit: Math.round(memory.jsHeapSizeLimit / 1048576)
                    }
                };
            }, 30000);
        }

        if ('connection' in navigator) {
            const connection = navigator.connection;
            this.state.performanceMetrics.network = {
                effectiveType: connection.effectiveType,
                downlink: connection.downlink,
                rtt: connection.rtt
            };
        }
    }

    startPerformanceMonitoring() {
        if (!CONFIG.performanceMonitoring) return;
        
        console.log('📊 Starting performance monitoring...');
        setInterval(() => {
            this.collectPerformanceMetrics();
        }, 60000);
    }

    collectPerformanceMetrics() {
        const metrics = {
            timestamp: new Date().toISOString(),
            loadTime: performance.now(),
            userInteractions: this.state.performanceMetrics.userInteractions || 0,
            apiCalls: this.state.performanceMetrics.apiCalls || 0,
            errors: this.state.performanceMetrics.errors || 0
        };

        this.setState({
            performanceMetrics: {
                ...this.state.performanceMetrics,
                ...metrics
            }
        });
    }

    setState(newState) {
        console.log('🔄 Advanced State Update:', newState);
        this.state = { ...this.state, ...newState };
        this.notifyListeners();
        
        if (CONFIG.autoSave && (newState.drafts || newState.settings)) {
            this.autoSaveState();
        }
    }

    autoSaveState() {
        console.log('💾 Auto-saving application state...');
        try {
            localStorage.setItem('appState', JSON.stringify({
                settings: this.state.settings,
                theme: this.state.theme
            }));
        } catch (error) {
            console.warn('⚠️ Could not save to localStorage:', error);
        }
    }

    getState(key) {
        return key ? this.state[key] : this.state;
    }

    subscribe(key, callback) {
        if (!this.listeners.has(key)) {
            this.listeners.set(key, []);
        }
        this.listeners.get(key).push(callback);
        console.log(`📞 Subscribed to state changes for: ${key}`);
    }

    notifyListeners() {
        this.listeners.forEach((callbacks, key) => {
            callbacks.forEach(callback => {
                try {
                    callback(this.state[key], this.state);
                } catch (error) {
                    console.error(`❌ Error in state listener for ${key}:`, error);
                }
            });
        });
    }

    async syncData() {
        try {
            console.log('🔄 Starting advanced data sync...');
            this.updateSyncStatus('syncing');
            
            // Load data from Firestore
            await firebaseService.loadUserData();
            
            this.setState({ lastSync: new Date().toISOString() });
            this.updateSyncStatus('synced');
            console.log('✅ Advanced data sync completed');
        } catch (error) {
            console.error('❌ Data sync failed:', error);
            this.updateSyncStatus('error');
            this.showNotification('Sync failed - working offline', 'error');
        }
    }

    updateSyncStatus(status) {
        const syncIcon = document.getElementById('syncIcon');
        const syncText = document.getElementById('syncText');
        
        if (syncIcon && syncText) {
            syncIcon.className = status === 'syncing' ? 'fas fa-sync-alt fa-spin' : 
                               status === 'error' ? 'fas fa-exclamation-circle' : 'fas fa-check';
            syncText.textContent = status === 'syncing' ? 'Syncing...' : 
                                 status === 'error' ? 'Sync Error' : 'Synced';
            
            const syncStatus = document.querySelector('.sync-status');
            if (syncStatus) {
                syncStatus.className = `sync-status ${status}`;
            }
        }
    }

    showNotification(message, type = 'info', title = null) {
        ToastManager.show(message, type, title);
    }
}

// Enhanced Firebase Service with Real Firestore Integration
class FirebaseService {
    constructor() {
        console.log('🔥 Initializing Advanced Firebase Service...');
        this.app = null;
        this.auth = null;
        this.firestore = null;
        this.initialized = false;
        this.demoMode = CONFIG.demoMode;
        this.encryptionEnabled = CONFIG.encryptionEnabled;
    }

    async initialize() {
        try {
            console.log('🔥 Configuring Advanced Firebase...');
            
            // Initialize Firebase
            this.app = firebase.initializeApp(CONFIG.firebase);
            this.auth = firebase.auth();
            this.firestore = firebase.firestore();
            
            // Enable offline persistence
            await this.firestore.enablePersistence()
                .catch(err => {
                    console.warn('Offline persistence not supported:', err);
                });
            
            this.initialized = true;
            console.log('✅ Advanced Firebase Service Initialized');
            return true;
        } catch (error) {
            console.error('❌ Firebase initialization failed:', error);
            ToastManager.show('Firebase initialization failed', 'error');
            return false;
        }
    }

    async signInWithGoogle() {
        try {
            console.log('🔐 Starting Advanced Google Sign-In...');
            
            const signInBtn = document.getElementById('googleSignIn');
            if (signInBtn) {
                signInBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Signing in...';
                signInBtn.disabled = true;
            }
            
            const provider = new firebase.auth.GoogleAuthProvider();
            provider.addScope('profile');
            provider.addScope('email');
            
            const result = await this.auth.signInWithPopup(provider);
            await this.handleAuthSuccess(result.user);
            return result.user;
        } catch (error) {
            console.error('❌ Google Sign-In failed:', error);
            
            const signInBtn = document.getElementById('googleSignIn');
            if (signInBtn) {
                signInBtn.innerHTML = '<i class="fab fa-google"></i> Sign in with Google';
                signInBtn.disabled = false;
            }
            
            ToastManager.show('Sign-in failed: ' + error.message, 'error');
            throw error;
        }
    }

    async signOut() {
        try {
            console.log('🔐 Starting Advanced Sign Out...');
            await this.auth.signOut();
            this.handleAuthFailure();
            console.log('✅ Advanced Sign Out Successful');
        } catch (error) {
            console.error('❌ Sign Out failed:', error);
            throw error;
        }
    }

    async handleAuthSuccess(user) {
        console.log('🎉 Advanced Authentication Successful:', user.displayName);
        appState.setState({ user });
        
        // Initialize user data in Firestore if it doesn't exist
        await this.initializeUserData(user.uid);
        
        // Load user data
        await this.loadUserData(user.uid);
        
        uiManager.showMainApp();
        this.startAdvancedPeriodicSync();
        
        const userRole = appState.getState('userRole');
        const roleInfo = USER_ROLES[userRole];
        ToastManager.show(
            `Welcome back, ${user.displayName}! Role: ${roleInfo.name}`, 
            'success', 
            'Signed In'
        );
    }

    handleAuthFailure() {
        console.log('👋 Advanced User Signed Out');
        appState.setState({ 
            user: null,
            connectedAccounts: [],
            drafts: [],
            scheduledPosts: [],
            analytics: {}
        });
        uiManager.showLoginScreen();
        this.stopAdvancedPeriodicSync();
    }

    async initializeUserData(userId) {
        try {
            const userDoc = await this.firestore.collection('users').doc(userId).get();
            
            if (!userDoc.exists) {
                console.log('👤 Creating new user document...');
                await this.firestore.collection('users').doc(userId).set({
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    updatedAt: firebase.firestore.FieldValue.serverTimestamp(),
                    settings: appState.getState('settings'),
                    role: 'main_admin'
                });
            }
        } catch (error) {
            console.error('❌ Failed to initialize user data:', error);
        }
    }

    async loadUserData(userId = null) {
        try {
            if (!userId && appState.getState('user')) {
                userId = appState.getState('user').uid;
            }
            
            if (!userId) {
                console.warn('No user ID available for loading data');
                return;
            }
            
            console.log('📥 Loading user data from Firestore...');
            
            // Load user document
            const userDoc = await this.firestore.collection('users').doc(userId).get();
            if (userDoc.exists) {
                const userData = userDoc.data();
                if (userData.settings) {
                    appState.setState({ settings: userData.settings });
                }
                if (userData.role) {
                    appState.setState({ userRole: userData.role });
                }
            }
            
            // Load connected accounts
            const accountsSnapshot = await this.firestore.collection('users').doc(userId)
                .collection('accounts').get();
                
            const connectedAccounts = [];
            accountsSnapshot.forEach(doc => {
                connectedAccounts.push({ id: doc.id, ...doc.data() });
            });
            
            // Load drafts
            const draftsSnapshot = await this.firestore.collection('users').doc(userId)
                .collection('drafts').get();
                
            const drafts = [];
            draftsSnapshot.forEach(doc => {
                drafts.push({ id: doc.id, ...doc.data() });
            });
            
            // Load scheduled posts
            const scheduledSnapshot = await this.firestore.collection('users').doc(userId)
                .collection('scheduled_posts')
                .where('scheduledFor', '>=', new Date())
                .orderBy('scheduledFor', 'asc')
                .get();
                
            const scheduledPosts = [];
            scheduledSnapshot.forEach(doc => {
                scheduledPosts.push({ id: doc.id, ...doc.data() });
            });
            
            // Load analytics
            const analyticsDoc = await this.firestore.collection('users').doc(userId)
                .collection('analytics').doc('overview').get();
                
            const analytics = analyticsDoc.exists ? analyticsDoc.data() : {};
            
            // Update app state with loaded data
            appState.setState({
                connectedAccounts,
                drafts,
                scheduledPosts,
                analytics
            });
            
            console.log('✅ User data loaded from Firestore');
            
        } catch (error) {
            console.error('❌ Failed to load user data:', error);
            ToastManager.show('Failed to load data', 'error');
        }
    }

    async saveDraft(draft) {
        try {
            const userId = appState.getState('user').uid;
            const draftData = {
                ...draft,
                updatedAt: firebase.firestore.FieldValue.serverTimestamp()
            };
            
            if (draft.id && draft.id.startsWith('draft_')) {
                // Update existing draft
                await this.firestore.collection('users').doc(userId)
                    .collection('drafts').doc(draft.id).set(draftData, { merge: true });
            } else {
                // Create new draft
                const newDraftRef = this.firestore.collection('users').doc(userId)
                    .collection('drafts').doc();
                
                draftData.id = newDraftRef.id;
                draftData.createdAt = firebase.firestore.FieldValue.serverTimestamp();
                
                await newDraftRef.set(draftData);
                
                // Update the draft with the new ID
                draft.id = newDraftRef.id;
            }
            
            console.log('💾 Draft saved to Firestore:', draft.id);
            return draft.id;
        } catch (error) {
            console.error('❌ Failed to save draft:', error);
            ToastManager.show('Failed to save draft', 'error');
            throw error;
        }
    }

    async deleteDraft(draftId) {
        try {
            const userId = appState.getState('user').uid;
            await this.firestore.collection('users').doc(userId)
                .collection('drafts').doc(draftId).delete();
                
            console.log('🗑️ Draft deleted from Firestore:', draftId);
            return true;
        } catch (error) {
            console.error('❌ Failed to delete draft:', error);
            ToastManager.show('Failed to delete draft', 'error');
            return false;
        }
    }

    async schedulePost(post) {
        try {
            const userId = appState.getState('user').uid;
            const postData = {
                ...post,
                createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                status: 'scheduled'
            };
            
            const postRef = this.firestore.collection('users').doc(userId)
                .collection('scheduled_posts').doc();
                
            postData.id = postRef.id;
            await postRef.set(postData);
            
            console.log('📅 Post scheduled in Firestore:', postRef.id);
            return postRef.id;
        } catch (error) {
            console.error('❌ Failed to schedule post:', error);
            ToastManager.show('Failed to schedule post', 'error');
            throw error;
        }
    }

    async publishPost(post) {
        try {
            const userId = appState.getState('user').uid;
            const postData = {
                ...post,
                publishedAt: firebase.firestore.FieldValue.serverTimestamp(),
                status: 'published'
            };
            
            const postRef = this.firestore.collection('users').doc(userId)
                .collection('published_posts').doc();
                
            postData.id = postRef.id;
            await postRef.set(postData);
            
            console.log('🚀 Post published to Firestore:', postRef.id);
            return postRef.id;
        } catch (error) {
            console.error('❌ Failed to publish post:', error);
            ToastManager.show('Failed to publish post', 'error');
            throw error;
        }
    }

    async importPosts(posts) {
        try {
            const userId = appState.getState('user').uid;
            const batch = this.firestore.batch();
            const draftsRef = this.firestore.collection('users').doc(userId).collection('drafts');
            
            posts.forEach(post => {
                const docRef = draftsRef.doc();
                const postData = {
                    ...post,
                    id: docRef.id,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    updatedAt: firebase.firestore.FieldValue.serverTimestamp(),
                    imported: true
                };
                batch.set(docRef, postData);
            });
            
            await batch.commit();
            console.log('📥 Posts imported to Firestore:', posts.length);
            return true;
        } catch (error) {
            console.error('❌ Failed to import posts:', error);
            ToastManager.show('Failed to import posts', 'error');
            throw error;
        }
    }

    async updateSettings(settings) {
        try {
            const userId = appState.getState('user').uid;
            await this.firestore.collection('users').doc(userId).set({
                settings,
                updatedAt: firebase.firestore.FieldValue.serverTimestamp()
            }, { merge: true });
            
            console.log('⚙️ Settings updated in Firestore');
            return true;
        } catch (error) {
            console.error('❌ Failed to update settings:', error);
            ToastManager.show('Failed to update settings', 'error');
            return false;
        }
    }

    getDubaiTime(date) {
        return new Date(date.toLocaleString("en-US", {timeZone: CONFIG.dubaiTimezone}));
    }

    startAdvancedPeriodicSync() {
        console.log('⏰ Starting advanced periodic sync...');
        this.syncInterval = setInterval(() => {
            if (appState.getState('isOnline')) {
                appState.syncData();
            }
        }, CONFIG.refreshInterval);
    }

    stopAdvancedPeriodicSync() {
        if (this.syncInterval) {
            console.log('⏰ Stopping advanced periodic sync...');
            clearInterval(this.syncInterval);
            this.syncInterval = null;
        }
    }
}

// Enhanced Toast Notification Manager (unchanged)
class ToastManager {
    static show(message, type = 'info', title = null, duration = 5000) {
        console.log(`📢 Enhanced Toast: [${type.toUpperCase()}] ${title || 'Notification'}: ${message}`);
        
        const container = document.getElementById('toastContainer');
        if (!container) return;

        const toast = document.createElement('div');
        toast.className = `toast ${type}`;
        
        const icon = this.getIcon(type);
        toast.innerHTML = `
            <i class="${icon}"></i>
            <div class="toast-content">
                ${title ? `<div class="toast-title">${title}</div>` : ''}
                <div class="toast-message">${message}</div>
            </div>
            <button class="toast-close">
                <i class="fas fa-times"></i>
            </button>
        `;

        toast.querySelector('.toast-close').addEventListener('click', () => {
            this.remove(toast);
        });

        if (type === 'success' && title === 'Import Complete') {
            toast.style.cursor = 'pointer';
            toast.addEventListener('click', () => {
                uiManager.showSection('drafts');
                this.remove(toast);
            });
        }

        container.appendChild(toast);

        setTimeout(() => {
            if (toast.parentNode) {
                this.remove(toast);
            }
        }, duration);
    }

    static getIcon(type) {
        const icons = {
            success: 'fas fa-check-circle',
            error: 'fas fa-exclamation-circle',
            warning: 'fas fa-exclamation-triangle',
            info: 'fas fa-info-circle'
        };
        return icons[type] || icons.info;
    }

    static remove(toast) {
        toast.style.animation = 'slideOut 0.3s ease-in-out';
        setTimeout(() => {
            if (toast.parentNode) {
                toast.parentNode.removeChild(toast);
            }
        }, 300);
    }
}

// Enhanced UI Manager with Real Data Integration
class UIManager {
    constructor() {
        console.log('🎨 Initializing Enhanced UI Manager...');
        this.currentSection = 'dashboard';
        this.sidebarCollapsed = false;
        this.isMobile = window.innerWidth <= 768;
        this.charts = {};
        this.setupEventListeners();
        this.setupThemeToggle();
        this.setupAdvancedFeatures();
        console.log('✅ Enhanced UI Manager Initialized');
    }

    setupEventListeners() {
        // Sidebar toggle
        document.getElementById('sidebarToggle')?.addEventListener('click', () => {
            this.toggleSidebar();
        });

        // Navigation links
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const section = link.getAttribute('data-section');
                this.showSection(section);
                this.updateBreadcrumb(section);
            });
        });

        // Modal controls
        document.querySelectorAll('.modal-close, .modal-backdrop').forEach(element => {
            element.addEventListener('click', (e) => {
                if (e.target === element) {
                    this.closeModal(element.closest('.modal'));
                }
            });
        });

        // Settings tabs
        document.querySelectorAll('.settings-tab').forEach(tab => {
            tab.addEventListener('click', (e) => {
                e.preventDefault();
                const tabName = tab.getAttribute('data-tab');
                this.showSettingsTab(tabName);
            });
        });

        // Responsive handling
        window.addEventListener('resize', () => {
            const wasMobile = this.isMobile;
            this.isMobile = window.innerWidth <= 768;
            
            if (wasMobile !== this.isMobile) {
                console.log(`📱 Device type changed: ${this.isMobile ? 'Mobile' : 'Desktop'}`);
                this.handleResponsiveChange();
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                switch (e.key) {
                    case 'n':
                        e.preventDefault();
                        this.showSection('composer');
                        console.log('⌨️ Keyboard shortcut: New Post');
                        break;
                    case 'd':
                        e.preventDefault();
                        this.showSection('dashboard');
                        console.log('⌨️ Keyboard shortcut: Dashboard');
                        break;
                    case 'i':
                        e.preventDefault();
                        this.showSection('bulk-import');
                        console.log('⌨️ Keyboard shortcut: Bulk Import');
                        break;
                    case 's':
                        e.preventDefault();
                        this.showSection('scheduler');
                        console.log('⌨️ Keyboard shortcut: Scheduler');
                        break;
                }
            }
            
            if (e.key === 'Escape') {
                this.closeAllModals();
            }
        });
    }

    setupAdvancedFeatures() {
        // User role selector
        const userRoleSelect = document.getElementById('userRole');
        if (userRoleSelect) {
            userRoleSelect.addEventListener('change', (e) => {
                const newRole = e.target.value;
                appState.setState({ userRole: newRole });
                this.updateUserRole(newRole);
                
                // Save to Firestore
                if (appState.getState('user')) {
                    const userId = appState.getState('user').uid;
                    firebaseService.firestore.collection('users').doc(userId).update({
                        role: newRole
                    });
                }
                
                ToastManager.show(`Role changed to ${USER_ROLES[newRole].name}`, 'success');
            });
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.altKey) {
                const sectionKeys = {
                    '1': 'dashboard',
                    '2': 'bulk-import',
                    '3': 'accounts',
                    '4': 'composer',
                    '5': 'scheduler',
                    '6': 'analytics',
                    '7': 'drafts',
                    '8': 'settings'
                };
                
                if (sectionKeys[e.key]) {
                    e.preventDefault();
                    this.showSection(sectionKeys[e.key]);
                }
            }
        });
    }

    setupThemeToggle() {
        const themeToggle = document.getElementById('themeToggle');
        if (!themeToggle) return;

        themeToggle.addEventListener('click', () => {
            this.toggleTheme();
        });

        this.applyTheme(appState.getState('theme'));
    }

    toggleTheme() {
        const currentTheme = appState.getState('theme');
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
        
        console.log(`🎨 Enhanced theme changed: ${currentTheme} → ${newTheme}`);
        
        appState.setState({ theme: newTheme });
        this.applyTheme(newTheme);
        
        // Save to localStorage
        try {
            localStorage.setItem('theme', newTheme);
        } catch (error) {
            console.warn('Could not save theme to localStorage:', error);
        }
        
        const icon = document.querySelector('#themeToggle i');
        if (icon) {
            icon.className = newTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
        }

        ToastManager.show(`${newTheme === 'dark' ? 'Dark' : 'Light'} theme activated`, 'success');
    }

    applyTheme(theme) {
        document.documentElement.setAttribute('data-color-scheme', theme);
    }

    updateBreadcrumb(section) {
        const breadcrumbPath = document.getElementById('breadcrumbPath');
        if (breadcrumbPath) {
            const sectionNames = {
                'dashboard': 'Home / Dashboard',
                'bulk-import': 'Home / Bulk Import',
                'accounts': 'Home / Accounts',
                'composer': 'Home / Post Composer',
                'scheduler': 'Home / Smart Scheduler',
                'analytics': 'Home / Analytics Pro',
                'drafts': 'Home / Drafts',
                'settings': 'Home / Settings'
            };
            breadcrumbPath.textContent = sectionNames[section] || 'Home';
        }
    }

    updateUserRole(role) {
        const userRoleElement = document.getElementById('userRole');
        const userRoleDisplay = document.getElementById('userRole');
        
        if (userRoleDisplay) {
            userRoleDisplay.textContent = USER_ROLES[role].name;
        }
    }

    showLoadingScreen() {
        console.log('⏳ Showing enhanced loading screen...');
        document.getElementById('loadingScreen').style.display = 'flex';
        document.getElementById('loginScreen').style.display = 'none';
        document.getElementById('mainApp').style.display = 'none';
    }

    showLoginScreen() {
        console.log('🔐 Showing enhanced login screen...');
        document.getElementById('loadingScreen').style.display = 'none';
        document.getElementById('loginScreen').style.display = 'flex';
        document.getElementById('mainApp').style.display = 'none';
    }

    showMainApp() {
        console.log('🏠 Showing enhanced main application...');
        document.getElementById('loadingScreen').style.display = 'none';
        document.getElementById('loginScreen').style.display = 'none';
        document.getElementById('mainApp').style.display = 'grid';
        
        this.updateUserProfile();
        this.showSection('dashboard');
        this.updateStats();
    }

    updateUserProfile() {
        const user = appState.getState('user');
        const userRole = appState.getState('userRole');
        
        if (!user) return;

        console.log('👤 Updating enhanced user profile in UI...');
        
        const avatar = document.getElementById('userAvatar');
        const name = document.getElementById('userName');
        const role = document.getElementById('userRole');

        if (avatar) avatar.src = user.photoURL || '';
        if (name) name.textContent = user.displayName || 'Unknown User';
        if (role) role.textContent = USER_ROLES[userRole].name || 'User';
    }

    showSection(sectionName) {
        console.log(`📄 Showing enhanced section: ${sectionName}`);
        
        // Update navigation
        document.querySelectorAll('.nav-link').forEach(link => {
            link.classList.toggle('active', link.getAttribute('data-section') === sectionName);
        });

        // Update content sections
        document.querySelectorAll('.content-section').forEach(section => {
            section.classList.toggle('active', section.id === `${sectionName}Section`);
        });

        // Update header title
        const titleMap = {
            dashboard: 'Dashboard',
            'bulk-import': 'Bulk Import',
            accounts: 'Connected Accounts',
            composer: 'AI-Powered Post Composer',
            scheduler: 'Smart Scheduler',
            analytics: 'Analytics Pro',
            drafts: 'Draft Posts',
            settings: 'Settings'
        };
        
        const sectionTitle = document.getElementById('sectionTitle');
        if (sectionTitle) {
            sectionTitle.textContent = titleMap[sectionName] || 'SocialHub Pro';
        }

        this.currentSection = sectionName;
        this.loadSectionData(sectionName);

        if (this.isMobile) {
            this.closeSidebar();
        }
    }

    loadSectionData(sectionName) {
        console.log(`📊 Loading enhanced data for section: ${sectionName}`);
        
        switch (sectionName) {
            case 'dashboard':
                this.updateDashboard();
                break;
            case 'bulk-import':
                this.initializeBulkImport();
                break;
            case 'accounts':
                this.updateAccountsList();
                break;
            case 'analytics':
                this.updateAnalytics();
                break;
            case 'drafts':
                this.updateDraftsList();
                break;
            case 'scheduler':
                this.updateCalendar();
                break;
        }
    }

    updateStats() {
        const analytics = appState.getState('analytics');
        if (!analytics) return;

        console.log('📊 Updating enhanced statistics...');
        
        // Update dashboard stats
        document.getElementById('totalPosts').textContent = (analytics.totalPosts || 0).toLocaleString();
        document.getElementById('totalEngagement').textContent = (analytics.totalEngagement || 0).toLocaleString();
        document.getElementById('totalReach').textContent = (analytics.totalReach || 0).toLocaleString();
        
        const scheduledCount = appState.getState('scheduledPosts').length || 0;
        document.getElementById('scheduledPosts').textContent = scheduledCount;
        
        // Update next scheduled post
        const nextScheduled = appState.getState('scheduledPosts')[0];
        const nextScheduledElement = document.getElementById('nextScheduled');
        if (nextScheduledElement) {
            if (nextScheduled) {
                const dubaiTime = new Date(nextScheduled.scheduledFor).toLocaleString('en-US', {
                    timeZone: CONFIG.dubaiTimezone,
                    hour: '2-digit',
                    minute: '2-digit'
                });
                nextScheduledElement.textContent = `Next: Today ${dubaiTime}`;
            } else {
                nextScheduledElement.textContent = 'No posts scheduled';
            }
        }
        
        // Update change percentages (simplified for demo)
        document.getElementById('postsChange').textContent = analytics.postsChange || '+0% this week';
        document.getElementById('engagementChange').textContent = analytics.engagementChange || '+0% this week';
        document.getElementById('reachChange').textContent = analytics.reachChange || '+0% this week';
    }

    updateDashboard() {
        this.updateStats();
        this.updateRecentActivity();
        this.updateEngagementChart();
        this.updateAIInsights();
    }

    updateRecentActivity() {
        const container = document.getElementById('recentActivity');
        if (!container) return;

        console.log('📝 Updating enhanced recent activity...');
        
        // Get recent activities from various sources
        const scheduledPosts = appState.getState('scheduledPosts');
        const drafts = appState.getState('drafts');
        const publishedPosts = appState.getState('analytics').recentPosts || [];
        
        // Generate activity items
        const activities = [];
        
        // Add scheduled posts activities
        if (scheduledPosts.length > 0) {
            const latestScheduled = scheduledPosts[0];
            activities.push({
                icon: 'fas fa-calendar-plus',
                title: `Post scheduled for ${new Date(latestScheduled.scheduledFor).toLocaleDateString()}`,
                meta: 'Recently scheduled • Dubai Time',
                color: '#4F46E5'
            });
        }
        
        // Add draft activities
        if (drafts.length > 0) {
            const latestDraft = drafts[drafts.length - 1];
            activities.push({
                icon: 'fas fa-file-alt',
                title: 'Draft saved: ' + (latestDraft.content?.substring(0, 30) + '...' || 'New draft'),
                meta: 'Recently updated',
                color: '#10B981'
            });
        }
        
        // Add published posts activities
        if (publishedPosts.length > 0) {
            const latestPublished = publishedPosts[0];
            activities.push({
                icon: 'fas fa-share',
                title: `Post published to ${latestPublished.platforms?.join(', ') || 'platforms'}`,
                meta: 'Recently published • ' + (latestPublished.engagement || '0 engagements'),
                color: '#1877F2'
            });
        }
        
        // Add default activities if none exist
        if (activities.length === 0) {
            activities.push({
                icon: 'fas fa-rocket',
                title: 'Welcome to SocialHub Pro!',
                meta: 'Get started by creating your first post',
                color: '#218083'
            });
        }
        
        // Render activities
        container.innerHTML = activities.map(activity => `
            <div class="activity-item">
                <div class="activity-icon" style="background: ${activity.color};">
                    <i class="${activity.icon}"></i>
                </div>
                <div class="activity-content">
                    <div class="activity-title">${activity.title}</div>
                    <div class="activity-meta">${activity.meta}</div>
                </div>
            </div>
        `).join('');
    }

    updateEngagementChart() {
        const canvas = document.getElementById('engagementChart');
        if (!canvas) return;

        console.log('📈 Updating enhanced engagement chart...');
        
        const ctx = canvas.getContext('2d');
        const analytics = appState.getState('analytics');
        
        if (this.charts.engagement) {
            this.charts.engagement.destroy();
        }

        // Use real data or generate sample data
        const weeklyData = analytics.weeklyData || this.generateSampleChartData();
        
        this.charts.engagement = new Chart(ctx, {
            type: 'line',
            data: {
                labels: weeklyData.map(d => new Date(d.date).toLocaleDateString()),
                datasets: [{
                    label: 'Engagement',
                    data: weeklyData.map(d => d.engagement),
                    borderColor: '#1FB8CD',
                    backgroundColor: 'rgba(31, 184, 205, 0.1)',
                    fill: true,
                    tension: 0.4
                }, {
                    label: 'Clicks',
                    data: weeklyData.map(d => d.clicks),
                    borderColor: '#FFC185',
                    backgroundColor: 'rgba(255, 193, 133, 0.1)',
                    fill: true,
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: true,
                        position: 'top'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
    }

    generateSampleChartData() {
        // Generate sample data for the chart
        const data = [];
        const now = new Date();
        
        for (let i = 6; i >= 0; i--) {
            const date = new Date(now);
            date.setDate(date.getDate() - i);
            
            data.push({
                date: date.toISOString().split('T')[0],
                posts: Math.floor(Math.random() * 10) + 1,
                engagement: Math.floor(Math.random() * 1000) + 100,
                reach: Math.floor(Math.random() * 5000) + 1000,
                clicks: Math.floor(Math.random() * 100) + 10
            });
        }
        
        return data;
    }

    updateAIInsights() {
        console.log('🧠 Updating AI insights...');
        
        // Update AI insights with real or generated data
        const insights = appState.getState('aiInsights') || {};
        
        document.getElementById('optimalTimeInsight').textContent = 
            insights.optimalPostingTime || 'Your audience is most active at 10:30 AM and 5:15 PM Dubai time';
            
        document.getElementById('hashtagInsight').textContent = 
            insights.trendingHashtags || '#innovation #tech #dubai are performing well this week';
            
        document.getElementById('contentTypeInsight').textContent = 
            insights.contentRecommendation || 'Video content is generating good engagement compared to images';
    }

    // ... (rest of the UI Manager methods remain similar but updated for real data)
    // The rest of the class would continue with all the methods from the original
    // but updated to work with real Firestore data instead of demo data

    initializeBulkImport() {
        console.log('📥 Initializing enhanced bulk import...');
        
        if (this.bulkImportInitialized) return;
        this.bulkImportInitialized = true;
        
        // Setup import method selection
        document.querySelectorAll('.import-method').forEach(method => {
            method.addEventListener('click', () => {
                document.querySelectorAll('.import-method').forEach(m => m.classList.remove('active'));
                method.classList.add('active');
                
                const methodType = method.getAttribute('data-method');
                console.log(`📋 Import method selected: ${methodType}`);
            });
        });

        // Setup drag and drop
        const dropzone = document.getElementById('importDropzone');
        const fileInput = document.getElementById('importFileInput');

        if (dropzone && fileInput) {
            dropzone.addEventListener('click', () => fileInput.click());
            
            dropzone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropzone.classList.add('dragover');
            });

            dropzone.addEventListener('dragleave', () => {
                dropzone.classList.remove('dragover');
            });

            dropzone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropzone.classList.remove('dragover');
                this.handleImportFile(e.dataTransfer.files[0]);
            });

            fileInput.addEventListener('change', (e) => {
                if (e.target.files[0]) {
                    this.handleImportFile(e.target.files[0]);
                }
            });
        }

        // Setup template downloads
        document.getElementById('downloadCSVTemplate')?.addEventListener('click', () => {
            this.downloadTemplate('csv');
        });

        document.getElementById('downloadJSONTemplate')?.addEventListener('click', () => {
            this.downloadTemplate('json');
        });

        // Setup import actions
        document.getElementById('validateImport')?.addEventListener('click', () => {
            this.validateImportData();
        });

        document.getElementById('processImport')?.addEventListener('click', () => {
            this.processImportData();
        });

        document.getElementById('cancelImport')?.addEventListener('click', () => {
            this.cancelImport();
        });
    }

    async processImportData() {
        const data = appState.getState('importData');
        if (!data) return;

        console.log('⚡ Processing import data...');
        
        const importProgress = document.getElementById('importProgress');
        const importPreview = document.getElementById('importPreview');
        const progressFill = document.getElementById('progressFill');
        const progressText = document.getElementById('progressText');
        const importLog = document.getElementById('importLog');

        if (importProgress) importProgress.classList.remove('hidden');
        if (importPreview) importPreview.classList.add('hidden');

        try {
            // Process and import data to Firestore
            await firebaseService.importPosts(data);
            
            // Update UI
            if (progressText) progressText.textContent = `Import complete: ${data.length} posts imported`;
            if (importLog) {
                importLog.innerHTML += `<div style="color: var(--color-success);">✅ Import completed successfully</div>`;
            }

            // Refresh drafts list
            await appState.syncData();
            
            setTimeout(() => {
                if (importProgress) importProgress.classList.add('hidden');
                ToastManager.show(`Successfully imported ${data.length} posts!`, 'success', 'Import Complete');
                this.showSection('drafts');
            }, 2000);
            
        } catch (error) {
            console.error('❌ Import failed:', error);
            if (importLog) {
                importLog.innerHTML += `<div style="color: var(--color-error);">❌ Import failed: ${error.message}</div>`;
            }
            ToastManager.show('Import failed: ' + error.message, 'error');
        }
    }

    updateAccountsList() {
        const container = document.getElementById('accountsList');
        if (!container) return;

        console.log('🔗 Updating enhanced accounts list...');
        
        const accounts = appState.getState('connectedAccounts');
        const platformColors = {
            facebook: '#1877F2',
            instagram: '#E4405F',
            twitter: '#1DA1F2',
            linkedin: '#0A66C2'
        };

        // Update account counters
        const facebookCount = accounts.filter(a => a.platform === 'facebook').length;
        const instagramCount = accounts.filter(a => a.platform === 'instagram').length;
        
        document.getElementById('facebookAccounts').textContent = `${facebookCount}/10`;
        document.getElementById('instagramAccounts').textContent = `${instagramCount}/5`;

        if (accounts.length === 0) {
            container.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-users"></i>
                    <h4>No accounts connected</h4>
                    <p>Connect your social media accounts to start scheduling posts</p>
                    <button class="btn btn--primary" onclick="uiManager.showModal('accountModal')" style="margin-top: var(--space-16);">
                        <i class="fas fa-plus"></i>
                        Connect Account
                    </button>
                </div>
            `;
            return;
        }

        container.innerHTML = accounts.map(account => `
            <div class="account-card">
                <div class="account-icon" style="background: ${platformColors[account.platform]};">
                    <i class="fab fa-${account.platform}"></i>
                </div>
                <div class="account-info">
                    <h4 class="account-name">${account.name}</h4>
                    <p class="account-username">${account.username}</p>
                    <div class="account-stats">
                        <span class="account-stat">
                            <i class="fas fa-users"></i>
                            ${account.followerCount ? account.followerCount.toLocaleString() + ' followers' : 'Followers not available'}
                        </span>
                        <span class="account-stat">
                            <i class="fas fa-heart"></i>
                            Health: ${account.healthStatus || 'unknown'}
                        </span>
                    </div>
                </div>
                <div class="account-actions">
                    <span class="status status--success">Connected</span>
                    <button class="btn btn--outline btn--sm">Manage</button>
                </div>
            </div>
        `).join('');
    }

    updateDraftsList() {
        const container = document.getElementById('draftsList');
        if (!container) return;

        console.log('📄 Updating enhanced drafts list...');
        
        const drafts = appState.getState('drafts');
        const platformColors = {
            facebook: '#1877F2',
            instagram: '#E4405F',
            twitter: '#1DA1F2',
            linkedin: '#0A66C2'
        };

        if (drafts.length === 0) {
            container.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-file-alt"></i>
                    <h4>No drafts yet</h4>
                    <p>Create your first draft post or import content to get started.</p>
                    <div style="display: flex; gap: var(--space-12); justify-content: center; margin-top: var(--space-16);">
                        <button class="btn btn--primary" onclick="uiManager.showSection('composer')">
                            <i class="fas fa-plus"></i>
                            Create Draft
                        </button>
                        <button class="btn btn--secondary" onclick="uiManager.showSection('bulk-import')">
                            <i class="fas fa-upload"></i>
                            Bulk Import
                        </button>
                    </div>
                </div>
            `;
            return;
        }

        container.innerHTML = drafts.map(draft => `
            <div class="draft-item">
                <div class="draft-checkbox">
                    <input type="checkbox" data-draft-id="${draft.id}">
                </div>
                <div class="draft-content">
                    <div class="draft-header">
                        <div class="draft-platforms">
                            ${draft.platforms ? draft.platforms.map(platform => `
                                <span class="draft-platform" style="background: ${platformColors[platform]};">
                                    <i class="fab fa-${platform}"></i>
                                    ${platform}
                                </span>
                            `).join('') : ''}
                        </div>
                        <div class="draft-actions">
                            <button class="btn btn--outline btn--sm" onclick="postComposer.editDraft('${draft.id}')">
                                <i class="fas fa-edit"></i>
                                Edit
                            </button>
                            <button class="btn btn--secondary btn--sm" onclick="postComposer.scheduleDraft('${draft.id}')">
                                <i class="fas fa-calendar-plus"></i>
                                Schedule
                            </button>
                        </div>
                    </div>
                    <div class="draft-text">${draft.content || 'No content'}</div>
                    <div class="draft-meta">
                        <span><i class="fas fa-clock"></i> ${draft.updatedAt ? new Date(draft.updatedAt.seconds * 1000).toLocaleDateString() : 'Unknown date'}</span>
                        <span><i class="fas fa-file-alt"></i> ${draft.content ? draft.content.length : 0} characters</span>
                        ${draft.imported ? '<span class="status status--info">Imported</span>' : ''}
                        ${draft.contentCategory ? `<span><i class="fas fa-tag"></i> ${draft.contentCategory}</span>` : ''}
                    </div>
                </div>
            </div>
        `).join('');
    }

    // ... (other methods would follow the same pattern of using real data)

    toggleSidebar() {
        const sidebar = document.querySelector('.sidebar');
        const mainApp = document.querySelector('.main-app');
        
        if (this.isMobile) {
            sidebar.classList.toggle('open');
            console.log('📱 Mobile sidebar toggled');
        } else {
            this.sidebarCollapsed = !this.sidebarCollapsed;
            mainApp.classList.toggle('sidebar-collapsed', this.sidebarCollapsed);
            console.log(`🔧 Desktop sidebar ${this.sidebarCollapsed ? 'collapsed' : 'expanded'}`);
        }
    }

    closeSidebar() {
        if (this.isMobile) {
            document.querySelector('.sidebar').classList.remove('open');
        }
    }

    handleResponsiveChange() {
        if (!this.isMobile) {
            document.querySelector('.sidebar').classList.remove('open');
        } else {
            document.querySelector('.main-app').classList.remove('sidebar-collapsed');
        }
    }

    showModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) {
            console.log(`🔧 Showing enhanced modal: ${modalId}`);
            modal.classList.remove('hidden');
        }
    }

    closeModal(modal) {
        if (modal) {
            console.log('🔧 Closing enhanced modal');
            modal.classList.add('hidden');
        }
    }

    closeAllModals() {
        document.querySelectorAll('.modal:not(.hidden)').forEach(modal => {
            this.closeModal(modal);
        });
    }

    showSettingsTab(tabName) {
        console.log(`⚙️ Showing enhanced settings tab: ${tabName}`);
        
        document.querySelectorAll('.settings-tab').forEach(tab => {
            tab.classList.toggle('active', tab.getAttribute('data-tab') === tabName);
        });

        document.querySelectorAll('.settings-panel').forEach(panel => {
            panel.classList.toggle('active', panel.id === `${tabName}Settings`);
        });
    }
}

// Enhanced Post Composer with Real Firestore Integration
class PostComposer {
    constructor() {
        console.log('✍️ Initializing Enhanced Post Composer...');
        this.selectedPlatforms = [];
        this.mediaFiles = [];
        this.currentDraft = null;
        this.autoSaveTimeout = null;
        this.aiSuggestionsEnabled = true;
        this.setupEventListeners();
        this.setupPlatformSelector();
        console.log('✅ Enhanced Post Composer Initialized');
    }

    setupEventListeners() {
        // Content textarea
        const contentTextarea = document.getElementById('postContent');
        if (contentTextarea) {
            contentTextarea.addEventListener('input', () => {
                this.updateCharacterCount();
                this.updatePreview();
                this.scheduleAutoSave();
            });

            contentTextarea.placeholder = "What's happening? (AI suggestions available)";
        }

        // Media upload
        const mediaInput = document.getElementById('mediaInput');
        const dropzone = document.getElementById('mediaDropzone');

        if (mediaInput) {
            mediaInput.addEventListener('change', (e) => {
                this.handleMediaFiles(e.target.files);
            });
        }

        if (dropzone) {
            dropzone.addEventListener('click', () => {
                mediaInput?.click();
            });

            dropzone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropzone.classList.add('dragover');
            });

            dropzone.addEventListener('dragleave', () => {
                dropzone.classList.remove('dragover');
            });

            dropzone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropzone.classList.remove('dragover');
                this.handleMediaFiles(e.dataTransfer.files);
            });
        }

        // Action buttons
        document.getElementById('aiSuggestBtn')?.addEventListener('click', () => {
            this.generateAISuggestions();
        });

        document.getElementById('aiEnhanceBtn')?.addEventListener('click', () => {
            this.enhanceContentWithAI();
        });

        document.getElementById('aiHashtagBtn')?.addEventListener('click', () => {
            this.generateHashtags();
        });

        document.getElementById('saveDraftBtn')?.addEventListener('click', () => {
            this.saveDraft();
        });

        document.getElementById('schedulePostBtn')?.addEventListener('click', () => {
            this.showSmartScheduleModal();
        });

        document.getElementById('publishNowBtn')?.addEventListener('click', () => {
            this.publishNow();
        });

        // Time slot selection
        document.querySelectorAll('.time-slot').forEach(slot => {
            slot.addEventListener('click', () => {
                document.querySelectorAll('.time-slot').forEach(s => s.classList.remove('selected'));
                slot.classList.add('selected');
                
                const slotType = slot.getAttribute('data-slot');
                console.log(`⏰ Time slot selected: ${slotType}`);
            });
        });
    }

    setupPlatformSelector() {
        const container = document.getElementById('platformCheckboxes');
        if (!container) return;

        console.log('🎯 Setting up enhanced platform selector...');
        
        const platforms = [
            { id: 'facebook', name: 'Facebook', icon: 'fab fa-facebook', color: '#1877F2' },
            { id: 'instagram', name: 'Instagram', icon: 'fab fa-instagram', color: '#E4405F' }
        ];

        container.innerHTML = platforms.map(platform => `
            <label class="platform-checkbox" data-platform="${platform.id}" style="border-color: ${platform.color};">
                <input type="checkbox" value="${platform.id}">
                <i class="${platform.icon}"></i>
                <span>${platform.name}</span>
            </label>
        `).join('');

        container.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
            checkbox.addEventListener('change', (e) => {
                const platform = e.target.value;
                const label = e.target.closest('.platform-checkbox');
                
                if (e.target.checked) {
                    this.selectedPlatforms.push(platform);
                    label.classList.add('selected');
                } else {
                    this.selectedPlatforms = this.selectedPlatforms.filter(p => p !== platform);
                    label.classList.remove('selected');
                }
                
                console.log('🎯 Selected platforms:', this.selectedPlatforms);
                this.updateCharacterCount();
                this.updatePreview();
            });
        });
    }

    generateAISuggestions() {
        console.log('🧠 Generating AI content suggestions...');
        
        const btn = document.getElementById('aiSuggestBtn');
        const originalText = btn.innerHTML;
        btn.innerHTML = '<i class="fas fa-brain fa-spin"></i> Generating...';
        btn.disabled = true;

        // Simulate AI suggestion generation
        setTimeout(() => {
            const suggestions = [
                "🚀 Exciting news! We're launching something amazing next week. Stay tuned for innovation that will transform your business experience. #innovation #tech #dubai",
                "💡 Monday motivation: Success isn't just about what you accomplish, but what you inspire others to do. Let's make this week count! #motivation #leadership",
                "🌟 Behind the scenes at our Dubai office: Creating spaces that inspire creativity, collaboration, and breakthrough thinking. #workplace #dubai #culture"
            ];

            const randomSuggestion = suggestions[Math.floor(Math.random() * suggestions.length)];
            document.getElementById('postContent').value = randomSuggestion;
            
            this.updateCharacterCount();
            this.updatePreview();
            
            btn.innerHTML = originalText;
            btn.disabled = false;
            
            ToastManager.show('AI suggestions generated!', 'success', 'AI Assistant');
        }, 2000);
    }

    enhanceContentWithAI() {
        console.log('✨ Enhancing content with AI...');
        
        const content = document.getElementById('postContent').value;
        if (!content.trim()) {
            ToastManager.show('Please enter some content first', 'warning');
            return;
        }

        const btn = document.getElementById('aiEnhanceBtn');
        const originalText = btn.innerHTML;
        btn.innerHTML = '<i class="fas fa-magic fa-spin"></i> Enhancing...';
        btn.disabled = true;

        setTimeout(() => {
            // Simulate AI enhancement
            const enhanced = content + "\n\n✨ Enhanced with AI for maximum engagement!";
            document.getElementById('postContent').value = enhanced;
            
            this.updateCharacterCount();
            this.updatePreview();
            
            btn.innerHTML = originalText;
            btn.disabled = false;
            
            ToastManager.show('Content enhanced!', 'success', 'AI Enhancement');
        }, 1500);
    }

    generateHashtags() {
        console.log('# Generating AI hashtags...');
        
        const content = document.getElementById('postContent').value;
        if (!content.trim()) {
            ToastManager.show('Please enter some content first', 'warning');
            return;
        }

        const btn = document.getElementById('aiHashtagBtn');
        const originalText = btn.innerHTML;
        btn.innerHTML = '<i class="fas fa-hashtag fa-spin"></i> Generating...';
        btn.disabled = true;

        setTimeout(() => {
            const hashtags = ['#innovation', '#tech', '#dubai', '#business', '#success', '#growth'];
            const selectedHashtags = hashtags.slice(0, 3).join(' ');
            
            const currentContent = document.getElementById('postContent').value;
            const newContent = currentContent + '\n\n' + selectedHashtags;
            document.getElementById('postContent').value = newContent;
            
            this.updateCharacterCount();
            this.updatePreview();
            
            btn.innerHTML = originalText;
            btn.disabled = false;
            
            ToastManager.show('Hashtags added!', 'success', 'AI Hashtags');
        }, 1000);
    }

    updateCharacterCount() {
        const content = document.getElementById('postContent')?.value || '';
        const counter = document.getElementById('characterCount');
        const limit = document.getElementById('characterLimit');
        
        if (!counter) return;

        const limits = {
            facebook: 2200,
            instagram: 2200,
            twitter: 280,
            linkedin: 1300
        };

        const currentLimit = this.selectedPlatforms.length > 0 
            ? Math.min(...this.selectedPlatforms.map(p => limits[p] || 2200))
            : 2200;

        counter.textContent = content.length;
        if (limit) limit.textContent = currentLimit;

        const counterElement = counter.parentElement;
        counterElement.classList.remove('warning', 'error');
        
        if (content.length > currentLimit * 0.9) {
            counterElement.classList.add('warning');
        }
        if (content.length > currentLimit) {
            counterElement.classList.add('error');
        }
    }

    updatePreview() {
        const content = document.getElementById('postContent')?.value || 'Your post content will appear here...';
        const previewContainer = document.getElementById('postPreview');
        
        if (!previewContainer) return;

        console.log('👀 Updating enhanced post preview...');
        
        const platformColors = {
            facebook: '#1877F2',
            instagram: '#E4405F'
        };

        const platformsToShow = this.selectedPlatforms.length > 0 ? this.selectedPlatforms : ['facebook'];
        
        previewContainer.innerHTML = platformsToShow.map(platform => `
            <div class="preview-platform ${platform}">
                <div class="platform-header" style="color: ${platformColors[platform]};">
                    <i class="fab fa-${platform}"></i>
                    <span>${platform.charAt(0).toUpperCase() + platform.slice(1)}</span>
                </div>
                <div class="preview-post">
                    <div class="preview-text">${content}</div>
                    ${this.mediaFiles.length > 0 ? `
                        <div class="preview-media" style="margin-top: var(--space-8); padding: var(--space-8); background: var(--color-secondary); border-radius: var(--radius-sm);">
                            <i class="fas fa-image"></i>
                            ${this.mediaFiles.length} media file(s)
                        </div>
                    ` : ''}
                </div>
            </div>
        `).join('');
    }

    handleMediaFiles(files) {
        console.log(`📸 Processing ${files.length} media files...');
        
        Array.from(files).forEach(file => {
            if (this.validateMediaFile(file)) {
                this.addMediaFile(file);
            }
        });
    }

    validateMediaFile(file) {
        const maxSize = 50 * 1024 * 1024;
        const allowedTypes = ['image/jpeg', 'image/png', 'image/gif', 'video/mp4', 'video/mov'];
        
        if (!allowedTypes.includes(file.type)) {
            ToastManager.show('Invalid file type. Please upload images or videos.', 'error');
            return false;
        }
        
        if (file.size > maxSize) {
            ToastManager.show('File is too large. Maximum size is 50MB.', 'error');
            return false;
        }
        
        return true;
    }

    addMediaFile(file) {
        const mediaPreview = document.getElementById('mediaPreview');
        if (!mediaPreview) return;

        console.log(`📎 Adding media file: ${file.name}`);
        
        this.mediaFiles.push(file);
        
        const reader = new FileReader();
        reader.onload = (e) => {
            const mediaItem = document.createElement('div');
            mediaItem.className = 'media-item';
            mediaItem.innerHTML = `
                ${file.type.startsWith('image/') 
                    ? `<img src="${e.target.result}" alt="Preview">`
                    : `<video src="${e.target.result}" controls></video>`
                }
                <button class="media-remove" onclick="postComposer.removeMediaFile(${this.mediaFiles.length - 1})">
                    <i class="fas fa-times"></i>
                </button>
            `;
            mediaPreview.appendChild(mediaItem);
        };
        reader.readAsDataURL(file);
        
        this.updatePreview();
        ToastManager.show(`Added ${file.name}`, 'success');
    }

    removeMediaFile(index) {
        console.log(`🗑️ Removing media file at index: ${index}`);
        
        this.mediaFiles.splice(index, 1);
        
        const mediaPreview = document.getElementById('mediaPreview');
        if (mediaPreview) {
            const items = mediaPreview.querySelectorAll('.media-item');
            if (items[index]) {
                items[index].remove();
            }
        }
        
        this.updatePreview();
        ToastManager.show('Media file removed', 'info');
    }

    async saveDraft() {
        const content = document.getElementById('postContent')?.value;
        const category = document.getElementById('contentCategory')?.value;
        const shortUrl = document.getElementById('shortUrl')?.value;
        
        if (!content?.trim()) {
            ToastManager.show('Please enter some content before saving', 'warning');
            return;
        }

        if (this.selectedPlatforms.length === 0) {
            ToastManager.show('Please select at least one platform', 'warning');
            return;
        }

        console.log('💾 Saving enhanced draft...');
        
        const draft = {
            content: content.trim(),
            platforms: [...this.selectedPlatforms],
            contentCategory: category || 'article',
            shortUrl: shortUrl || '',
            linkType: 'article',
            mediaUrls: this.mediaFiles.map(f => URL.createObjectURL(f)), // Store as URLs, not files
            mediaFiles: this.mediaFiles.map(f => ({ name: f.name, type: f.type, size: f.size }))
        };

        if (this.currentDraft?.id) {
            draft.id = this.currentDraft.id;
        }

        try {
            const draftId = await firebaseService.saveDraft(draft);
            
            // Update local state
            const drafts = appState.getState('drafts');
            const existingIndex = drafts.findIndex(d => d.id === draftId);
            
            if (existingIndex >= 0) {
                drafts[existingIndex] = { ...draft, id: draftId };
            } else {
                drafts.push({ ...draft, id: draftId });
            }
            
            appState.setState({ drafts });
            this.currentDraft = { ...draft, id: draftId };
            
            ToastManager.show('Draft saved successfully', 'success');
        } catch (error) {
            console.error('❌ Failed to save draft:', error);
            ToastManager.show('Failed to save draft', 'error');
        }
    }

    scheduleAutoSave() {
        if (!CONFIG.autoSave) return;
        
        if (this.autoSaveTimeout) {
            clearTimeout(this.autoSaveTimeout);
        }
        
        this.autoSaveTimeout = setTimeout(() => {
            const content = document.getElementById('postContent')?.value;
            if (content?.trim() && this.selectedPlatforms.length > 0) {
                console.log('💾 Auto-saving enhanced draft...');
                this.saveDraft();
            }
        }, 5000);
    }

    showSmartScheduleModal() {
        const content = document.getElementById('postContent')?.value;
        
        if (!content?.trim()) {
            ToastManager.show('Please enter some content before scheduling', 'warning');
            return;
        }

        if (this.selectedPlatforms.length === 0) {
            ToastManager.show('Please select at least one platform', 'warning');
            return;
        }

        console.log('📅 Showing smart schedule modal...');
        
        // Set default values for Dubai timezone
        const dubaiTime = new Date().toLocaleString("en-US", {timeZone: CONFIG.dubaiTimezone});
        const tomorrow = new Date(new Date(dubaiTime).getTime() + 86400000);
        
        document.getElementById('scheduleDate').value = tomorrow.toISOString().split('T')[0];
        document.getElementById('scheduleTime').value = '17:17'; // Default to optimal evening time
        
        uiManager.showModal('scheduleModal');
    }

    async publishNow() {
        const content = document.getElementById('postContent')?.value;
        
        if (!content?.trim()) {
            ToastManager.show('Please enter some content before publishing', 'warning');
            return;
        }

        if (this.selectedPlatforms.length === 0) {
            ToastManager.show('Please select at least one platform', 'warning');
            return;
        }

        console.log('🚀 Publishing enhanced post now...');
        
        ToastManager.show('Publishing post...', 'info', 'Publishing');
        
        try {
            const post = {
                content: content.trim(),
                platforms: [...this.selectedPlatforms],
                contentCategory: document.getElementById('contentCategory')?.value || 'article',
                shortUrl: document.getElementById('shortUrl')?.value || '',
                mediaUrls: this.mediaFiles.map(f => URL.createObjectURL(f))
            };
            
            await firebaseService.publishPost(post);
            
            this.clearForm();
            
            // Update analytics
            const analytics = appState.getState('analytics');
            analytics.totalPosts = (analytics.totalPosts || 0) + 1;
            appState.setState({ analytics });
            
            ToastManager.show(`Post published to ${this.selectedPlatforms.join(', ')}!`, 'success', 'Published');
            console.log('✅ Enhanced post published successfully');
        } catch (error) {
            console.error('❌ Failed to publish post:', error);
            ToastManager.show('Failed to publish post', 'error');
        }
    }

    clearForm() {
        console.log('🧹 Clearing enhanced composer form...');
        
        document.getElementById('postContent').value = '';
        document.getElementById('contentCategory').value = '';
        document.getElementById('shortUrl').value = '';
        document.getElementById('mediaPreview').innerHTML = '';
        
        document.querySelectorAll('#platformCheckboxes input[type="checkbox"]').forEach(cb => {
            cb.checked = false;
            cb.closest('.platform-checkbox').classList.remove('selected');
        });
        
        this.selectedPlatforms = [];
        this.mediaFiles = [];
        this.currentDraft = null;
        
        this.updateCharacterCount();
        this.updatePreview();
    }

    editDraft(draftId) {
        console.log(`✏️ Editing enhanced draft: ${draftId}`);
        
        const drafts = appState.getState('drafts');
        const draft = drafts.find(d => d.id === draftId);
        
        if (!draft) return;
        
        uiManager.showSection('composer');
        
        document.getElementById('postContent').value = draft.content || '';
        if (draft.contentCategory) {
            document.getElementById('contentCategory').value = draft.contentCategory;
        }
        if (draft.shortUrl) {
            document.getElementById('shortUrl').value = draft.shortUrl;
        }
        
        this.selectedPlatforms = [...(draft.platforms || [])];
        this.selectedPlatforms.forEach(platform => {
            const checkbox = document.querySelector(`#platformCheckboxes input[value="${platform}"]`);
            if (checkbox) {
                checkbox.checked = true;
                checkbox.closest('.platform-checkbox').classList.add('selected');
            }
        });
        
        this.currentDraft = draft;
        this.updateCharacterCount();
        this.updatePreview();
        
        ToastManager.show('Draft loaded for editing', 'info');
    }

    scheduleDraft(draftId) {
        console.log(`📅 Scheduling enhanced draft: ${draftId}`);
        
        const drafts = appState.getState('drafts');
        const draft = drafts.find(d => d.id === draftId);
        
        if (!draft) return;
        
        this.editDraft(draftId);
        
        setTimeout(() => {
            this.showSmartScheduleModal();
        }, 100);
    }

    viewScheduledPost(postId) {
        console.log(`👀 Viewing scheduled post: ${postId}`);
        const scheduledPosts = appState.getState('scheduledPosts');
        const post = scheduledPosts.find(p => p.id === postId);
        
        if (post) {
            const dubaiTime = new Date(post.scheduledFor).toLocaleString('en-US', {
                timeZone: CONFIG.dubaiTimezone,
                dateStyle: 'medium',
                timeStyle: 'short'
            });
            ToastManager.show(`Scheduled for ${dubaiTime} Dubai time`, 'info', 'Scheduled Post');
        }
    }
}

// Initialize Enhanced Global Instances
console.log('🔧 Initializing enhanced global instances...');

const appState = new AppState();
const firebaseService = new FirebaseService();
const uiManager = new UIManager();
const postComposer = new PostComposer();

// Enhanced Application Initialization
async function initializeEnhancedApp() {
    try {
        console.log('🚀 Starting SocialHub Pro v8.5 Application...');
        
        uiManager.showLoadingScreen();
        
        // Initialize Firebase
        const firebaseInitialized = await firebaseService.initialize();
        if (!firebaseInitialized) {
            throw new Error('Firebase initialization failed');
        }
        
        // Extended loading time to show features
        await new Promise(resolve => setTimeout(resolve, 2000));
        
        setupEnhancedGlobalEventListeners();
        
        registerEnhancedServiceWorker();
        
        // Check if user is already signed in
        firebaseService.auth.onAuthStateChanged((user) => {
            if (user) {
                console.log('👤 User already signed in:', user.email);
                firebaseService.handleAuthSuccess(user);
            } else {
                uiManager.showLoginScreen();
            }
        });
        
        console.log('✅ Enhanced application initialization completed');
        
    } catch (error) {
        console.error('❌ Enhanced application initialization failed:', error);
        ToastManager.show('Application failed to start', 'error', 'Error');
        
        setTimeout(() => {
            uiManager.showLoginScreen();
        }, 1000);
    }
}

function setupEnhancedGlobalEventListeners() {
    console.log('🔧 Setting up enhanced global event listeners...');
    
    // Google Sign In
    document.getElementById('googleSignIn')?.addEventListener('click', async () => {
        try {
            console.log('🔐 Attempting Enhanced Google Sign-In...');
            await firebaseService.signInWithGoogle();
        } catch (error) {
            console.error('❌ Google Sign-In error:', error);
            ToastManager.show('Sign-in failed. Please try again.', 'error', 'Authentication Error');
        }
    });
    
    // Sign Out
    document.getElementById('signOut')?.addEventListener('click', async () => {
        try {
            console.log('🔐 Enhanced signing out...');
            await firebaseService.signOut();
            ToastManager.show('Signed out successfully', 'info');
        } catch (error) {
            console.error('❌ Sign-out error:', error);
            ToastManager.show('Sign-out failed', 'error');
        }
    });
    
    // Add Account
    document.getElementById('addAccountBtn')?.addEventListener('click', () => {
        console.log('➕ Opening enhanced account connection modal...');
        uiManager.showModal('accountModal');
    });
    
    // Quick Post Button
    document.getElementById('quickPostBtn')?.addEventListener('click', () => {
        console.log('⚡ Enhanced quick post clicked');
        uiManager.showSection('composer');
    });
    
    // Refresh Button
    document.getElementById('refreshBtn')?.addEventListener('click', async () => {
        console.log('🔄 Enhanced manual refresh triggered');
        const btn = document.getElementById('refreshBtn');
        const icon = btn.querySelector('i');
        
        icon.classList.add('fa-spin');
        
        try {
            await appState.syncData();
            uiManager.loadSectionData(uiManager.currentSection);
            ToastManager.show('Data refreshed', 'success');
        } catch (error) {
            console.error('❌ Enhanced refresh failed:', error);
            ToastManager.show('Refresh failed', 'error');
        } finally {
            setTimeout(() => {
                icon.classList.remove('fa-spin');
            }, 1000);
        }
    });
    
    // Calendar Navigation
    document.getElementById('prevMonth')?.addEventListener('click', () => {
        console.log('📅 Enhanced previous month clicked');
        ToastManager.show('Previous month navigation', 'info');
    });
    
    document.getElementById('nextMonth')?.addEventListener('click', () => {
        console.log('📅 Enhanced next month clicked');
        ToastManager.show('Next month navigation', 'info');
    });
    
    document.getElementById('todayBtn')?.addEventListener('click', () => {
        console.log('📅 Enhanced today button clicked');
        uiManager.renderEnhancedCalendar();
        ToastManager.show('Calendar updated to current month', 'success');
    });
    
    // Schedule Modal Actions
    document.getElementById('confirmSchedule')?.addEventListener('click', async () => {
        const scheduleType = document.querySelector('.schedule-option.active')?.getAttribute('data-type') || 'ai';
        
        let scheduledFor;
        
        if (scheduleType === 'ai') {
            // AI optimal scheduling
            const timeSlot = document.getElementById('aiTimeSlot')?.value || 'optimal';
            const dubaiTime = new Date().toLocaleString("en-US", {timeZone: CONFIG.dubaiTimezone});
            const tomorrow = new Date(new Date(dubaiTime).getTime() + 86400000);
            
            if (timeSlot === 'optimal') {
                tomorrow.setHours(17, 17, 0, 0); // Default optimal time
            } else {
                const slots = DUBAI_TIME_SLOTS[timeSlot];
                if (slots) {
                    const [hour, minute] = slots[0].split(':');
                    tomorrow.setHours(parseInt(hour), parseInt(minute), 0, 0);
                }
            }
            
            scheduledFor = tomorrow;
        } else {
            // Custom scheduling
            const date = document.getElementById('scheduleDate').value;
            const time = document.getElementById('scheduleTime').value;
            
            if (!date || !time) {
                ToastManager.show('Please select date and time', 'warning');
                return;
            }
            
            scheduledFor = new Date(`${date}T${time}`);
        }
        
        console.log(`📅 Enhanced scheduling post for ${scheduledFor}`);
        
        const content = document.getElementById('postContent')?.value;
        
        try {
            const post = {
                content: content.trim(),
                platforms: [...postComposer.selectedPlatforms],
                scheduledFor: scheduledFor.toISOString(),
                contentCategory: document.getElementById('contentCategory')?.value || 'article',
                shortUrl: document.getElementById('shortUrl')?.value || '',
                mediaUrls: postComposer.mediaFiles.map(f => URL.createObjectURL(f)),
                aiOptimized: scheduleType === 'ai',
                timeSlot: scheduleType === 'ai' ? (document.getElementById('aiTimeSlot')?.value || 'optimal') : 'custom'
            };
            
            await firebaseService.schedulePost(post);
            
            // Update local state
            const scheduledPosts = appState.getState('scheduledPosts');
            scheduledPosts.push({ ...post, id: 'temp_id' }); // ID will be updated after sync
            appState.setState({ scheduledPosts });
            
            postComposer.clearForm();
            uiManager.closeModal(document.getElementById('scheduleModal'));
            
            const dubaiTimeStr = scheduledFor.toLocaleString('en-US', {
                timeZone: CONFIG.dubaiTimezone,
                dateStyle: 'medium',
                timeStyle: 'short'
            });
            
            ToastManager.show(`Post scheduled for ${dubaiTimeStr} Dubai time`, 'success', 'Scheduled');
            console.log('✅ Enhanced post scheduled successfully');
            
            // Sync to get the actual ID from Firestore
            await appState.syncData();
            
        } catch (error) {
            console.error('❌ Failed to schedule post:', error);
            ToastManager.show('Failed to schedule post', 'error');
        }
    });
    
    document.getElementById('cancelSchedule')?.addEventListener('click', () => {
        uiManager.closeModal(document.getElementById('scheduleModal'));
    });
    
    // Schedule Type Selection
    document.querySelectorAll('.schedule-option').forEach(option => {
        option.addEventListener('click', () => {
            document.querySelectorAll('.schedule-option').forEach(opt => opt.classList.remove('active'));
            option.classList.add('active');
            
            const type = option.getAttribute('data-type');
            const aiOptions = document.getElementById('aiScheduleOptions');
            const customOptions = document.getElementById('customScheduleOptions');
            
            if (type === 'ai') {
                aiOptions?.classList.remove('hidden');
                customOptions?.classList.add('hidden');
            } else {
                aiOptions?.classList.add('hidden');
                customOptions?.classList.remove('hidden');
            }
        });
    });
    
    // Platform Connection
    document.querySelectorAll('.platform-option button').forEach(btn => {
        btn.addEventListener('click', (e) => {
            const platform = e.target.closest('.platform-option').getAttribute('data-platform');
            console.log(`🔗 Enhanced connecting to ${platform}...`);
            
            btn.textContent = 'Connecting...';
            btn.disabled = true;
            
            // Simulate connection process
            setTimeout(() => {
                btn.textContent = 'Connected';
                btn.classList.remove('btn--outline');
                btn.classList.add('btn--success');
                
                ToastManager.show(`${platform.charAt(0).toUpperCase() + platform.slice(1)} connected successfully!`, 'success', 'Connected');
                
                setTimeout(() => {
                    uiManager.closeModal(document.getElementById('accountModal'));
                    // In a real app, this would refresh the accounts list from Firestore
                    appState.syncData();
                }, 1000);
            }, 2000);
        });
    });

    // FAB
    document.getElementById('fab')?.addEventListener('click', () => {
        console.log('⚡ Enhanced FAB clicked');
        uiManager.showSection('composer');
    });
}

async function registerEnhancedServiceWorker() {
    if ('serviceWorker' in navigator) {
        try {
            console.log('📱 Registering enhanced service worker...');
            
            const swCode = `
                const CACHE_NAME = 'socialhub-pro-v8.5';
                const urlsToCache = [
                    '/',
                    '/style.css',
                    '/app.js',
                    'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css',
                    'https://cdn.jsdelivr.net/npm/chart.js'
                ];

                self.addEventListener('install', (event) => {
                    console.log('SocialHub Pro SW: Installing...');
                    event.waitUntil(
                        caches.open(CACHE_NAME)
                            .then((cache) => {
                                return cache.addAll(urllsToCache);
                            })
                    );
                });

                self.addEventListener('fetch', (event) => {
                    event.respondWith(
                        caches.match(event.request)
                            .then((response) => {
                                return response || fetch(event.request);
                            })
                    );
                });

                self.addEventListener('message', (event) => {
                    if (event.data && event.data.type === 'SKIP_WAITING') {
                        self.skipWaiting();
                    }
                });
            `;
            
            const blob = new Blob([swCode], { type: 'application/javascript' });
            const swUrl = URL.createObjectURL(blob);
            
            const registration = await navigator.serviceWorker.register(swUrl);
            console.log('✅ Enhanced Service Worker registered:', registration.scope);
            
        } catch (error) {
            console.warn('⚠️ Enhanced Service Worker registration failed:', error);
        }
    }
}

// Enhanced Error Handling
window.addEventListener('error', (event) => {
    console.error('❌ Enhanced Global Error:', event.error);
    appState.setState({
        performanceMetrics: {
            ...appState.getState('performanceMetrics'),
            errors: (appState.getState('performanceMetrics').errors || 0) + 1
        }
    });
    ToastManager.show('An unexpected error occurred', 'error');
});

window.addEventListener('unhandledrejection', (event) => {
    console.error('❌ Enhanced Unhandled Promise Rejection:', event.reason);
    ToastManager.show('An unexpected error occurred', 'error');
});

// Enhanced Performance Monitoring
if (CONFIG.performanceMonitoring) {
    window.addEventListener('load', () => {
        setTimeout(() => {
            const perfData = performance.getEntriesByType('navigation')[0];
            const metrics = {
                loadTime: Math.round(perfData.loadEventEnd - perfData.fetchStart),
                domReady: Math.round(perfData.domContentLoadedEventEnd - perfData.fetchStart),
                networkTime: Math.round(perfData.responseEnd - perfData.fetchStart),
                renderTime: Math.round(perfData.domComplete - perfData.domLoading)
            };
            
            console.log('📊 Enhanced Performance Metrics:', metrics);
            
            appState.setState({
                performanceMetrics: {
                    ...appState.getState('performanceMetrics'),
                    ...metrics
                }
            });
        }, 100);
    });
}

// Initialize the enhanced application when DOM is ready
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initializeEnhancedApp);
} else {
    initializeEnhancedApp();
}

// Enhanced Export for global access
window.SocialHubPro = {
    appState,
    firebaseService,
    uiManager,
    postComposer,
    ToastManager,
    version: CONFIG.version,
    config: CONFIG,
    dubaiTimeSlots: DUBAI_TIME_SLOTS,
    userRoles: USER_ROLES
};

console.log('✅ SocialHub Pro v8.5 JavaScript loaded successfully - Enhanced Edition Ready! 🚀');
   </script>
</body>
</html>